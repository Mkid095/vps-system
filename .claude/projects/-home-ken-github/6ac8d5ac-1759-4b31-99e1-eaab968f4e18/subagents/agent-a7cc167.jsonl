{"parentUuid":null,"isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":"I need to verify the correct Claude Code v1.0.62+ specifications for:\n\n1. Hook configuration format - verify if hooks use `pattern` or `matcher`, and the correct structure\n2. Agent spawning syntax - verify if `@agent-name` is valid or if natural language is required\n3. Hook input fields - verify if hooks receive `subagent_type` or `agent_type`\n\nUse web-search-prime to find official Claude Code documentation on:\n- Claude Code hooks configuration\n- Claude Code subagent/agent spawning syntax\n- Claude Code settings.json format\n\nUse web-reader to read the official Claude Code documentation pages.\n\nReturn:\n1. Correct hook format with examples\n2. Correct agent spawning syntax\n3. Correct hook input field names\n4. Sources/documentation URLs"},"uuid":"f335276b-a76e-4c83-8e8e-5cd512e3d79c","timestamp":"2026-01-26T05:35:47.580Z"}
{"parentUuid":"f335276b-a76e-4c83-8e8e-5cd512e3d79c","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261335498f463caaa2b54f99","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"text","text":"I'll help you verify the Claude Code v1.0.62+ specifications by searching for official documentation on hooks, agent spawning, and configuration format."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"02285dd4-edb9-4e6a-88c1-762e4c202ff5","timestamp":"2026-01-26T05:35:50.938Z"}
{"parentUuid":"02285dd4-edb9-4e6a-88c1-762e4c202ff5","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261335498f463caaa2b54f99","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_7f2229f349844da6ab84b177","name":"mcp__web-search-prime__webSearchPrime","input":{"search_query":"Claude Code hooks configuration pattern matcher settings.json documentation","location":"us","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"06dd5fe3-9e3a-4c49-a3e5-13db9f61df1e","timestamp":"2026-01-26T05:35:51.008Z"}
{"parentUuid":"06dd5fe3-9e3a-4c49-a3e5-13db9f61df1e","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261335498f463caaa2b54f99","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_5936d1b175e340948dfc49d5","name":"mcp__web-search-prime__webSearchPrime","input":{"search_query":"Claude Code agent spawning syntax @agent-name subagent documentation","location":"us","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"a3e76b74-69f8-4951-be12-04ad3a3d3da8","timestamp":"2026-01-26T05:35:51.084Z"}
{"parentUuid":"a3e76b74-69f8-4951-be12-04ad3a3d3da8","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261335498f463caaa2b54f99","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_b78b02bd02cf44f4af645bea","name":"mcp__web-search-prime__webSearchPrime","input":{"search_query":"Claude Code v1.0.62 hooks subagent_type agent_type fields","location":"us","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"1eeb7781-7736-46b3-a8ef-ceece2df7671","timestamp":"2026-01-26T05:35:51.094Z"}
{"parentUuid":"1eeb7781-7736-46b3-a8ef-ceece2df7671","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-search-prime","toolName":"webSearchPrime"},"toolUseID":"call_7f2229f349844da6ab84b177","parentToolUseID":"call_7f2229f349844da6ab84b177","uuid":"6ce22caa-2d80-4e22-87fd-2cce5a92118e","timestamp":"2026-01-26T05:35:53.530Z"}
{"parentUuid":"6ce22caa-2d80-4e22-87fd-2cce5a92118e","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-search-prime","toolName":"webSearchPrime","elapsedTimeMs":4207},"toolUseID":"call_7f2229f349844da6ab84b177","parentToolUseID":"call_7f2229f349844da6ab84b177","uuid":"044493d8-d7fe-4121-a48e-ad19e108dbf1","timestamp":"2026-01-26T05:35:57.737Z"}
{"parentUuid":"06dd5fe3-9e3a-4c49-a3e5-13db9f61df1e","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_7f2229f349844da6ab84b177","type":"tool_result","content":[{"type":"text","text":"\"[{\\\"refer\\\":\\\"ref_1\\\",\\\"title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/hooks\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Configuration. Claude Code hooks are configured in your settings files: ~/.claude/settings.json - User settings. .claude/settings.json - Project settings.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_2\\\",\\\"title\\\":\\\"Get started with Claude Code hooks\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/hooks-guide\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Step 1: Open hooks configuration. Run the /hooks ... Step 5: Verify your hook. Run /hooks again or check ~/.claude/settings.json to see your configuration:.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_3\\\",\\\"title\\\":\\\"Claude Code Hooks: A Practical Guide to Workflow ...\\\",\\\"link\\\":\\\"https://www.datacamp.com/tutorial/claude-code-hooks\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"“Extract the file path from the hook input JSON and check if it matches patterns like /etc/ , production.yml , or other critical file names. Use ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"7 days ago\\\"},{\\\"refer\\\":\\\"ref_4\\\",\\\"title\\\":\\\"Claude Code's Most Underrated Feature: Hooks (wrote a ...\\\",\\\"link\\\":\\\"https://www.reddit.com/r/ClaudeAI/comments/1qlzxr1/claude_codes_most_underrated_feature_hooks_wrote/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Basic pattern: Hook reads project config/context files. Returns JSON with \\\\\\\"message\\\\\\\" field. Claude sees that context at session start. Multi ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"1 day ago\\\"},{\\\"refer\\\":\\\"ref_5\\\",\\\"title\\\":\\\"7 Top Production-Ready Claude Code Hooks Guide | Medium\\\",\\\"link\\\":\\\"https://alirezarezvani.medium.com/the-production-ready-claude-code-hooks-guide-7-hooks-that-actually-matter-823587f9fc61\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"The Production-Ready Claude Code Hooks Guide: 7 Hooks That Actually Matter Stop Configuring Claude Code Hooks Wrong. The 5 Mistakes Breaking ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"2 months ago\\\"},{\\\"refer\\\":\\\"ref_6\\\",\\\"title\\\":\\\"disler/claude-code-hooks-mastery\\\",\\\"link\\\":\\\"https://github.com/disler/claude-code-hooks-mastery\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Key Files .claude/settings.json - Hook configuration with permissions .claude/hooks/ - Python scripts using uv for each hook type. user_prompt_submit.py ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_7\\\",\\\"title\\\":\\\"Claude Code: Part 8 - Hooks for Automated Quality Checks\\\",\\\"link\\\":\\\"https://dev.to/letanure/claude-code-part-8-hooks-for-automated-quality-checks-20il\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"This hook reminds Claude to be more direct and action-focused in responses. Hook Configuration Locations. Project-level: .claude/settings.json.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Aug 11, 2025\\\"},{\\\"refer\\\":\\\"ref_8\\\",\\\"title\\\":\\\"Hooks in Cursor and Claude Code: A Step-by-Step Guide\\\",\\\"link\\\":\\\"https://mlearning.substack.com/p/hooks-in-cursor-and-claude-code-a-step-by-step-guide\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Method 2: Manual JSON Configuration · Step 1: Choose configuration scope · Step 2: Create configuration directory · Step 3: Create hooks ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"3 weeks ago\\\"},{\\\"refer\\\":\\\"ref_9\\\",\\\"title\\\":\\\"Third Party Hooks | Cursor Docs\\\",\\\"link\\\":\\\"https://cursor.com/docs/agent/third-party-hooks\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Cursor automatically maps Claude hook names to their Cursor equivalents. Example Claude Code settings.json: { \\\\\\\"hooks\\\\\\\": { \\\\\\\"PreToolUse\\\\\\\": [ { \\\\\\\"matcher\\\\\\\": \\\\\\\"Shell ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_10\\\",\\\"title\\\":\\\"Claude Code Hook Examples | Developing with AI Tools\\\",\\\"link\\\":\\\"https://stevekinney.com/courses/ai-development/claude-code-hook-examples\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"This cookbook shows copy-ready hook configurations and shell scripts for common guardrails and automations. Hooks run shell commands on specific ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Sep 20, 2025\\\"}]\""}]}]},"uuid":"efd2305b-97b4-49ce-aa3d-085e652737a6","timestamp":"2026-01-26T05:35:58.387Z","sourceToolAssistantUUID":"06dd5fe3-9e3a-4c49-a3e5-13db9f61df1e"}
{"parentUuid":"efd2305b-97b4-49ce-aa3d-085e652737a6","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-search-prime","toolName":"webSearchPrime"},"toolUseID":"call_5936d1b175e340948dfc49d5","parentToolUseID":"call_5936d1b175e340948dfc49d5","uuid":"bc0f4028-92f5-4bbe-bb50-6fec636a9742","timestamp":"2026-01-26T05:36:00.177Z"}
{"parentUuid":"bc0f4028-92f5-4bbe-bb50-6fec636a9742","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-search-prime","toolName":"webSearchPrime","elapsedTimeMs":2417},"toolUseID":"call_5936d1b175e340948dfc49d5","parentToolUseID":"call_5936d1b175e340948dfc49d5","uuid":"df503e10-356a-4761-b5a9-7bf37c9f5937","timestamp":"2026-01-26T05:36:02.594Z"}
{"parentUuid":"a3e76b74-69f8-4951-be12-04ad3a3d3da8","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_5936d1b175e340948dfc49d5","type":"tool_result","content":[{"type":"text","text":"\"[{\\\"refer\\\":\\\"ref_1\\\",\\\"title\\\":\\\"Create custom subagents - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/sub-agents\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Select Create new agent, then choose User-level. This saves the subagent to ~/.claude/agents/ so it's available in all your projects.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_2\\\",\\\"title\\\":\\\"Subagents in the SDK - Claude API Docs\\\",\\\"link\\\":\\\"https://platform.claude.com/docs/en/agent-sdk/subagents\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Subagents are separate agent instances that your main agent can spawn to handle focused subtasks. Use subagents to isolate context for focused subtasks, ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_3\\\",\\\"title\\\":\\\"VoltAgent/awesome-claude-code-subagents\\\",\\\"link\\\":\\\"https://github.com/VoltAgent/awesome-claude-code-subagents\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Creating New Subagents - Step by Step · Step 1: Launch the Agent Interface · Step 2: Choose \\\\\\\"Create New Agent\\\\\\\" · Step 3: Configure Your Agent · Step 4: Save and ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_4\\\",\\\"title\\\":\\\"Building with Claude Code Subagents (My Beloved Minions)\\\",\\\"link\\\":\\\"https://medium.com/@ooi_yee_fei/building-with-claude-code-subagents-my-beloved-minions-b5a9a4318ba5\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"How to Set Up a Subagent · Run the `/agents` command in Claude Code. · Select “Create New Agent.” · Choose between a project-level or user-level ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"5 months ago\\\"},{\\\"refer\\\":\\\"ref_5\\\",\\\"title\\\":\\\"Full manual for writing your first Claude Code Agents\\\",\\\"link\\\":\\\"https://www.reddit.com/r/Anthropic/comments/1ma4epq/full_manual_for_writing_your_first_claude_code/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"1. Upload Your Code to Claude's Project Knowledge (web) · 2. Drop The Magic Prompt · 3. Ask for MORE Ideas (This Is Key!) · 4. Name Your Agents ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"6 months ago\\\"},{\\\"refer\\\":\\\"ref_6\\\",\\\"title\\\":\\\"How to Use Claude Code: A Guide to Slash Commands ...\\\",\\\"link\\\":\\\"https://www.producttalk.org/how-to-use-claude-code-features/?srsltid=AfmBOop4T8iiH5ZEh1gH2mXFZyxdGBqHFQW7bxK5CwIJ8QnF5NNGVALw\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Sub-agents work in their own context window and report back to the main agent. For example, Claude might spawn a sub-agent to search the web.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 7, 2026\\\"},{\\\"refer\\\":\\\"ref_7\\\",\\\"title\\\":\\\"Claude Code Tutorial #8 - Subagents\\\",\\\"link\\\":\\\"https://www.youtube.com/watch?v=Phr7vBx9yFQ\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"In this lesson we're going to make a sub agent who can use the playright MCP server to preview and review the UI UX of new components.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"4 months ago\\\"},{\\\"refer\\\":\\\"ref_8\\\",\\\"title\\\":\\\"Claude Code Subagents Quickstart: what they are + how to ...\\\",\\\"link\\\":\\\"https://shipyard.build/blog/claude-code-subagents-guide/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Learn what Claude Code subagents are, how to create them, and a few tips + tricks for crafting their personas.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Sep 21, 2025\\\"},{\\\"refer\\\":\\\"ref_9\\\",\\\"title\\\":\\\"Sub-Agents Guide — claude v0.5.3\\\",\\\"link\\\":\\\"https://hexdocs.pm/claude/guide-subagents.html\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Claude includes a powerful sub-agent system that lets you create specialized AI assistants for specific tasks in your project. Sub-agents provide focused ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_10\\\",\\\"title\\\":\\\"Custom agents with Claude Code and Otto\\\",\\\"link\\\":\\\"https://www.ascend.io/blog/custom-agents-with-claude-code-and-otto\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Learn about Claude Code's new custom agents feature. See how Ascend.io validates agentic approaches for data engineering with practical examples.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"}]\""}]}]},"uuid":"8075ec23-b032-44b2-b950-67b440ae7e67","timestamp":"2026-01-26T05:36:03.223Z","sourceToolAssistantUUID":"a3e76b74-69f8-4951-be12-04ad3a3d3da8"}
{"parentUuid":"8075ec23-b032-44b2-b950-67b440ae7e67","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-search-prime","toolName":"webSearchPrime"},"toolUseID":"call_b78b02bd02cf44f4af645bea","parentToolUseID":"call_b78b02bd02cf44f4af645bea","uuid":"cb17c0f2-35da-4dde-992a-f6b3680f1813","timestamp":"2026-01-26T05:36:04.951Z"}
{"parentUuid":"cb17c0f2-35da-4dde-992a-f6b3680f1813","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-search-prime","toolName":"webSearchPrime","elapsedTimeMs":20811},"toolUseID":"call_b78b02bd02cf44f4af645bea","parentToolUseID":"call_b78b02bd02cf44f4af645bea","uuid":"989add10-8f24-44c2-9c72-3078f0cec7cd","timestamp":"2026-01-26T05:36:25.762Z"}
{"parentUuid":"1eeb7781-7736-46b3-a8ef-ceece2df7671","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_b78b02bd02cf44f4af645bea","type":"tool_result","content":[{"type":"text","text":"\"[{\\\"refer\\\":\\\"ref_1\\\",\\\"title\\\":\\\"claude-code-release-notes\\\",\\\"link\\\":\\\"https://www.claudelog.com/faqs/claude-code-release-notes/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Synopsis: SubagentStop hooks: Added agent_id and agent_transcript_path fields for better subagent debugging. Track and analyze subagent behavior with full ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_2\\\",\\\"title\\\":\\\"Subagent Termination Bug in Claude Code v1.0.62\\\",\\\"link\\\":\\\"https://github.com/anthropics/claude-code/issues/6594\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"This is a regression from earlier versions where subagents had individual error handling. Steps to Reproduce. Launch multiple subagents using ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Aug 26, 2025\\\"},{\\\"refer\\\":\\\"ref_3\\\",\\\"title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/hooks\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"The model field contains the model identifier when available. If you start Claude Code with claude --agent <name> , an agent_type field contains the agent name.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_4\\\",\\\"title\\\":\\\"Claude Code's Most Underrated Feature: Hooks (wrote a ...\\\",\\\"link\\\":\\\"https://www.reddit.com/r/ClaudeAI/comments/1qlzxr1/claude_codes_most_underrated_feature_hooks_wrote/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"What hooks do: Let you run your own code at any point in Claude Code's workflow - before it writes a file, after it runs a command, when it ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"1 day ago\\\"},{\\\"refer\\\":\\\"ref_5\\\",\\\"title\\\":\\\"How to Use Claude Code: A Guide to Slash Commands ...\\\",\\\"link\\\":\\\"https://www.producttalk.org/how-to-use-claude-code-features/?srsltid=AfmBOorO-WapRFxXIkXUsUklEW717_XWBtA-Po6dWxkMLEn75eBWunaq\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Hooks let us tie deterministic code to specific moments in time. Anthropic defines the following hooks: PreToolUse: Runs before tool calls (can ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 7, 2026\\\"},{\\\"refer\\\":\\\"ref_6\\\",\\\"title\\\":\\\"Master Claude Code Sub‑Agents in 10 Minutes\\\",\\\"link\\\":\\\"https://www.youtube.com/watch?v=mEt-i8FunG8&vl=en\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"check out claude code: http://clau.de/prompteng In this video, you will learn about the new sub-agents feature in Claude Code.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"6 months ago\\\"},{\\\"refer\\\":\\\"ref_7\\\",\\\"title\\\":\\\"Practical guide to mastering Claude Code's main agent and ...\\\",\\\"link\\\":\\\"https://new2026.medium.com/practical-guide-to-mastering-claude-codes-main-agent-and-sub-agents-fd52952dcf00\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"A complete, practical guide to mastering Claude Code's main agent and Sub‑agents — including why they matter, how to set them up the right ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"6 months ago\\\"},{\\\"refer\\\":\\\"ref_8\\\",\\\"title\\\":\\\"[FEATURE] Expose Agent Context in Hook Event Payloads ...\\\",\\\"link\\\":\\\"https://github.com/anthropics/claude-code/issues/16424\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\": Claude Code's subagents operate in parallel within the same process, not in a true parent-child hierarchy. All subagents share the same ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 5, 2026\\\"},{\\\"refer\\\":\\\"ref_9\\\",\\\"title\\\":\\\"My Claude Code Sub Agents BUILD THEMSELVES\\\",\\\"link\\\":\\\"https://www.youtube.com/watch?v=7B2HJr0Y68g\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"In this video we're going to break down how to build effective cloud code sub aents.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"6 months ago\\\"},{\\\"refer\\\":\\\"ref_10\\\",\\\"title\\\":\\\"Claude Code's Most Underrated Feature: Hooks\\\",\\\"link\\\":\\\"https://www.reddit.com/r/ClaudeCode/comments/1qlzzzf/claude_codes_most_underrated_feature_hooks_wrote/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"What hooks let you do: Run your own code at any point in Claude Code's workflow. 13 different events to hook into (PreToolUse, PostToolUse, ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"1 day ago\\\"}]\""}]}]},"uuid":"14b587c4-56f3-4d5a-bd61-42aaf97fc7a8","timestamp":"2026-01-26T05:36:26.409Z","sourceToolAssistantUUID":"1eeb7781-7736-46b3-a8ef-ceece2df7671"}
{"parentUuid":"14b587c4-56f3-4d5a-bd61-42aaf97fc7a8","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_20260126133628e7d61cc136884c5b","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"text","text":"Now let me read the official Claude Code documentation pages to get the detailed specifications:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"99d95ddf-7a49-46cc-aabb-3a319574b62f","timestamp":"2026-01-26T05:36:30.170Z"}
{"parentUuid":"99d95ddf-7a49-46cc-aabb-3a319574b62f","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_20260126133628e7d61cc136884c5b","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_12764406d9fe43f4900ca0d7","name":"mcp__web-reader__webReader","input":{"url":"https://code.claude.com/docs/en/hooks","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"8ceec84e-d47e-4289-9c33-133c769bcbde","timestamp":"2026-01-26T05:36:30.257Z"}
{"parentUuid":"8ceec84e-d47e-4289-9c33-133c769bcbde","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_20260126133628e7d61cc136884c5b","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_0cc035102ca24b68a12c8a18","name":"mcp__web-reader__webReader","input":{"url":"https://code.claude.com/docs/en/hooks-guide","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"b1212bdf-d6fb-4bfe-8a48-61c91e67d34a","timestamp":"2026-01-26T05:36:30.269Z"}
{"parentUuid":"b1212bdf-d6fb-4bfe-8a48-61c91e67d34a","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_20260126133628e7d61cc136884c5b","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_57a8c3c297d842dcbda4d874","name":"mcp__web-reader__webReader","input":{"url":"https://code.claude.com/docs/en/sub-agents","content_size":"high"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"279656df-6856-4158-8645-86624c7399b6","timestamp":"2026-01-26T05:36:30.357Z"}
{"parentUuid":"279656df-6856-4158-8645-86624c7399b6","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-reader","toolName":"webReader"},"toolUseID":"call_12764406d9fe43f4900ca0d7","parentToolUseID":"call_12764406d9fe43f4900ca0d7","uuid":"6f43ce6d-1e95-47ba-9262-82c327040392","timestamp":"2026-01-26T05:36:32.869Z"}
{"parentUuid":"6f43ce6d-1e95-47ba-9262-82c327040392","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-reader","toolName":"webReader","elapsedTimeMs":7183},"toolUseID":"call_12764406d9fe43f4900ca0d7","parentToolUseID":"call_12764406d9fe43f4900ca0d7","uuid":"dfe8fde5-2149-4a85-b3c1-1ab8354cbdfd","timestamp":"2026-01-26T05:36:40.052Z"}
{"parentUuid":"8ceec84e-d47e-4289-9c33-133c769bcbde","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_12764406d9fe43f4900ca0d7","type":"tool_result","content":[{"type":"text","text":"\"{\\\"title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"description\\\":\\\"This page provides reference documentation for implementing hooks in Claude Code.\\\",\\\"url\\\":\\\"https://code.claude.com/docs/en/hooks\\\",\\\"content\\\":\\\"## Hook lifecycle\\\\n\\\\nHooks fire at specific points during a Claude Code session.\\\\n\\\\n| Hook | When it fires |\\\\n| --- | --- |\\\\n| `SessionStart` | Session begins or resumes |\\\\n| `UserPromptSubmit` | User submits a prompt |\\\\n| `PreToolUse` | Before tool execution |\\\\n| `PermissionRequest` | When permission dialog appears |\\\\n| `PostToolUse` | After tool succeeds |\\\\n| `PostToolUseFailure` | After tool fails |\\\\n| `SubagentStart` | When spawning a subagent |\\\\n| `SubagentStop` | When subagent finishes |\\\\n| `Stop` | Claude finishes responding |\\\\n| `PreCompact` | Before context compaction |\\\\n| `SessionEnd` | Session terminates |\\\\n| `Notification` | Claude Code sends notifications |\\\\n\\\\n## Configuration\\\\n\\\\nClaude Code hooks are configured in your settings files:\\\\n\\\\n- `~/.claude/settings.json` - User settings\\\\n- `.claude/settings.json` - Project settings\\\\n- `.claude/settings.local.json` - Local project settings (not committed)\\\\n- Managed policy settings\\\\n\\\\n### Structure\\\\n\\\\nHooks are organized by matchers, where each matcher can have multiple hooks:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"EventName\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"ToolPattern\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"your-command-here\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n- __matcher__: Pattern to match tool names, case-sensitive (only applicable for\\\\n  `PreToolUse`, `PermissionRequest`, and `PostToolUse`)\\\\n  - Simple strings match exactly: `Write` matches only the Write tool\\\\n  - Supports regex: `Edit|Write` or `Notebook.*`\\\\n  - Use `*` to match all tools. You can also use empty string (`\\\\\\\"\\\\\\\"`) or leave\\\\n    `matcher` blank.\\\\n- __hooks__: Array of hooks to execute when the pattern matches\\\\n  - `type`: Hook execution type - `\\\\\\\"command\\\\\\\"` for bash commands or `\\\\\\\"prompt\\\\\\\"` for LLM-based evaluation\\\\n  - `command`: (For `type: \\\\\\\"command\\\\\\\"`) The bash command to execute (can use `$CLAUDE_PROJECT_DIR` environment variable)\\\\n  - `prompt`: (For `type: \\\\\\\"prompt\\\\\\\"`) The prompt to send to the LLM for evaluation\\\\n  - `timeout`: (Optional) How long a hook should run, in seconds, before canceling that specific hook\\\\n\\\\nFor events like `UserPromptSubmit`, `Stop`, `SubagentStop`, and `Setup`\\\\nthat don’t use matchers, you can omit the matcher field:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"UserPromptSubmit\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"/path/to/prompt-validator.py\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Project-Specific Hook Scripts\\\\n\\\\nYou can use the environment variable `CLAUDE_PROJECT_DIR` (only available when\\\\nClaude Code spawns the hook command) to reference scripts stored in your project,\\\\nensuring they work regardless of Claude’s current directory:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PostToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Write|Edit\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"\\\\\\\\\\\\\\\"$CLAUDE_PROJECT_DIR\\\\\\\\\\\\\\\"/.claude/hooks/check-style.sh\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Plugin hooks\\\\n\\\\nPlugins can provide hooks that integrate seamlessly with your user and project hooks. Plugin hooks are automatically merged with your configuration when plugins are enabled.\\\\n__How plugin hooks work__:\\\\n\\\\n- Plugin hooks are defined in the plugin’s `hooks/hooks.json` file or in a file given by a custom path to the `hooks` field.\\\\n- When a plugin is enabled, its hooks are merged with user and project hooks\\\\n- Multiple hooks from different sources can respond to the same event\\\\n- Plugin hooks use the `${CLAUDE_PLUGIN_ROOT}` environment variable to reference plugin files\\\\n\\\\n__Example plugin hook configuration__:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"description\\\\\\\": \\\\\\\"Automatic code formatting\\\\\\\",\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PostToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Write|Edit\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"${CLAUDE_PLUGIN_ROOT}/scripts/format.sh\\\\\\\",\\\\n            \\\\\\\"timeout\\\\\\\": 30\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Environment variables for plugins__:\\\\n\\\\n- `${CLAUDE_PLUGIN_ROOT}`: Absolute path to the plugin directory\\\\n- `${CLAUDE_PROJECT_DIR}`: Project root directory (same as for project hooks)\\\\n- All standard environment variables are available\\\\n\\\\nSee the plugin components reference for details on creating plugin hooks.\\\\n\\\\n### Hooks in skills and agents\\\\n\\\\nIn addition to settings files and plugins, hooks can be defined directly in skills and subagents using frontmatter. These hooks are scoped to the component’s lifecycle and only run when that component is active.\\\\n__Supported events__: `PreToolUse`, `PostToolUse`, and `Stop`\\\\n__Example in a Skill__:\\\\n\\\\n```\\\\n---\\\\nname: secure-operations\\\\ndescription: Perform operations with security checks\\\\nhooks:\\\\n  PreToolUse:\\\\n    - matcher: \\\\\\\"Bash\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/security-check.sh\\\\\\\"\\\\n---\\\\n```\\\\n\\\\n__Example in an agent__:\\\\n\\\\n```\\\\n---\\\\nname: code-reviewer\\\\ndescription: Review code changes\\\\nhooks:\\\\n  PostToolUse:\\\\n    - matcher: \\\\\\\"Edit|Write\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/run-linter.sh\\\\\\\"\\\\n---\\\\n```\\\\n\\\\nComponent-scoped hooks follow the same configuration format as settings-based hooks but are automatically cleaned up when the component finishes executing.\\\\n__Additional option for skills:__\\\\n\\\\n- `once`: Set to `true` to run the hook only once per session. After the first successful execution, the hook is removed. Note: This option is currently only supported for skills, not for agents.\\\\n\\\\n## Prompt-Based Hooks\\\\n\\\\nIn addition to bash command hooks (`type: \\\\\\\"command\\\\\\\"`), Claude Code supports prompt-based hooks (`type: \\\\\\\"prompt\\\\\\\"`) that use an LLM to evaluate whether to allow or block an action. Prompt-based hooks are currently only supported for `Stop` and `SubagentStop` hooks, where they enable intelligent, context-aware decisions.\\\\n\\\\n### How prompt-based hooks work\\\\n\\\\nInstead of executing a bash command, prompt-based hooks:\\\\n\\\\n1. Send the hook input and your prompt to a fast LLM (Haiku)\\\\n2. The LLM responds with structured JSON containing a decision\\\\n3. Claude Code processes the decision automatically\\\\n\\\\n### Configuration\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"Stop\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"prompt\\\\\\\",\\\\n            \\\\\\\"prompt\\\\\\\": \\\\\\\"Evaluate if Claude should stop: $ARGUMENTS. Check if all tasks are complete.\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Fields:__\\\\n\\\\n- `type`: Must be `\\\\\\\"prompt\\\\\\\"`\\\\n- `prompt`: The prompt text to send to the LLM\\\\n  - Use `$ARGUMENTS` as a placeholder for the hook input JSON\\\\n  - If `$ARGUMENTS` is not present, input JSON is appended to the prompt\\\\n- `timeout`: (Optional) Timeout in seconds (default: 30 seconds)\\\\n\\\\n### Response schema\\\\n\\\\nThe LLM must respond with JSON containing:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"ok\\\\\\\": true | false,\\\\n  \\\\\\\"reason\\\\\\\": \\\\\\\"Explanation for the decision\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n__Response fields:__\\\\n\\\\n- `ok`: `true` allows the action, `false` prevents it\\\\n- `reason`: Required when `ok` is `false`. Explanation shown to Claude\\\\n\\\\n### Supported hook events\\\\n\\\\nPrompt-based hooks work with any hook event, but are most useful for:\\\\n\\\\n- __Stop__: Intelligently decide if Claude should continue working\\\\n- __SubagentStop__: Evaluate if a subagent has completed its task\\\\n- __UserPromptSubmit__: Validate user prompts with LLM assistance\\\\n- __PreToolUse__: Make context-aware permission decisions\\\\n- __PermissionRequest__: Intelligently allow or deny permission dialogs\\\\n\\\\n### Example: Intelligent Stop hook\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"Stop\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"prompt\\\\\\\",\\\\n            \\\\\\\"prompt\\\\\\\": \\\\\\\"You are evaluating whether Claude should stop working. Context: $ARGUMENTS\\\\\\\\n\\\\\\\\nAnalyze the conversation and determine if:\\\\\\\\n1. All user-requested tasks are complete\\\\\\\\n2. Any errors need to be addressed\\\\\\\\n3. Follow-up work is needed\\\\\\\\n\\\\\\\\nRespond with JSON: {\\\\\\\\\\\\\\\"ok\\\\\\\\\\\\\\\": true} to allow stopping, or {\\\\\\\\\\\\\\\"ok\\\\\\\\\\\\\\\": false, \\\\\\\\\\\\\\\"reason\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"your explanation\\\\\\\\\\\\\\\"} to continue working.\\\\\\\",\\\\n            \\\\\\\"timeout\\\\\\\": 30\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Example: SubagentStop with custom logic\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"SubagentStop\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"prompt\\\\\\\",\\\\n            \\\\\\\"prompt\\\\\\\": \\\\\\\"Evaluate if this subagent should stop. Input: $ARGUMENTS\\\\\\\\n\\\\\\\\nCheck if:\\\\\\\\n- The subagent completed its assigned task\\\\\\\\n- Any errors occurred that need fixing\\\\\\\\n- Additional context gathering is needed\\\\\\\\n\\\\\\\\nReturn: {\\\\\\\\\\\\\\\"ok\\\\\\\\\\\\\\\": true} to allow stopping, or {\\\\\\\\\\\\\\\"ok\\\\\\\\\\\\\\\": false, \\\\\\\\\\\\\\\"reason\\\\\\\\\\\\\\\": \\\\\\\\\\\\\\\"explanation\\\\\\\\\\\\\\\"} to continue.\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Comparison with bash command hooks\\\\n\\\\n| Feature | Bash Command Hooks | Prompt-Based Hooks |\\\\n| --- | --- | --- |\\\\n| __Execution__ | Runs bash script | Queries LLM |\\\\n| __Decision logic__ | You implement in code | LLM evaluates context |\\\\n| __Setup complexity__ | Requires script file | Configure prompt |\\\\n| __Context awareness__ | Limited to script logic | Natural language understanding |\\\\n| __Performance__ | Fast (local execution) | Slower (API call) |\\\\n| __Use case__ | Deterministic rules | Context-aware decisions |\\\\n\\\\n### Best practices\\\\n\\\\n- __Be specific in prompts__: Clearly state what you want the LLM to evaluate\\\\n- __Include decision criteria__: List the factors the LLM should consider\\\\n- __Test your prompts__: Verify the LLM makes correct decisions for your use cases\\\\n- __Set appropriate timeouts__: Default is 30 seconds, adjust if needed\\\\n- __Use for complex decisions__: Bash hooks are better for simple, deterministic rules\\\\n\\\\nSee the plugin components reference for details on creating plugin hooks.\\\\n\\\\n## Hook Events\\\\n\\\\n### PreToolUse\\\\n\\\\nRuns after Claude creates tool parameters and before processing the tool call.\\\\n__Common matchers:__\\\\n\\\\n- `Task` - Subagent tasks (see subagents documentation)\\\\n- `Bash` - Shell commands\\\\n- `Glob` - File pattern matching\\\\n- `Grep` - Content search\\\\n- `Read` - File reading\\\\n- `Edit` - File editing\\\\n- `Write` - File writing\\\\n- `WebFetch`, `WebSearch` - Web operations\\\\n\\\\nUse PreToolUse decision control to allow, deny, or ask for permission to use the tool.\\\\n\\\\n### PermissionRequest\\\\n\\\\nRuns when the user is shown a permission dialog.\\\\nUse PermissionRequest decision control to allow or deny on behalf of the user.\\\\nRecognizes the same matcher values as PreToolUse.\\\\n\\\\n### PostToolUse\\\\n\\\\nRuns immediately after a tool completes successfully.\\\\nRecognizes the same matcher values as PreToolUse.\\\\n\\\\n### Notification\\\\n\\\\nRuns when Claude Code sends notifications. Supports matchers to filter by notification type.\\\\n__Common matchers:__\\\\n\\\\n- `permission_prompt` - Permission requests from Claude Code\\\\n- `idle_prompt` - When Claude is waiting for user input (after 60+ seconds of idle time)\\\\n- `auth_success` - Authentication success notifications\\\\n- `elicitation_dialog` - When Claude Code needs input for MCP tool elicitation\\\\n\\\\nYou can use matchers to run different hooks for different notification types, or omit the matcher to run hooks for all notifications.\\\\n__Example: Different notifications for different types__\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"Notification\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"permission_prompt\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"/path/to/permission-alert.sh\\\\\\\"\\\\n          }\\\\n        ]\\\\n      },\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"idle_prompt\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"/path/to/idle-notification.sh\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### UserPromptSubmit\\\\n\\\\nRuns when the user submits a prompt, before Claude processes it. This allows you\\\\nto add additional context based on the prompt/conversation, validate prompts, or\\\\nblock certain types of prompts.\\\\n\\\\n### Stop\\\\n\\\\nRuns when the main Claude Code agent has finished responding. Does not run if\\\\nthe stoppage occurred due to a user interrupt.\\\\n\\\\n### SubagentStop\\\\n\\\\nRuns when a Claude Code subagent (Task tool call) has finished responding.\\\\n\\\\n### PreCompact\\\\n\\\\nRuns before Claude Code is about to run a compact operation.\\\\n__Matchers:__\\\\n\\\\n- `manual` - Invoked from `/compact`\\\\n- `auto` - Invoked from auto-compact (due to full context window)\\\\n\\\\n### Setup\\\\n\\\\nRuns when Claude Code is invoked with repository setup and maintenance flags (`--init`, `--init-only`, or `--maintenance`). Use this hook for operations you don’t want on every session—such as installing dependencies, running migrations, or periodic maintenance tasks.\\\\n\\\\n__Matchers:__\\\\n\\\\n- `init` - Invoked from `--init` or `--init-only` flags\\\\n- `maintenance` - Invoked from `--maintenance` flag\\\\n\\\\nSetup hooks have access to the `CLAUDE_ENV_FILE` environment variable for persisting environment variables, similar to SessionStart hooks.\\\\n\\\\n### SessionStart\\\\n\\\\nRuns when Claude Code starts a new session or resumes an existing session (which\\\\ncurrently does start a new session under the hood). Useful for loading development context like existing issues or recent changes to your codebase, or setting up environment variables.\\\\n\\\\n__Matchers:__\\\\n\\\\n- `startup` - Invoked from startup\\\\n- `resume` - Invoked from `--resume`, `--continue`, or `/resume`\\\\n- `clear` - Invoked from `/clear`\\\\n- `compact` - Invoked from auto or manual compact.\\\\n\\\\n#### Persisting environment variables\\\\n\\\\nSessionStart hooks have access to the `CLAUDE_ENV_FILE` environment variable, which provides a file path where you can persist environment variables for subsequent bash commands.\\\\n__Example: Setting individual environment variables__\\\\n\\\\n```\\\\n#!/bin/bash\\\\n\\\\nif [ -n \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\" ]; then\\\\n  echo 'export NODE_ENV=production' >> \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\"\\\\n  echo 'export API_KEY=your-api-key' >> \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\"\\\\n  echo 'export PATH=\\\\\\\"$PATH:./node_modules/.bin\\\\\\\"' >> \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\"\\\\nfi\\\\n\\\\nexit 0\\\\n```\\\\n\\\\n__Example: Persisting all environment changes from the hook__\\\\nWhen your setup modifies the environment (for example, `nvm use`), capture and persist all changes by diffing the environment:\\\\n\\\\n```\\\\n#!/bin/bash\\\\n\\\\nENV_BEFORE=$(export -p | sort)\\\\n\\\\n# Run your setup commands that modify the environment\\\\nsource ~/.nvm/nvm.sh\\\\nnvm use 20\\\\n\\\\nif [ -n \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\" ]; then\\\\n  ENV_AFTER=$(export -p | sort)\\\\n  comm -13 <(echo \\\\\\\"$ENV_BEFORE\\\\\\\") <(echo \\\\\\\"$ENV_AFTER\\\\\\\") >> \\\\\\\"$CLAUDE_ENV_FILE\\\\\\\"\\\\nfi\\\\n\\\\nexit 0\\\\n```\\\\n\\\\nAny variables written to this file will be available in all subsequent bash commands that Claude Code executes during the session.\\\\n\\\\n### SessionEnd\\\\n\\\\nRuns when a Claude Code session ends. Useful for cleanup tasks, logging session\\\\nstatistics, or saving session state.\\\\nThe `reason` field in the hook input will be one of:\\\\n\\\\n- `clear` - Session cleared with /clear command\\\\n- `logout` - User logged out\\\\n- `prompt_input_exit` - User exited while prompt input was visible\\\\n- `other` - Other exit reasons\\\\n\\\\n## Hook Input\\\\n\\\\nHooks receive JSON data via stdin containing session information and\\\\nevent-specific data:\\\\n\\\\n```\\\\n{\\\\n  // Common fields\\\\n  session_id: string\\\\n  transcript_path: string  // Path to conversation JSON\\\\n  cwd: string              // The current working directory when the hook is invoked\\\\n  permission_mode: string  // Current permission mode: \\\\\\\"default\\\\\\\", \\\\\\\"plan\\\\\\\", \\\\\\\"acceptEdits\\\\\\\", \\\\\\\"dontAsk\\\\\\\", or \\\\\\\"bypassPermissions\\\\\\\"\\\\n\\\\n  // Event-specific fields\\\\n  hook_event_name: string\\\\n  ...\\\\n}\\\\n```\\\\n\\\\n### PreToolUse Input\\\\n\\\\nThe exact schema for `tool_input` depends on the tool. Here are examples for commonly hooked tools.\\\\n\\\\n#### Bash tool\\\\n\\\\nThe Bash tool is the most commonly hooked tool for command validation:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PreToolUse\\\\\\\",\\\\n  \\\\\\\"tool_name\\\\\\\": \\\\\\\"Bash\\\\\\\",\\\\n  \\\\\\\"tool_input\\\\\\\": {\\\\n    \\\\\\\"command\\\\\\\": \\\\\\\"psql -c 'SELECT * FROM users'\\\\\\\",\\\\n    \\\\\\\"description\\\\\\\": \\\\\\\"Query the users table\\\\\\\",\\\\n    \\\\\\\"timeout\\\\\\\": 120000\\\\n  },\\\\n  \\\\\\\"tool_use_id\\\\\\\": \\\\\\\"toolu_01ABC123...\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n| Field | Type | Description |\\\\n| --- | --- | --- |\\\\n| `command` | string | The shell command to execute |\\\\n| `description` | string | Optional description of what the command does |\\\\n| `timeout` | number | Optional timeout in milliseconds |\\\\n| `run_in_background` | boolean | Whether to run the command in background |\\\\n\\\\n#### Write tool\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PreToolUse\\\\\\\",\\\\n  \\\\\\\"tool_name\\\\\\\": \\\\\\\"Write\\\\\\\",\\\\n  \\\\\\\"tool_input\\\\\\\": {\\\\n    \\\\\\\"file_path\\\\\\\": \\\\\\\"/path/to/file.txt\\\\\\\",\\\\n    \\\\\\\"content\\\\\\\": \\\\\\\"file content\\\\\\\"\\\\n  },\\\\n  \\\\\\\"tool_use_id\\\\\\\": \\\\\\\"toolu_01ABC123...\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n| Field | Type | Description |\\\\n| --- | --- | --- |\\\\n| `file_path` | string | Absolute path to the file to write |\\\\n| `content` | string | Content to write to the file |\\\\n\\\\n#### Edit tool\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PreToolUse\\\\\\\",\\\\n  \\\\\\\"tool_name\\\\\\\": \\\\\\\"Edit\\\\\\\",\\\\n  \\\\\\\"tool_input\\\\\\\": {\\\\n    \\\\\\\"file_path\\\\\\\": \\\\\\\"/path/to/file.txt\\\\\\\",\\\\n    \\\\\\\"old_string\\\\\\\": \\\\\\\"original text\\\\\\\",\\\\n    \\\\\\\"new_string\\\\\\\": \\\\\\\"replacement text\\\\\\\"\\\\n  },\\\\n  \\\\\\\"tool_use_id\\\\\\\": \\\\\\\"toolu_01ABC123...\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n| Field | Type | Description |\\\\n| --- | --- | --- |\\\\n| `file_path` | string | Absolute path to the file to edit |\\\\n| `old_string` | string | Text to find and replace |\\\\n| `new_string` | string | Replacement text |\\\\n| `replace_all` | boolean | Whether to replace all occurrences (default: false) |\\\\n\\\\n#### Read tool\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PreToolUse\\\\\\\",\\\\n  \\\\\\\"tool_name\\\\\\\": \\\\\\\"Read\\\\\\\",\\\\n  \\\\\\\"tool_input\\\\\\\": {\\\\n    \\\\\\\"file_path\\\\\\\": \\\\\\\"/path/to/file.txt\\\\\\\"\\\\n  },\\\\n  \\\\\\\"tool_use_id\\\\\\\": \\\\\\\"toolu_01ABC123...\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n| Field | Type | Description |\\\\n| --- | --- | --- |\\\\n| `file_path` | string | Absolute path to the file to read |\\\\n| `offset` | number | Optional line number to start reading from |\\\\n| `limit` | number | Optional number of lines to read |\\\\n\\\\n### PostToolUse Input\\\\n\\\\nThe exact schema for `tool_input` and `tool_response` depends on the tool.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PostToolUse\\\\\\\",\\\\n  \\\\\\\"tool_name\\\\\\\": \\\\\\\"Write\\\\\\\",\\\\n  \\\\\\\"tool_input\\\\\\\": {\\\\n    \\\\\\\"file_path\\\\\\\": \\\\\\\"/path/to/file.txt\\\\\\\",\\\\n    \\\\\\\"content\\\\\\\": \\\\\\\"file content\\\\\\\"\\\\n  },\\\\n  \\\\\\\"tool_response\\\\\\\": {\\\\n    \\\\\\\"filePath\\\\\\\": \\\\\\\"/path/to/file.txt\\\\\\\",\\\\n    \\\\\\\"success\\\\\\\": true\\\\n  },\\\\n  \\\\\\\"tool_use_id\\\\\\\": \\\\\\\"toolu_01ABC123...\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n### Notification Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"Notification\\\\\\\",\\\\n  \\\\\\\"message\\\\\\\": \\\\\\\"Claude needs your permission to use Bash\\\\\\\",\\\\n  \\\\\\\"notification_type\\\\\\\": \\\\\\\"permission_prompt\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n### UserPromptSubmit Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"/Users/.../.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"UserPromptSubmit\\\\\\\",\\\\n  \\\\\\\"prompt\\\\\\\": \\\\\\\"Write a function to calculate the factorial of a number\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n### Stop Input\\\\n\\\\n`stop_hook_active` is true when Claude Code is already continuing as a result of\\\\na stop hook. Check this value or process the transcript to prevent Claude Code\\\\nfrom running indefinitely.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"Stop\\\\\\\",\\\\n  \\\\\\\"stop_hook_active\\\\\\\": true\\\\n}\\\\n```\\\\n\\\\n### SubagentStop Input\\\\n\\\\nTriggered when a subagent finishes. The `transcript_path` is the main session’s transcript, while `agent_transcript_path` is the subagent’s own transcript stored in a nested `subagents/` folder.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../abc123.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"SubagentStop\\\\\\\",\\\\n  \\\\\\\"stop_hook_active\\\\\\\": false,\\\\n  \\\\\\\"agent_id\\\\\\\": \\\\\\\"def456\\\\\\\",\\\\n  \\\\\\\"agent_transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../abc123/subagents/agent-def456.jsonl\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n### PreCompact Input\\\\n\\\\nFor `manual`, `custom_instructions` comes from what the user passes into\\\\n`/compact`. For `auto`, `custom_instructions` is empty.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"PreCompact\\\\\\\",\\\\n  \\\\\\\"trigger\\\\\\\": \\\\\\\"manual\\\\\\\",\\\\n  \\\\\\\"custom_instructions\\\\\\\": \\\\\\\"\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n### Setup Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"Setup\\\\\\\",\\\\n  \\\\\\\"trigger\\\\\\\": \\\\\\\"init\\\\\\\"\\\\n}\\\\n```\\\\n\\\\nThe `trigger` field will be either `\\\\\\\"init\\\\\\\"` (from `--init` or `--init-only`) or `\\\\\\\"maintenance\\\\\\\"` (from `--maintenance`).\\\\n\\\\n### SessionStart Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"SessionStart\\\\\\\",\\\\n  \\\\\\\"source\\\\\\\": \\\\\\\"startup\\\\\\\",\\\\n  \\\\\\\"model\\\\\\\": \\\\\\\"claude-sonnet-4-20250514\\\\\\\"\\\\n}\\\\n```\\\\n\\\\nThe `source` field indicates how the session started: `\\\\\\\"startup\\\\\\\"` for new sessions, `\\\\\\\"resume\\\\\\\"` for resumed sessions, `\\\\\\\"clear\\\\\\\"` after `/clear`, or `\\\\\\\"compact\\\\\\\"` after compaction. The `model` field contains the model identifier when available. If you start Claude Code with `claude --agent <name>`, an `agent_type` field contains the agent name.\\\\n\\\\n### SubagentStart Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"SubagentStart\\\\\\\",\\\\n  \\\\\\\"agent_id\\\\\\\": \\\\\\\"agent-abc123\\\\\\\",\\\\n  \\\\\\\"agent_type\\\\\\\": \\\\\\\"Explore\\\\\\\"\\\\n}\\\\n```\\\\n\\\\nTriggered when a subagent is spawned. The `agent_id` field contains the unique identifier for the subagent, and `agent_type` contains the agent name (built-in agents like `\\\\\\\"Bash\\\\\\\"`, `\\\\\\\"Explore\\\\\\\"`, `\\\\\\\"Plan\\\\\\\"`, or custom agent names).\\\\n\\\\n### SessionEnd Input\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"session_id\\\\\\\": \\\\\\\"abc123\\\\\\\",\\\\n  \\\\\\\"transcript_path\\\\\\\": \\\\\\\"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl\\\\\\\",\\\\n  \\\\\\\"cwd\\\\\\\": \\\\\\\"/Users/...\\\\\\\",\\\\n  \\\\\\\"permission_mode\\\\\\\": \\\\\\\"default\\\\\\\",\\\\n  \\\\\\\"hook_event_name\\\\\\\": \\\\\\\"SessionEnd\\\\\\\",\\\\n  \\\\\\\"reason\\\\\\\": \\\\\\\"exit\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n## Hook Output\\\\n\\\\nThere are two mutually exclusive ways for hooks to return output back to Claude Code. The output\\\\ncommunicates whether to block and any feedback that should be shown to Claude\\\\nand the user.\\\\n\\\\n### Simple: Exit Code\\\\n\\\\nHooks communicate status through exit codes, stdout, and stderr:\\\\n\\\\n- __Exit code 0__: Success. `stdout` is shown to the user in verbose mode\\\\n  (ctrl+o), except for `UserPromptSubmit` and `SessionStart`, where stdout is\\\\n  added to the context. JSON output in `stdout` is parsed for structured control\\\\n  (see Advanced: JSON Output).\\\\n- __Exit code 2__: Blocking error. Only `stderr` is used as the error message\\\\n  and fed back to Claude. The format is `[command]: {stderr}`. JSON in `stdout`\\\\n  is __not__ processed for exit code 2. See per-hook-event behavior below.\\\\n- __Other exit codes__: Non-blocking error. `stderr` is shown to the user in verbose mode (ctrl+o) with\\\\n  format `Failed with non-blocking status code: {stderr}`. If `stderr` is empty,\\\\n  it shows `No stderr output`. Execution continues.\\\\n\\\\n#### Exit Code 2 Behavior\\\\n\\\\n| Hook Event | Behavior |\\\\n| --- | --- |\\\\n| `PreToolUse` | Blocks the tool call, shows stderr to Claude |\\\\n| `PermissionRequest` | Denies the permission, shows stderr to Claude |\\\\n| `PostToolUse` | Shows stderr to Claude (tool already ran) |\\\\n| `Notification` | N/A, shows stderr to user only |\\\\n| `UserPromptSubmit` | Blocks prompt processing, erases prompt, shows stderr to user only |\\\\n| `Stop` | Blocks stoppage, shows stderr to Claude |\\\\n| `SubagentStop` | Blocks stoppage, shows stderr to Claude subagent |\\\\n| `PreCompact` | N/A, shows stderr to user only |\\\\n| `Setup` | N/A, shows stderr to user only |\\\\n| `SessionStart` | N/A, shows stderr to user only |\\\\n| `SessionEnd` | N/A, shows stderr to user only |\\\\n\\\\n### Advanced: JSON Output\\\\n\\\\nHooks can return structured JSON in `stdout` for more sophisticated control.\\\\n\\\\n#### Common JSON Fields\\\\n\\\\nAll hook types can include these optional fields:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"continue\\\\\\\": true, // Whether Claude should continue after hook execution (default: true)\\\\n  \\\\\\\"stopReason\\\\\\\": \\\\\\\"string\\\\\\\", // Message shown when continue is false\\\\n\\\\n  \\\\\\\"suppressOutput\\\\\\\": true, // Hide stdout from transcript mode (default: false)\\\\n  \\\\\\\"systemMessage\\\\\\\": \\\\\\\"string\\\\\\\" // Optional warning message shown to the user\\\\n}\\\\n```\\\\n\\\\nIf `continue` is false, Claude stops processing after the hooks run.\\\\n\\\\n- For `PreToolUse`, this is different from `\\\\\\\"permissionDecision\\\\\\\": \\\\\\\"deny\\\\\\\"`, which\\\\n  only blocks a specific tool call and provides automatic feedback to Claude.\\\\n- For `PostToolUse`, this is different from `\\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\"`, which\\\\n  provides automated feedback to Claude.\\\\n- For `UserPromptSubmit`, this prevents the prompt from being processed.\\\\n- For `Stop` and `SubagentStop`, this takes precedence over any\\\\n  `\\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\"` output.\\\\n- In all cases, `\\\\\\\"continue\\\\\\\" = false` takes precedence over any\\\\n  `\\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\"` output.\\\\n\\\\n`stopReason` accompanies `continue` with a reason shown to the user, not shown\\\\nto Claude.\\\\n\\\\n#### `PreToolUse` Decision Control\\\\n\\\\n`PreToolUse` hooks can control whether a tool call proceeds.\\\\n\\\\n- `\\\\\\\"allow\\\\\\\"` bypasses the permission system. `permissionDecisionReason` is shown\\\\n  to the user but not to Claude.\\\\n- `\\\\\\\"deny\\\\\\\"` prevents the tool call from executing. `permissionDecisionReason` is\\\\n  shown to Claude.\\\\n- `\\\\\\\"ask\\\\\\\"` asks the user to confirm the tool call in the UI.\\\\n  `permissionDecisionReason` is shown to the user but not to Claude.\\\\n\\\\nAdditionally, hooks can modify tool inputs before execution using `updatedInput`:\\\\n\\\\n- `updatedInput` modifies the tool’s input parameters before the tool executes\\\\n- Combine with `\\\\\\\"permissionDecision\\\\\\\": \\\\\\\"allow\\\\\\\"` to modify the input and auto-approve the tool call\\\\n- Combine with `\\\\\\\"permissionDecision\\\\\\\": \\\\\\\"ask\\\\\\\"` to modify the input and show it to the user for confirmation\\\\n\\\\nHooks can also provide context to Claude using `additionalContext`:\\\\n\\\\n- `\\\\\\\"hookSpecificOutput.additionalContext\\\\\\\"` adds a string to Claude’s context before the tool executes.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"PreToolUse\\\\\\\",\\\\n    \\\\\\\"permissionDecision\\\\\\\": \\\\\\\"allow\\\\\\\",\\\\n    \\\\\\\"permissionDecisionReason\\\\\\\": \\\\\\\"My reason here\\\\\\\",\\\\n    \\\\\\\"updatedInput\\\\\\\": {\\\\n      \\\\\\\"field_to_modify\\\\\\\": \\\\\\\"new value\\\\\\\"\\\\n    },\\\\n    \\\\\\\"additionalContext\\\\\\\": \\\\\\\"Current environment: production. Proceed with caution.\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `PermissionRequest` Decision Control\\\\n\\\\n`PermissionRequest` hooks can allow or deny permission requests shown to the user.\\\\n\\\\n- For `\\\\\\\"behavior\\\\\\\": \\\\\\\"allow\\\\\\\"` you can also optionally pass in an `\\\\\\\"updatedInput\\\\\\\"` that modifies the tool’s input parameters before the tool executes.\\\\n- For `\\\\\\\"behavior\\\\\\\": \\\\\\\"deny\\\\\\\"` you can also optionally pass in a `\\\\\\\"message\\\\\\\"` string that tells the model why the permission was denied, and a boolean `\\\\\\\"interrupt\\\\\\\"` which will stop Claude.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"PermissionRequest\\\\\\\",\\\\n    \\\\\\\"decision\\\\\\\": {\\\\n      \\\\\\\"behavior\\\\\\\": \\\\\\\"allow\\\\\\\",\\\\n      \\\\\\\"updatedInput\\\\\\\": {\\\\n        \\\\\\\"command\\\\\\\": \\\\\\\"npm run lint\\\\\\\"\\\\n      }\\\\n    }\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `PostToolUse` Decision Control\\\\n\\\\n`PostToolUse` hooks can provide feedback to Claude after tool execution.\\\\n\\\\n- `\\\\\\\"block\\\\\\\"` automatically prompts Claude with `reason`.\\\\n- `undefined` does nothing. `reason` is ignored.\\\\n- `\\\\\\\"hookSpecificOutput.additionalContext\\\\\\\"` adds context for Claude to consider.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\" | undefined,\\\\n  \\\\\\\"reason\\\\\\\": \\\\\\\"Explanation for decision\\\\\\\",\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"PostToolUse\\\\\\\",\\\\n    \\\\\\\"additionalContext\\\\\\\": \\\\\\\"Additional information for Claude\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `UserPromptSubmit` Decision Control\\\\n\\\\n`UserPromptSubmit` hooks can control whether a user prompt is processed and add context.\\\\n__Adding context (exit code 0):__\\\\nThere are two ways to add context to the conversation:\\\\n\\\\n1. __Plain text stdout__ (simpler): Any non-JSON text written to stdout is added\\\\n   as context. This is the easiest way to inject information.\\\\n2. __JSON with `additionalContext`__ (structured): Use the JSON format below for\\\\n   more control. The `additionalContext` field is added as context.\\\\n\\\\nBoth methods work with exit code 0. Plain stdout is shown as hook output in\\\\nthe transcript; `additionalContext` is added more discretely.\\\\n__Blocking prompts:__\\\\n\\\\n- `\\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\"` prevents the prompt from being processed. The submitted\\\\n  prompt is erased from context. `\\\\\\\"reason\\\\\\\"` is shown to the user but not added\\\\n  to context.\\\\n- `\\\\\\\"decision\\\\\\\": undefined` (or omitted) allows the prompt to proceed normally.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\" | undefined,\\\\n  \\\\\\\"reason\\\\\\\": \\\\\\\"Explanation for decision\\\\\\\",\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"UserPromptSubmit\\\\\\\",\\\\n    \\\\\\\"additionalContext\\\\\\\": \\\\\\\"My additional context here\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `Stop`/`SubagentStop` Decision Control\\\\n\\\\n`Stop` and `SubagentStop` hooks can control whether Claude must continue.\\\\n\\\\n- `\\\\\\\"block\\\\\\\"` prevents Claude from stopping. You must populate `reason` for Claude\\\\n  to know how to proceed.\\\\n- `undefined` allows Claude to stop. `reason` is ignored.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\" | undefined,\\\\n  \\\\\\\"reason\\\\\\\": \\\\\\\"Must be provided when Claude is blocked from stopping\\\\\\\"\\\\n}\\\\n```\\\\n\\\\n#### `Setup` Decision Control\\\\n\\\\n`Setup` hooks allow you to load context and configure the environment during repository initialization or maintenance.\\\\n\\\\n- `\\\\\\\"hookSpecificOutput.additionalContext\\\\\\\"` adds the string to the context.\\\\n- Multiple hooks’ `additionalContext` values are concatenated.\\\\n- Setup hooks have access to `CLAUDE_ENV_FILE` for persisting environment variables.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"Setup\\\\\\\",\\\\n    \\\\\\\"additionalContext\\\\\\\": \\\\\\\"Repository initialized with custom configuration\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `SessionStart` Decision Control\\\\n\\\\n`SessionStart` hooks allow you to load in context at the start of a session.\\\\n\\\\n- `\\\\\\\"hookSpecificOutput.additionalContext\\\\\\\"` adds the string to the context.\\\\n- Multiple hooks’ `additionalContext` values are concatenated.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"SessionStart\\\\\\\",\\\\n    \\\\\\\"additionalContext\\\\\\\": \\\\\\\"My additional context here\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `SessionEnd` Decision Control\\\\n\\\\n`SessionEnd` hooks run when a session ends. They cannot block session termination\\\\nbut can perform cleanup tasks.\\\\n\\\\n#### Exit Code Example: Bash Command Validation\\\\n\\\\n```\\\\n#!/usr/bin/env python3\\\\nimport json\\\\nimport re\\\\nimport sys\\\\n\\\\n# Define validation rules as a list of (regex pattern, message) tuples\\\\nVALIDATION_RULES = [\\\\n    (\\\\n        r\\\\\\\"\\\\\\\\bgrep\\\\\\\\b(?!.*\\\\\\\\|)\\\\\\\",\\\\n        \\\\\\\"Use 'rg' (ripgrep) instead of 'grep' for better performance and features\\\\\\\",\\\\n    ),\\\\n    (\\\\n        r\\\\\\\"\\\\\\\\bfind\\\\\\\\s+\\\\\\\\S+\\\\\\\\s+-name\\\\\\\\b\\\\\\\",\\\\n        \\\\\\\"Use 'rg --files | rg pattern' or 'rg --files -g pattern' instead of 'find -name' for better performance\\\\\\\",\\\\n    ),\\\\n]\\\\n\\\\ndef validate_command(command: str) -> list[str]:\\\\n    issues = []\\\\n    for pattern, message in VALIDATION_RULES:\\\\n        if re.search(pattern, command):\\\\n            issues.append(message)\\\\n    return issues\\\\n\\\\ntry:\\\\n    input_data = json.load(sys.stdin)\\\\nexcept json.JSONDecodeError as e:\\\\n    print(f\\\\\\\"Error: Invalid JSON input: {e}\\\\\\\", file=sys.stderr)\\\\n    sys.exit(1)\\\\n\\\\ntool_name = input_data.get(\\\\\\\"tool_name\\\\\\\", \\\\\\\"\\\\\\\")\\\\ntool_input = input_data.get(\\\\\\\"tool_input\\\\\\\", {})\\\\ncommand = tool_input.get(\\\\\\\"command\\\\\\\", \\\\\\\"\\\\\\\")\\\\n\\\\nif tool_name != \\\\\\\"Bash\\\\\\\" or not command:\\\\n    sys.exit(1)\\\\n\\\\n# Validate the command\\\\nissues = validate_command(command)\\\\n\\\\nif issues:\\\\n    for message in issues:\\\\n        print(f\\\\\\\"• {message}\\\\\\\", file=sys.stderr)\\\\n    # Exit code 2 blocks tool call and shows stderr to Claude\\\\n    sys.exit(2)\\\\n```\\\\n\\\\n#### JSON Output Example: UserPromptSubmit to Add Context and Validation\\\\n\\\\n```\\\\n#!/usr/bin/env python3\\\\nimport json\\\\nimport sys\\\\nimport re\\\\nimport datetime\\\\n\\\\n# Load input from stdin\\\\ntry:\\\\n    input_data = json.load(sys.stdin)\\\\nexcept json.JSONDecodeError as e:\\\\n    print(f\\\\\\\"Error: Invalid JSON input: {e}\\\\\\\", file=sys.stderr)\\\\n    sys.exit(1)\\\\n\\\\nprompt = input_data.get(\\\\\\\"prompt\\\\\\\", \\\\\\\"\\\\\\\")\\\\n\\\\n# Check for sensitive patterns\\\\nsensitive_patterns = [\\\\n    (r\\\\\\\"(?i)\\\\\\\\b(password|secret|key|token)\\\\\\\\s*[:=]\\\\\\\", \\\\\\\"Prompt contains potential secrets\\\\\\\"),\\\\n]\\\\n\\\\nfor pattern, message in sensitive_patterns:\\\\n    if re.search(pattern, prompt):\\\\n        # Use JSON output to block with a specific reason\\\\n        output = {\\\\n            \\\\\\\"decision\\\\\\\": \\\\\\\"block\\\\\\\",\\\\n            \\\\\\\"reason\\\\\\\": f\\\\\\\"Security policy violation: {message}. Please rephrase your request without sensitive information.\\\\\\\"\\\\n        }\\\\n        print(json.dumps(output))\\\\n        sys.exit(0)\\\\n\\\\n# Add current time to context\\\\ncontext = f\\\\\\\"Current time: {datetime.datetime.now()}\\\\\\\"\\\\nprint(context)\\\\n\\\\n\\\\\\\"\\\\\\\"\\\\\\\"\\\\nThe following is also equivalent:\\\\nprint(json.dumps({\\\\n  \\\\\\\"hookSpecificOutput\\\\\\\": {\\\\n    \\\\\\\"hookEventName\\\\\\\": \\\\\\\"UserPromptSubmit\\\\\\\",\\\\n    \\\\\\\"additionalContext\\\\\\\": context,\\\\n  },\\\\n}))\\\\n\\\\\\\"\\\\\\\"\\\\\\\"\\\\n\\\\n# Allow the prompt to proceed with the additional context\\\\nsys.exit(0)\\\\n```\\\\n\\\\n#### JSON Output Example: PreToolUse with Approval\\\\n\\\\n```\\\\n#!/usr/bin/env python3\\\\nimport json\\\\nimport sys\\\\n\\\\n# Load input from stdin\\\\ntry:\\\\n    input_data = json.load(sys.stdin)\\\\nexcept json.JSONDecodeError as e:\\\\n    print(f\\\\\\\"Error: Invalid JSON input: {e}\\\\\\\", file=sys.stderr)\\\\n    sys.exit(1)\\\\n\\\\ntool_name = input_data.get(\\\\\\\"tool_name\\\\\\\", \\\\\\\"\\\\\\\")\\\\ntool_input = input_data.get(\\\\\\\"tool_input\\\\\\\", {})\\\\n\\\\n# Example: Auto-approve file reads for documentation files\\\\nif tool_name == \\\\\\\"Read\\\\\\\":\\\\n    file_path = tool_input.get(\\\\\\\"file_path\\\\\\\", \\\\\\\"\\\\\\\")\\\\n    if file_path.endswith((\\\\\\\".md\\\\\\\", \\\\\\\".mdx\\\\\\\", \\\\\\\".txt\\\\\\\", \\\\\\\".json\\\\\\\")):\\\\n        # Use JSON output to auto-approve the tool call\\\\n        output = {\\\\n            \\\\\\\"decision\\\\\\\": \\\\\\\"approve\\\\\\\",\\\\n            \\\\\\\"reason\\\\\\\": \\\\\\\"Documentation file auto-approved\\\\\\\",\\\\n            \\\\\\\"suppressOutput\\\\\\\": True  # Don't show in verbose mode\\\\n        }\\\\n        print(json.dumps(output))\\\\n        sys.exit(0)\\\\n\\\\n# For other cases, let the normal permission flow proceed\\\\nsys.exit(0)\\\\n```\\\\n\\\\nClaude Code hooks work seamlessly with\\\\nModel Context Protocol (MCP) tools. When MCP servers\\\\nprovide tools, they appear with a special naming pattern that you can match in\\\\nyour hooks.\\\\n\\\\n### MCP Tool Naming\\\\n\\\\nMCP tools follow the pattern `mcp__<server>__<tool>`, for example:\\\\n\\\\n- `mcp__memory__create_entities` - Memory server’s create entities tool\\\\n- `mcp__filesystem__read_file` - Filesystem server’s read file tool\\\\n- `mcp__github__search_repositories` - GitHub server’s search tool\\\\n\\\\n### Configuring Hooks for MCP Tools\\\\n\\\\nYou can target specific MCP tools or entire MCP servers:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PreToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"mcp__memory__.*\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"echo 'Memory operation initiated' >> ~/mcp-operations.log\\\\\\\"\\\\n          }\\\\n        ]\\\\n      },\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"mcp__.*__write.*\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"/home/user/scripts/validate-mcp-write.py\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n## Examples\\\\n\\\\n## Security Considerations\\\\n\\\\n### Disclaimer\\\\n\\\\n__USE AT YOUR OWN RISK__: Claude Code hooks execute arbitrary shell commands on\\\\nyour system automatically. By using hooks, you acknowledge that:\\\\n\\\\n- You are solely responsible for the commands you configure\\\\n- Hooks can modify, delete, or access any files your user account can access\\\\n- Malicious or poorly written hooks can cause data loss or system damage\\\\n- Anthropic provides no warranty and assumes no liability for any damages\\\\n  resulting from hook usage\\\\n- You should thoroughly test hooks in a safe environment before production use\\\\n\\\\nAlways review and understand any hook commands before adding them to your\\\\nconfiguration.\\\\n\\\\n### Security Best Practices\\\\n\\\\nHere are some key practices for writing more secure hooks:\\\\n\\\\n1. __Validate and sanitize inputs__ - Never trust input data blindly\\\\n2. __Always quote shell variables__ - Use `\\\\\\\"$VAR\\\\\\\"` not `$VAR`\\\\n3. __Block path traversal__ - Check for `..` in file paths\\\\n4. __Use absolute paths__ - Specify full paths for scripts (use\\\\n   “$CLAUDE_PROJECT_DIR” for the project path)\\\\n5. __Skip sensitive files__ - Avoid `.env`, `.git/`, keys, etc.\\\\n\\\\n### Configuration Safety\\\\n\\\\nDirect edits to hooks in settings files don’t take effect immediately. Claude\\\\nCode:\\\\n\\\\n1. Captures a snapshot of hooks at startup\\\\n2. Uses this snapshot throughout the session\\\\n3. Warns if hooks are modified externally\\\\n4. Requires review in `/hooks` menu for changes to apply\\\\n\\\\nThis prevents malicious hook modifications from affecting your current session.\\\\n\\\\n## Hook Execution Details\\\\n\\\\n- __Timeout__: 60-second execution limit by default, configurable per command.\\\\n  - A timeout for an individual command does not affect the other commands.\\\\n- __Parallelization__: All matching hooks run in parallel\\\\n- __Deduplication__: Multiple identical hook commands are deduplicated automatically\\\\n- __Environment__: Runs in current directory with Claude Code’s environment\\\\n  - The `CLAUDE_PROJECT_DIR` environment variable is available and contains the\\\\n    absolute path to the project root directory (where Claude Code was started)\\\\n  - The `CLAUDE_CODE_REMOTE` environment variable indicates whether the hook is running in a remote (web) environment (`\\\\\\\"true\\\\\\\"`) or local CLI environment (not set or empty). Use this to run different logic based on execution context.\\\\n- __Input__: JSON via stdin\\\\n- __Output__:\\\\n  - PreToolUse/PermissionRequest/PostToolUse/Stop/SubagentStop: Progress shown in verbose mode (ctrl+o)\\\\n  - Notification/SessionEnd: Logged to debug only (`--debug`)\\\\n  - UserPromptSubmit/SessionStart/Setup: stdout added as context for Claude\\\\n\\\\n## Debugging\\\\n\\\\n### Basic Troubleshooting\\\\n\\\\nIf your hooks aren’t working:\\\\n\\\\n1. __Check configuration__ - Run `/hooks` to see if your hook is registered\\\\n2. __Verify syntax__ - Ensure your JSON settings are valid\\\\n3. __Test commands__ - Run hook commands manually first\\\\n4. __Check permissions__ - Make sure scripts are executable\\\\n5. __Review logs__ - Use `claude --debug` to see hook execution details\\\\n\\\\nCommon issues:\\\\n\\\\n- __Quotes not escaped__ - Use `\\\\\\\\\\\\\\\"` inside JSON strings\\\\n- __Wrong matcher__ - Check tool names match exactly (case-sensitive)\\\\n- __Command not found__ - Use full paths for scripts\\\\n\\\\n### Advanced Debugging\\\\n\\\\nFor complex hook issues:\\\\n\\\\n1. __Inspect hook execution__ - Use `claude --debug` to see detailed hook\\\\n   execution\\\\n2. __Validate JSON schemas__ - Test hook input/output with external tools\\\\n3. __Check environment variables__ - Verify Claude Code’s environment is correct\\\\n4. __Test edge cases__ - Try hooks with unusual file paths or inputs\\\\n5. __Monitor system resources__ - Check for resource exhaustion during hook\\\\n   execution\\\\n6. __Use structured logging__ - Implement logging in your hook scripts\\\\n\\\\n### Debug Output Example\\\\n\\\\nUse `claude --debug` to see hook execution details:\\\\n\\\\n```\\\\n[DEBUG] Executing hooks for PostToolUse:Write\\\\n[DEBUG] Getting matching hook commands for PostToolUse with query: Write\\\\n[DEBUG] Found 1 hook matchers in settings\\\\n[DEBUG] Matched 1 hooks for query \\\\\\\"Write\\\\\\\"\\\\n[DEBUG] Found 1 hook commands to execute\\\\n[DEBUG] Executing hook command: <Your command> with timeout 60000ms\\\\n[DEBUG] Hook command completed with status 0: <Your stdout>\\\\n```\\\\n\\\\nProgress messages appear in verbose mode (ctrl+o) showing:\\\\n\\\\n- Which hook is running\\\\n- Command being executed\\\\n- Success/failure status\\\\n- Output or error messages\\\",\\\"metadata\\\":{\\\"application-name\\\":\\\"Claude Code Docs\\\",\\\"charset\\\":\\\"utf-8\\\",\\\"msapplication-config\\\":\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/browserconfig.xml\\\",\\\"og:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DReference%26appearance%3Dsystem%26title%3DHooks%2Breference%26description%3DThis%2Bpage%2Bprovides%2Breference%2Bdocumentation%2Bfor%2Bimplementing%2Bhooks%2Bin%2BClaude%2BCode.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"og:image:width\\\":\\\"1200\\\",\\\"og:type\\\":\\\"website\\\",\\\"twitter:card\\\":\\\"summary_large_image\\\",\\\"twitter:title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"og:site_name\\\":\\\"Claude Code Docs\\\",\\\"apple-mobile-web-app-title\\\":\\\"Claude Code Docs\\\",\\\"og:title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"og:image:height\\\":\\\"630\\\",\\\"twitter:image:height\\\":\\\"630\\\",\\\"description\\\":\\\"This page provides reference documentation for implementing hooks in Claude Code.\\\",\\\"generator\\\":\\\"Mintlify\\\",\\\"canonical\\\":\\\"https://code.claude.com/docs/en/hooks\\\",\\\"og:description\\\":\\\"This page provides reference documentation for implementing hooks in Claude Code.\\\",\\\"twitter:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DReference%26appearance%3Dsystem%26title%3DHooks%2Breference%26description%3DThis%2Bpage%2Bprovides%2Breference%2Bdocumentation%2Bfor%2Bimplementing%2Bhooks%2Bin%2BClaude%2BCode.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"msapplication-TileColor\\\":\\\"#0E0E0E\\\",\\\"twitter:image:width\\\":\\\"1200\\\",\\\"viewport\\\":\\\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\\\",\\\"twitter:description\\\":\\\"This page provides reference documentation for implementing hooks in Claude Code.\\\",\\\"lang\\\":\\\"en\\\",\\\"og:url\\\":\\\"https://code.claude.com/docs/en/hooks\\\"},\\\"external\\\":{\\\"stylesheet\\\":{\\\"/docs/_next/static/css/7a165ec44fc339bb.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/fa24c414dafe6537.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/93ae04b3d6755082.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://fonts.googleapis.com/css2?family=Anthropic+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&display=swap\\\":{}},\\\"preconnect\\\":{\\\"https://fonts.gstatic.com\\\":{},\\\"https://fonts.googleapis.com\\\":{}},\\\"shortcut\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/x-icon\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/x-icon\\\"}},\\\"icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"}},\\\"alternate\\\":{\\\"/docs/sitemap.xml\\\":{\\\"type\\\":\\\"application/xml\\\"}},\\\"canonical\\\":{\\\"https://code.claude.com/docs/en/hooks\\\":{}},\\\"preload\\\":{\\\"/docs/_next/static/chunks/50528.a008835b58c523ea.js?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/media/c4b700dcb2187787-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\\\":{},\\\"/docs/_next/static/chunks/webpack-de379d107534c796.js?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/dark.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=0766b3221061e80143e9f300733e640b\\\":{},\\\"/docs/_next/static/media/bb3ef058b751a6ad-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg\\\":{},\\\"/docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/light.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=536eade682636e84231afce2577f9509\\\":{}},\\\"apple-touch-icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/apple-touch-icon.png\\\":{\\\"sizes\\\":\\\"180x180\\\",\\\"type\\\":\\\"image/png\\\"}}}}\""}]}]},"uuid":"34e06d96-0fcf-4a16-be14-d55158ec5273","timestamp":"2026-01-26T05:36:40.723Z","sourceToolAssistantUUID":"8ceec84e-d47e-4289-9c33-133c769bcbde"}
{"parentUuid":"34e06d96-0fcf-4a16-be14-d55158ec5273","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-reader","toolName":"webReader"},"toolUseID":"call_0cc035102ca24b68a12c8a18","parentToolUseID":"call_0cc035102ca24b68a12c8a18","uuid":"a9e51785-ab43-4fa1-a9e7-e54f4537886b","timestamp":"2026-01-26T05:36:42.458Z"}
{"parentUuid":"a9e51785-ab43-4fa1-a9e7-e54f4537886b","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-reader","toolName":"webReader","elapsedTimeMs":2292},"toolUseID":"call_0cc035102ca24b68a12c8a18","parentToolUseID":"call_0cc035102ca24b68a12c8a18","uuid":"63f9c4cb-99e1-415c-9ee8-628a8321ef6c","timestamp":"2026-01-26T05:36:44.750Z"}
{"parentUuid":"b1212bdf-d6fb-4bfe-8a48-61c91e67d34a","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_0cc035102ca24b68a12c8a18","type":"tool_result","content":[{"type":"text","text":"\"{\\\"title\\\":\\\"Get started with Claude Code hooks - Claude Code Docs\\\",\\\"description\\\":\\\"Learn how to customize and extend Claude Code's behavior by registering shell commands\\\",\\\"url\\\":\\\"https://code.claude.com/docs/en/hooks-guide\\\",\\\"content\\\":\\\"Claude Code hooks are user-defined shell commands that execute at various points\\\\nin Claude Code’s lifecycle. Hooks provide deterministic control over Claude\\\\nCode’s behavior, ensuring certain actions always happen rather than relying on\\\\nthe LLM to choose to run them.\\\\n\\\\nExample use cases for hooks include:\\\\n\\\\n- __Notifications__: Customize how you get notified when Claude Code is awaiting\\\\n  your input or permission to run something.\\\\n- __Automatic formatting__: Run `prettier` on .ts files, `gofmt` on .go files,\\\\n  etc. after every file edit.\\\\n- __Logging__: Track and count all executed commands for compliance or\\\\n  debugging.\\\\n- __Feedback__: Provide automated feedback when Claude Code produces code that\\\\n  does not follow your codebase conventions.\\\\n- __Custom permissions__: Block modifications to production files or sensitive\\\\n  directories.\\\\n\\\\nBy encoding these rules as hooks rather than prompting instructions, you turn\\\\nsuggestions into app-level code that executes every time it is expected to run.\\\\n\\\\n## Hook Events Overview\\\\n\\\\nClaude Code provides several hook events that run at different points in the\\\\nworkflow:\\\\n\\\\n- __PreToolUse__: Runs before tool calls (can block them)\\\\n- __PermissionRequest__: Runs when a permission dialog is shown (can allow or deny)\\\\n- __PostToolUse__: Runs after tool calls complete\\\\n- __UserPromptSubmit__: Runs when the user submits a prompt, before Claude processes it\\\\n- __Notification__: Runs when Claude Code sends notifications\\\\n- __Stop__: Runs when Claude Code finishes responding\\\\n- __SubagentStop__: Runs when subagent tasks complete\\\\n- __PreCompact__: Runs before Claude Code is about to run a compact operation\\\\n- __Setup__: Runs when Claude Code is invoked with `--init`, `--init-only`, or `--maintenance` flags\\\\n- __SessionStart__: Runs when Claude Code starts a new session or resumes an existing session\\\\n- __SessionEnd__: Runs when Claude Code session ends\\\\n\\\\nEach event receives different data and can control Claude’s behavior in\\\\ndifferent ways.\\\\n\\\\n## Quickstart\\\\n\\\\nIn this quickstart, you’ll add a hook that logs the shell commands that Claude\\\\nCode runs.\\\\n\\\\n### Prerequisites\\\\n\\\\nInstall `jq` for JSON processing in the command line.\\\\n\\\\n### Step 1: Open hooks configuration\\\\n\\\\nRun the `/hooks` command and select\\\\nthe `PreToolUse` hook event.\\\\n`PreToolUse` hooks run before tool calls and can block them while providing\\\\nClaude feedback on what to do differently.\\\\n\\\\n### Step 2: Add a matcher\\\\n\\\\nSelect `+ Add new matcher…` to run your hook only on Bash tool calls.\\\\nType `Bash` for the matcher.\\\\n\\\\n### Step 3: Add the hook\\\\n\\\\nSelect `+ Add new hook…` and enter this command:\\\\n\\\\n```\\\\njq -r '\\\\\\\"\\\\\\\\(.tool_input.command) - \\\\\\\\(.tool_input.description // \\\\\\\"No description\\\\\\\")\\\\\\\"' >> ~/.claude/bash-command-log.txt\\\\n```\\\\n\\\\n### Step 4: Save your configuration\\\\n\\\\nFor storage location, select `User settings` since you’re logging to your home\\\\ndirectory. This hook will then apply to all projects, not just your current\\\\nproject.\\\\nThen press `Esc` until you return to the REPL. Your hook is now registered.\\\\n\\\\n### Step 5: Verify your hook\\\\n\\\\nRun `/hooks` again or check `~/.claude/settings.json` to see your configuration:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PreToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Bash\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"jq -r '\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\(.tool_input.command) - \\\\\\\\\\\\\\\\(.tool_input.description // \\\\\\\\\\\\\\\"No description\\\\\\\\\\\\\\\")\\\\\\\\\\\\\\\"' >> ~/.claude/bash-command-log.txt\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Step 6: Test your hook\\\\n\\\\nAsk Claude to run a simple command like `ls` and check your log file:\\\\n\\\\n```\\\\ncat ~/.claude/bash-command-log.txt\\\\n```\\\\n\\\\nYou should see entries like:\\\\n\\\\n```\\\\nls - Lists files and directories\\\\n```\\\\n\\\\n## More Examples\\\\n\\\\n### Code Formatting Hook\\\\n\\\\nAutomatically format TypeScript files after editing:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PostToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Edit|Write\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"jq -r '.tool_input.file_path' | { read file_path; if echo \\\\\\\\\\\\\\\"$file_path\\\\\\\\\\\\\\\" | grep -q '\\\\\\\\\\\\\\\\.ts$'; then npx prettier --write \\\\\\\\\\\\\\\"$file_path\\\\\\\\\\\\\\\"; fi; }\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### Markdown Formatting Hook\\\\n\\\\nAutomatically fix missing language tags and formatting issues in markdown files:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PostToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Edit|Write\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"\\\\\\\\\\\\\\\"$CLAUDE_PROJECT_DIR\\\\\\\\\\\\\\\"/.claude/hooks/markdown_formatter.py\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nCreate `.claude/hooks/markdown_formatter.py` with this content:\\\\n\\\\n```\\\\n#!/usr/bin/env python3\\\\n\\\\\\\"\\\\\\\"\\\\\\\"\\\\nMarkdown formatter for Claude Code output.\\\\nFixes missing language tags and spacing issues while preserving code content.\\\\n\\\\\\\"\\\\\\\"\\\\\\\"\\\\nimport json\\\\nimport sys\\\\nimport re\\\\nimport os\\\\n\\\\ndef detect_language(code):\\\\n    \\\\\\\"\\\\\\\"\\\\\\\"Best-effort language detection from code content.\\\\\\\"\\\\\\\"\\\\\\\"\\\\n    s = code.strip()\\\\n    \\\\n    # JSON detection\\\\n    if re.search(r'^\\\\\\\\s*[{\\\\\\\\[]', s):\\\\n        try:\\\\n            json.loads(s)\\\\n            return 'json'\\\\n        except:\\\\n            pass\\\\n    \\\\n    # Python detection\\\\n    if re.search(r'^\\\\\\\\s*def\\\\\\\\s+\\\\\\\\w+\\\\\\\\s*\\\\\\\\(', s, re.M) or \\\\\\\\\\\\n       re.search(r'^\\\\\\\\s*(import|from)\\\\\\\\s+\\\\\\\\w+', s, re.M):\\\\n        return 'python'\\\\n    \\\\n    # JavaScript detection  \\\\n    if re.search(r'\\\\\\\\b(function\\\\\\\\s+\\\\\\\\w+\\\\\\\\s*\\\\\\\\(|const\\\\\\\\s+\\\\\\\\w+\\\\\\\\s*=)', s) or \\\\\\\\\\\\n       re.search(r'=>|console\\\\\\\\.(log|error)', s):\\\\n        return 'javascript'\\\\n    \\\\n    # Bash detection\\\\n    if re.search(r'^#!.*\\\\\\\\b(bash|sh)\\\\\\\\b', s, re.M) or \\\\\\\\\\\\n       re.search(r'\\\\\\\\b(if|then|fi|for|in|do|done)\\\\\\\\b', s):\\\\n        return 'bash'\\\\n    \\\\n    # SQL detection\\\\n    if re.search(r'\\\\\\\\b(SELECT|INSERT|UPDATE|DELETE|CREATE)\\\\\\\\s+', s, re.I):\\\\n        return 'sql'\\\\n        \\\\n    return 'text'\\\\n\\\\ndef format_markdown(content):\\\\n    \\\\\\\"\\\\\\\"\\\\\\\"Format markdown content with language detection.\\\\\\\"\\\\\\\"\\\\\\\"\\\\n    # Fix unlabeled code fences\\\\n    def add_lang_to_fence(match):\\\\n        indent, info, body, closing = match.groups()\\\\n        if not info.strip():\\\\n            lang = detect_language(body)\\\\n            return f\\\\\\\"{indent}```{lang}\\\\\\\\n{body}{closing}\\\\\\\\n\\\\\\\"\\\\n        return match.group(0)\\\\n    \\\\n    fence_pattern = r'(?ms)^([ \\\\\\\\t]{0,3})```([^\\\\\\\\n]*)\\\\\\\\n(.*?)(\\\\\\\\n\\\\\\\\1```)\\\\\\\\s*$'\\\\n    content = re.sub(fence_pattern, add_lang_to_fence, content)\\\\n    \\\\n    # Fix excessive blank lines (only outside code fences)\\\\n    content = re.sub(r'\\\\\\\\n{3,}', '\\\\\\\\n\\\\\\\\n', content)\\\\n    \\\\n    return content.rstrip() + '\\\\\\\\n'\\\\n\\\\n# Main execution\\\\ntry:\\\\n    input_data = json.load(sys.stdin)\\\\n    file_path = input_data.get('tool_input', {}).get('file_path', '')\\\\n    \\\\n    if not file_path.endswith(('.md', '.mdx')):\\\\n        sys.exit(0)  # Not a markdown file\\\\n    \\\\n    if os.path.exists(file_path):\\\\n        with open(file_path, 'r', encoding='utf-8') as f:\\\\n            content = f.read()\\\\n        \\\\n        formatted = format_markdown(content)\\\\n        \\\\n        if formatted != content:\\\\n            with open(file_path, 'w', encoding='utf-8') as f:\\\\n                f.write(formatted)\\\\n            print(f\\\\\\\"✓ Fixed markdown formatting in {file_path}\\\\\\\")\\\\n    \\\\nexcept Exception as e:\\\\n    print(f\\\\\\\"Error formatting markdown: {e}\\\\\\\", file=sys.stderr)\\\\n    sys.exit(1)\\\\n```\\\\n\\\\nMake the script executable:\\\\n\\\\n```\\\\nchmod +x .claude/hooks/markdown_formatter.py\\\\n```\\\\n\\\\nThis hook automatically:\\\\n\\\\n- Detects programming languages in unlabeled code blocks\\\\n- Adds appropriate language tags for syntax highlighting\\\\n- Fixes excessive blank lines while preserving code content\\\\n- Only processes markdown files (`.md`, `.mdx`)\\\\n\\\\n### Custom Notification Hook\\\\n\\\\nGet desktop notifications when Claude needs input:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"Notification\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"notify-send 'Claude Code' 'Awaiting your input'\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### File Protection Hook\\\\n\\\\nBlock edits to sensitive files:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"PreToolUse\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"Edit|Write\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          {\\\\n            \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n            \\\\\\\"command\\\\\\\": \\\\\\\"python3 -c \\\\\\\\\\\\\\\"import json, sys; data=json.load(sys.stdin); path=data.get('tool_input',{}).get('file_path',''); sys.exit(2 if any(p in path for p in ['.env', 'package-lock.json', '.git/']) else 0)\\\\\\\\\\\\\\\"\\\\\\\"\\\\n          }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n## Learn more\\\\n\\\\n- For reference documentation on hooks, see Hooks reference.\\\\n- For comprehensive security best practices and safety guidelines, see Security Considerations in the hooks reference documentation.\\\\n- For troubleshooting steps and debugging techniques, see Debugging in the hooks reference\\\\n  documentation.\\\",\\\"metadata\\\":{\\\"application-name\\\":\\\"Claude Code Docs\\\",\\\"charset\\\":\\\"utf-8\\\",\\\"msapplication-config\\\":\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/browserconfig.xml\\\",\\\"og:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DBuild%2Bwith%2BClaude%2BCode%26appearance%3Dsystem%26title%3DGet%2Bstarted%2Bwith%2BClaude%2BCode%2Bhooks%26description%3DLearn%2Bhow%2Bto%2Bcustomize%2Band%2Bextend%2BClaude%2BCode%2527s%2Bbehavior%2Bby%2Bregistering%2Bshell%2Bcommands%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"og:image:width\\\":\\\"1200\\\",\\\"og:type\\\":\\\"website\\\",\\\"twitter:card\\\":\\\"summary_large_image\\\",\\\"twitter:title\\\":\\\"Get started with Claude Code hooks - Claude Code Docs\\\",\\\"og:site_name\\\":\\\"Claude Code Docs\\\",\\\"apple-mobile-web-app-title\\\":\\\"Claude Code Docs\\\",\\\"og:title\\\":\\\"Get started with Claude Code hooks - Claude Code Docs\\\",\\\"og:image:height\\\":\\\"630\\\",\\\"twitter:image:height\\\":\\\"630\\\",\\\"description\\\":\\\"Learn how to customize and extend Claude Code's behavior by registering shell commands\\\",\\\"generator\\\":\\\"Mintlify\\\",\\\"canonical\\\":\\\"https://code.claude.com/docs/en/hooks-guide\\\",\\\"og:description\\\":\\\"Learn how to customize and extend Claude Code's behavior by registering shell commands\\\",\\\"twitter:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DBuild%2Bwith%2BClaude%2BCode%26appearance%3Dsystem%26title%3DGet%2Bstarted%2Bwith%2BClaude%2BCode%2Bhooks%26description%3DLearn%2Bhow%2Bto%2Bcustomize%2Band%2Bextend%2BClaude%2BCode%2527s%2Bbehavior%2Bby%2Bregistering%2Bshell%2Bcommands%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"msapplication-TileColor\\\":\\\"#0E0E0E\\\",\\\"twitter:image:width\\\":\\\"1200\\\",\\\"viewport\\\":\\\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\\\",\\\"twitter:description\\\":\\\"Learn how to customize and extend Claude Code's behavior by registering shell commands\\\",\\\"lang\\\":\\\"en\\\",\\\"og:url\\\":\\\"https://code.claude.com/docs/en/hooks-guide\\\"},\\\"external\\\":{\\\"stylesheet\\\":{\\\"/docs/_next/static/css/7a165ec44fc339bb.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/fa24c414dafe6537.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/93ae04b3d6755082.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://fonts.googleapis.com/css2?family=Anthropic+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&display=swap\\\":{}},\\\"preconnect\\\":{\\\"https://fonts.gstatic.com\\\":{},\\\"https://fonts.googleapis.com\\\":{}},\\\"shortcut\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/x-icon\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/x-icon\\\"}},\\\"icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"}},\\\"alternate\\\":{\\\"/docs/sitemap.xml\\\":{\\\"type\\\":\\\"application/xml\\\"}},\\\"canonical\\\":{\\\"https://code.claude.com/docs/en/hooks-guide\\\":{}},\\\"preload\\\":{\\\"/docs/_next/static/media/c4b700dcb2187787-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\\\":{},\\\"/docs/_next/static/chunks/webpack-de379d107534c796.js?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/dark.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=0766b3221061e80143e9f300733e640b\\\":{},\\\"/docs/_next/static/media/bb3ef058b751a6ad-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg\\\":{},\\\"/docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/light.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=536eade682636e84231afce2577f9509\\\":{}},\\\"apple-touch-icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/apple-touch-icon.png\\\":{\\\"sizes\\\":\\\"180x180\\\",\\\"type\\\":\\\"image/png\\\"}}}}\""}]}]},"uuid":"5d6e8cbe-8160-43a0-a59f-8f321624fd9e","timestamp":"2026-01-26T05:36:45.389Z","sourceToolAssistantUUID":"b1212bdf-d6fb-4bfe-8a48-61c91e67d34a"}
{"parentUuid":"5d6e8cbe-8160-43a0-a59f-8f321624fd9e","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-reader","toolName":"webReader"},"toolUseID":"call_57a8c3c297d842dcbda4d874","parentToolUseID":"call_57a8c3c297d842dcbda4d874","uuid":"f5140211-af0e-4554-9c75-04c026696ea6","timestamp":"2026-01-26T05:36:47.081Z"}
{"parentUuid":"f5140211-af0e-4554-9c75-04c026696ea6","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-reader","toolName":"webReader","elapsedTimeMs":3606},"toolUseID":"call_57a8c3c297d842dcbda4d874","parentToolUseID":"call_57a8c3c297d842dcbda4d874","uuid":"7d4e2f02-4d6e-4ad1-8f43-762dece2313c","timestamp":"2026-01-26T05:36:50.687Z"}
{"parentUuid":"279656df-6856-4158-8645-86624c7399b6","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_57a8c3c297d842dcbda4d874","type":"tool_result","content":[{"type":"text","text":"\"{\\\"title\\\":\\\"Create custom subagents - Claude Code Docs\\\",\\\"description\\\":\\\"Create and use specialized AI subagents in Claude Code for task-specific workflows and improved context management.\\\",\\\"url\\\":\\\"https://code.claude.com/docs/en/sub-agents\\\",\\\"content\\\":\\\"Subagents are specialized AI assistants that handle specific types of tasks. Each subagent runs in its own context window with a custom system prompt, specific tool access, and independent permissions. When Claude encounters a task that matches a subagent’s description, it delegates to that subagent, which works independently and returns results.\\\\nSubagents help you:\\\\n\\\\n- __Preserve context__ by keeping exploration and implementation out of your main conversation\\\\n- __Enforce constraints__ by limiting which tools a subagent can use\\\\n- __Reuse configurations__ across projects with user-level subagents\\\\n- __Specialize behavior__ with focused system prompts for specific domains\\\\n- __Control costs__ by routing tasks to faster, cheaper models like Haiku\\\\n\\\\nClaude uses each subagent’s description to decide when to delegate tasks. When you create a subagent, write a clear description so Claude knows when to use it.\\\\nClaude Code includes several built-in subagents like __Explore__, __Plan__, and __general-purpose__. You can also create custom subagents to handle specific tasks. This page covers the built-in subagents, how to create your own, full configuration options, patterns for working with subagents, and example subagents.\\\\n\\\\n## Built-in subagents\\\\n\\\\nClaude Code includes built-in subagents that Claude automatically uses when appropriate. Each inherits the parent conversation’s permissions with additional tool restrictions.\\\\n\\\\n- Explore\\\\n- Plan\\\\n- General-purpose\\\\n- Other\\\\n\\\\nA fast, read-only agent optimized for searching and analyzing codebases.\\\\n\\\\n- __Model__: Haiku (fast, low-latency)\\\\n- __Tools__: Read-only tools (denied access to Write and Edit tools)\\\\n- __Purpose__: File discovery, code search, codebase exploration\\\\n\\\\nClaude delegates to Explore when it needs to search or understand a codebase without making changes. This keeps exploration results out of your main conversation context.When invoking Explore, Claude specifies a thoroughness level: __quick__ for targeted lookups, __medium__ for balanced exploration, or __very thorough__ for comprehensive analysis.\\\\n\\\\nA research agent used during plan mode to gather context before presenting a plan.\\\\n\\\\n- __Model__: Inherits from main conversation\\\\n- __Tools__: Read-only tools (denied access to Write and Edit tools)\\\\n- __Purpose__: Codebase research for planning\\\\n\\\\nWhen you’re in plan mode and Claude needs to understand your codebase, it delegates research to the Plan subagent. This prevents infinite nesting (subagents cannot spawn other subagents) while still gathering necessary context.\\\\n\\\\nA capable agent for complex, multi-step tasks that require both exploration and action.\\\\n\\\\n- __Model__: Inherits from main conversation\\\\n- __Tools__: All tools\\\\n- __Purpose__: Complex research, multi-step operations, code modifications\\\\n\\\\nClaude delegates to general-purpose when the task requires both exploration and modification, complex reasoning to interpret results, or multiple dependent steps.\\\\n\\\\nClaude Code includes additional helper agents for specific tasks. These are typically invoked automatically, so you don’t need to use them directly.\\\\n\\\\n| Agent | Model | When Claude uses it |\\\\n| --- | --- | --- |\\\\n| Bash | Inherits | Running terminal commands in a separate context |\\\\n| statusline-setup | Sonnet | When you run `/statusline` to configure your status line |\\\\n| Claude Code Guide | Haiku | When you ask questions about Claude Code features |\\\\n\\\\nBeyond these built-in subagents, you can create your own with custom prompts, tool restrictions, permission modes, hooks, and skills. The following sections show how to get started and customize subagents.\\\\n\\\\n## Quickstart: create your first subagent\\\\n\\\\nSubagents are defined in Markdown files with YAML frontmatter. You can create them manually or use the `/agents` command.\\\\nThis walkthrough guides you through creating a user-level subagent with the `/agent` command. The subagent reviews code and suggests improvements for the codebase.\\\\n\\\\nYou now have a subagent you can use in any project on your machine to analyze codebases and suggest improvements.\\\\nYou can also create subagents manually as Markdown files, define them via CLI flags, or distribute them through plugins. The following sections cover all configuration options.\\\\n\\\\n## Configure subagents\\\\n\\\\n### Use the /agents command\\\\n\\\\nThe `/agents` command provides an interactive interface for managing subagents. Run `/agents` to:\\\\n\\\\n- View all available subagents (built-in, user, project, and plugin)\\\\n- Create new subagents with guided setup or Claude generation\\\\n- Edit existing subagent configuration and tool access\\\\n- Delete custom subagents\\\\n- See which subagents are active when duplicates exist\\\\n\\\\nThis is the recommended way to create and manage subagents. For manual creation or automation, you can also add subagent files directly.\\\\n\\\\n### Choose the subagent scope\\\\n\\\\nSubagents are Markdown files with YAML frontmatter. Store them in different locations depending on scope. When multiple subagents share the same name, the higher-priority location wins.\\\\n\\\\n| Location | Scope | Priority | How to create |\\\\n| --- | --- | --- | --- |\\\\n| `--agents` CLI flag | Current session | 1 (highest) | Pass JSON when launching Claude Code |\\\\n| `.claude/agents/` | Current project | 2 | Interactive or manual |\\\\n| `~/.claude/agents/` | All your projects | 3 | Interactive or manual |\\\\n| Plugin’s `agents/` directory | Where plugin is enabled | 4 (lowest) | Installed with plugins |\\\\n\\\\n__Project subagents__ (`.claude/agents/`) are ideal for subagents specific to a codebase. Check them into version control so your team can use and improve them collaboratively.\\\\n__User subagents__ (`~/.claude/agents/`) are personal subagents available in all your projects.\\\\n__CLI-defined subagents__ are passed as JSON when launching Claude Code. They exist only for that session and aren’t saved to disk, making them useful for quick testing or automation scripts:\\\\n\\\\n```\\\\nclaude --agents '{\\\\n  \\\\\\\"code-reviewer\\\\\\\": {\\\\n    \\\\\\\"description\\\\\\\": \\\\\\\"Expert code reviewer. Use proactively after code changes.\\\\\\\",\\\\n    \\\\\\\"prompt\\\\\\\": \\\\\\\"You are a senior code reviewer. Focus on code quality, security, and best practices.\\\\\\\",\\\\n    \\\\\\\"tools\\\\\\\": [\\\\\\\"Read\\\\\\\", \\\\\\\"Grep\\\\\\\", \\\\\\\"Glob\\\\\\\", \\\\\\\"Bash\\\\\\\"],\\\\n    \\\\\\\"model\\\\\\\": \\\\\\\"sonnet\\\\\\\"\\\\n  }\\\\n}'\\\\n```\\\\n\\\\nThe `--agents` flag accepts JSON with the same fields as frontmatter. Use `prompt` for the system prompt (equivalent to the markdown body in file-based subagents). See the CLI reference for the full JSON format.\\\\n__Plugin subagents__ come from plugins you’ve installed. They appear in `/agents` alongside your custom subagents. See the plugin components reference for details on creating plugin subagents.\\\\n\\\\n### Write subagent files\\\\n\\\\nSubagent files use YAML frontmatter for configuration, followed by the system prompt in Markdown:\\\\n\\\\n```\\\\n---\\\\nname: code-reviewer\\\\ndescription: Reviews code for quality and best practices\\\\ntools: Read, Glob, Grep\\\\nmodel: sonnet\\\\n---\\\\n\\\\nYou are a code reviewer. When invoked, analyze the code and provide\\\\nspecific, actionable feedback on quality, security, and best practices.\\\\n```\\\\n\\\\nThe frontmatter defines the subagent’s metadata and configuration. The body becomes the system prompt that guides the subagent’s behavior. Subagents receive only this system prompt (plus basic environment details like working directory), not the full Claude Code system prompt.\\\\n\\\\n#### Supported frontmatter fields\\\\n\\\\nThe following fields can be used in the YAML frontmatter. Only `name` and `description` are required.\\\\n\\\\n| Field | Required | Description |\\\\n| --- | --- | --- |\\\\n| `name` | Yes | Unique identifier using lowercase letters and hyphens |\\\\n| `description` | Yes | When Claude should delegate to this subagent |\\\\n| `tools` | No | Tools the subagent can use. Inherits all tools if omitted |\\\\n| `disallowedTools` | No | Tools to deny, removed from inherited or specified list |\\\\n| `model` | No | Model to use: `sonnet`, `opus`, `haiku`, or `inherit`. Defaults to `inherit` |\\\\n| `permissionMode` | No | Permission mode: `default`, `acceptEdits`, `dontAsk`, `bypassPermissions`, or `plan` |\\\\n| `skills` | No | Skills to load into the subagent’s context at startup. The full skill content is injected, not just made available for invocation. Subagents don’t inherit skills from the parent conversation |\\\\n| `hooks` | No | Lifecycle hooks scoped to this subagent |\\\\n\\\\n### Choose a model\\\\n\\\\nThe `model` field controls which AI model the subagent uses:\\\\n\\\\n- __Model alias__: Use one of the available aliases: `sonnet`, `opus`, or `haiku`\\\\n- __inherit__: Use the same model as the main conversation\\\\n- __Omitted__: If not specified, defaults to `inherit` (uses the same model as the main conversation)\\\\n\\\\n### Control subagent capabilities\\\\n\\\\nYou can control what subagents can do through tool access, permission modes, and conditional rules.\\\\n\\\\n#### Available tools\\\\n\\\\nSubagents can use any of Claude Code’s internal tools. By default, subagents inherit all tools from the main conversation, including MCP tools.\\\\nTo restrict tools, use the `tools` field (allowlist) or `disallowedTools` field (denylist):\\\\n\\\\n```\\\\n---\\\\nname: safe-researcher\\\\ndescription: Research agent with restricted capabilities\\\\ntools: Read, Grep, Glob, Bash\\\\ndisallowedTools: Write, Edit\\\\n---\\\\n```\\\\n\\\\n#### Permission modes\\\\n\\\\nThe `permissionMode` field controls how the subagent handles permission prompts. Subagents inherit the permission context from the main conversation but can override the mode.\\\\n\\\\n| Mode | Behavior |\\\\n| --- | --- |\\\\n| `default` | Standard permission checking with prompts |\\\\n| `acceptEdits` | Auto-accept file edits |\\\\n| `dontAsk` | Auto-deny permission prompts (explicitly allowed tools still work) |\\\\n| `bypassPermissions` | Skip all permission checks |\\\\n| `plan` | Plan mode (read-only exploration) |\\\\n\\\\nIf the parent uses `bypassPermissions`, this takes precedence and cannot be overridden.\\\\n\\\\n#### Preload skills into subagents\\\\n\\\\nUse the `skills` field to inject skill content into a subagent’s context at startup. This gives the subagent domain knowledge without requiring it to discover and load skills during execution.\\\\n\\\\n```\\\\n---\\\\nname: api-developer\\\\ndescription: Implement API endpoints following team conventions\\\\nskills:\\\\n  - api-conventions\\\\n  - error-handling-patterns\\\\n---\\\\n\\\\nImplement API endpoints. Follow the conventions and patterns from the preloaded skills.\\\\n```\\\\n\\\\nThe full content of each skill is injected into the subagent’s context, not just made available for invocation. Subagents don’t inherit skills from the parent conversation; you must list them explicitly.\\\\n\\\\n#### Conditional rules with hooks\\\\n\\\\nFor more dynamic control over tool usage, use `PreToolUse` hooks to validate operations before they execute. This is useful when you need to allow some operations of a tool while blocking others.\\\\nThis example creates a subagent that only allows read-only database queries. The `PreToolUse` hook runs the script specified in `command` before each Bash command executes:\\\\n\\\\n```\\\\n---\\\\nname: db-reader\\\\ndescription: Execute read-only database queries\\\\ntools: Bash\\\\nhooks:\\\\n  PreToolUse:\\\\n    - matcher: \\\\\\\"Bash\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/validate-readonly-query.sh\\\\\\\"\\\\n---\\\\n```\\\\n\\\\nClaude Code passes hook input as JSON via stdin to hook commands. The validation script reads this JSON, extracts the Bash command, and exits with code 2 to block write operations:\\\\n\\\\n```\\\\n#!/bin/bash\\\\n# ./scripts/validate-readonly-query.sh\\\\n\\\\nINPUT=$(cat)\\\\nCOMMAND=$(echo \\\\\\\"$INPUT\\\\\\\" | jq -r '.tool_input.command // empty')\\\\n\\\\n# Block SQL write operations (case-insensitive)\\\\nif echo \\\\\\\"$COMMAND\\\\\\\" | grep -iE '\\\\\\\\b(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|TRUNCATE)\\\\\\\\b' > /dev/null; then\\\\n  echo \\\\\\\"Blocked: Only SELECT queries are allowed\\\\\\\" >&2\\\\n  exit 2\\\\nfi\\\\n\\\\nexit 0\\\\n```\\\\n\\\\nSee Hook input for the complete input schema and exit codes for how exit codes affect behavior.\\\\n\\\\n#### Disable specific subagents\\\\n\\\\nYou can prevent Claude from using specific subagents by adding them to the `deny` array in your settings. Use the format `Task(subagent-name)` where `subagent-name` matches the subagent’s name field.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"deny\\\\\\\": [\\\\\\\"Task(Explore)\\\\\\\", \\\\\\\"Task(my-custom-agent)\\\\\\\"]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nThis works for both built-in and custom subagents. You can also use the `--disallowedTools` CLI flag:\\\\n\\\\n```\\\\nclaude --disallowedTools \\\\\\\"Task(Explore)\\\\\\\"\\\\n```\\\\n\\\\nSee IAM documentation for more details on permission rules.\\\\n\\\\n### Define hooks for subagents\\\\n\\\\nSubagents can define hooks that run during the subagent’s lifecycle. There are two ways to configure hooks:\\\\n\\\\n1. __In the subagent’s frontmatter__: Define hooks that run only while that subagent is active\\\\n2. __In `settings.json`__: Define hooks that run in the main session when subagents start or stop\\\\n\\\\n#### Hooks in subagent frontmatter\\\\n\\\\nDefine hooks directly in the subagent’s markdown file. These hooks only run while that specific subagent is active and are cleaned up when it finishes.\\\\n\\\\n| Event | Matcher input | When it fires |\\\\n| --- | --- | --- |\\\\n| `PreToolUse` | Tool name | Before the subagent uses a tool |\\\\n| `PostToolUse` | Tool name | After the subagent uses a tool |\\\\n| `Stop` | (none) | When the subagent finishes |\\\\n\\\\nThis example validates Bash commands with the `PreToolUse` hook and runs a linter after file edits with `PostToolUse`:\\\\n\\\\n```\\\\n---\\\\nname: code-reviewer\\\\ndescription: Review code changes with automatic linting\\\\nhooks:\\\\n  PreToolUse:\\\\n    - matcher: \\\\\\\"Bash\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/validate-command.sh $TOOL_INPUT\\\\\\\"\\\\n  PostToolUse:\\\\n    - matcher: \\\\\\\"Edit|Write\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/run-linter.sh\\\\\\\"\\\\n---\\\\n```\\\\n\\\\n`Stop` hooks in frontmatter are automatically converted to `SubagentStop` events.\\\\n\\\\n#### Project-level hooks for subagent events\\\\n\\\\nConfigure hooks in `settings.json` that respond to subagent lifecycle events in the main session. Use the `matcher` field to target specific agent types by name.\\\\n\\\\n| Event | Matcher input | When it fires |\\\\n| --- | --- | --- |\\\\n| `SubagentStart` | Agent type name | When a subagent begins execution |\\\\n| `SubagentStop` | Agent type name | When a subagent completes |\\\\n\\\\nThis example runs setup and cleanup scripts only when the `db-agent` subagent starts and stops:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"SubagentStart\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"db-agent\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          { \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\", \\\\\\\"command\\\\\\\": \\\\\\\"./scripts/setup-db-connection.sh\\\\\\\" }\\\\n        ]\\\\n      }\\\\n    ],\\\\n    \\\\\\\"SubagentStop\\\\\\\": [\\\\n      {\\\\n        \\\\\\\"matcher\\\\\\\": \\\\\\\"db-agent\\\\\\\",\\\\n        \\\\\\\"hooks\\\\\\\": [\\\\n          { \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\", \\\\\\\"command\\\\\\\": \\\\\\\"./scripts/cleanup-db-connection.sh\\\\\\\" }\\\\n        ]\\\\n      }\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nSee Hooks for the complete hook configuration format.\\\\n\\\\n## Work with subagents\\\\n\\\\n### Understand automatic delegation\\\\n\\\\nClaude automatically delegates tasks based on the task description in your request, the `description` field in subagent configurations, and current context. To encourage proactive delegation, include phrases like “use proactively” in your subagent’s description field.\\\\nYou can also request a specific subagent explicitly:\\\\n\\\\n```\\\\nUse the test-runner subagent to fix failing tests\\\\nHave the code-reviewer subagent look at my recent changes\\\\n```\\\\n\\\\n### Run subagents in foreground or background\\\\n\\\\nSubagents can run in the foreground (blocking) or background (concurrent):\\\\n\\\\n- __Foreground subagents__ block the main conversation until complete. Permission prompts and clarifying questions (like `AskUserQuestion`) are passed through to you.\\\\n- __Background subagents__ run concurrently while you continue working. They inherit the parent’s permissions and auto-deny anything not pre-approved. If a background subagent needs a permission it doesn’t have or needs to ask clarifying questions, that tool call fails but the subagent continues. MCP tools are not available in background subagents.\\\\n\\\\nIf a background subagent fails due to missing permissions, you can resume it in the foreground to retry with interactive prompts.\\\\nClaude decides whether to run subagents in the foreground or background based on the task. You can also:\\\\n\\\\n- Ask Claude to “run this in the background”\\\\n- Press __Ctrl+B__ to background a running task\\\\n\\\\nTo disable all background task functionality, set the `CLAUDE_CODE_DISABLE_BACKGROUND_TASKS` environment variable to `1`. See Environment variables.\\\\n\\\\n### Common patterns\\\\n\\\\n#### Isolate high-volume operations\\\\n\\\\nOne of the most effective uses for subagents is isolating operations that produce large amounts of output. Running tests, fetching documentation, or processing log files can consume significant context. By delegating these to a subagent, the verbose output stays in the subagent’s context while only the relevant summary returns to your main conversation.\\\\n\\\\n```\\\\nUse a subagent to run the test suite and report only the failing tests with their error messages\\\\n```\\\\n\\\\n#### Run parallel research\\\\n\\\\nFor independent investigations, spawn multiple subagents to work simultaneously:\\\\n\\\\n```\\\\nResearch the authentication, database, and API modules in parallel using separate subagents\\\\n```\\\\n\\\\nEach subagent explores its area independently, then Claude synthesizes the findings. This works best when the research paths don’t depend on each other.\\\\n\\\\n#### Chain subagents\\\\n\\\\nFor multi-step workflows, ask Claude to use subagents in sequence. Each subagent completes its task and returns results to Claude, which then passes relevant context to the next subagent.\\\\n\\\\n```\\\\nUse the code-reviewer subagent to find performance issues, then use the optimizer subagent to fix them\\\\n```\\\\n\\\\n### Choose between subagents and main conversation\\\\n\\\\nUse the __main conversation__ when:\\\\n\\\\n- The task needs frequent back-and-forth or iterative refinement\\\\n- Multiple phases share significant context (planning → implementation → testing)\\\\n- You’re making a quick, targeted change\\\\n- Latency matters. Subagents start fresh and may need time to gather context\\\\n\\\\nUse __subagents__ when:\\\\n\\\\n- The task produces verbose output you don’t need in your main context\\\\n- You want to enforce specific tool restrictions or permissions\\\\n- The work is self-contained and can return a summary\\\\n\\\\nConsider Skills instead when you want reusable prompts or workflows that run in the main conversation context rather than isolated subagent context.\\\\n\\\\n### Manage subagent context\\\\n\\\\n#### Resume subagents\\\\n\\\\nEach subagent invocation creates a new instance with fresh context. To continue an existing subagent’s work instead of starting over, ask Claude to resume it.\\\\nResumed subagents retain their full conversation history, including all previous tool calls, results, and reasoning. The subagent picks up exactly where it stopped rather than starting fresh.\\\\nWhen a subagent completes, Claude receives its agent ID. To resume a subagent, ask Claude to continue the previous work:\\\\n\\\\n```\\\\nUse the code-reviewer subagent to review the authentication module\\\\n[Agent completes]\\\\n\\\\nContinue that code review and now analyze the authorization logic\\\\n[Claude resumes the subagent with full context from previous conversation]\\\\n```\\\\n\\\\nYou can also ask Claude for the agent ID if you want to reference it explicitly, or find IDs in the transcript files at `~/.claude/projects/{project}/{sessionId}/subagents/`. Each transcript is stored as `agent-{agentId}.jsonl`.\\\\nSubagent transcripts persist independently of the main conversation:\\\\n\\\\n- __Main conversation compaction__: When the main conversation compacts, subagent transcripts are unaffected. They’re stored in separate files.\\\\n- __Session persistence__: Subagent transcripts persist within their session. You can resume a subagent after restarting Claude Code by resuming the same session.\\\\n- __Automatic cleanup__: Transcripts are cleaned up based on the `cleanupPeriodDays` setting (default: 30 days).\\\\n\\\\n#### Auto-compaction\\\\n\\\\nSubagents support automatic compaction using the same logic as the main conversation. By default, auto-compaction triggers at approximately 95% capacity. To trigger compaction earlier, set `CLAUDE_AUTOCOMPACT_PCT_OVERRIDE` to a lower percentage (for example, `50`). See environment variables for details.\\\\nCompaction events are logged in subagent transcript files:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"type\\\\\\\": \\\\\\\"system\\\\\\\",\\\\n  \\\\\\\"subtype\\\\\\\": \\\\\\\"compact_boundary\\\\\\\",\\\\n  \\\\\\\"compactMetadata\\\\\\\": {\\\\n    \\\\\\\"trigger\\\\\\\": \\\\\\\"auto\\\\\\\",\\\\n    \\\\\\\"preTokens\\\\\\\": 167189\\\\n  }\\\\n}\\\\n```\\\\n\\\\nThe `preTokens` value shows how many tokens were used before compaction occurred.\\\\n\\\\n## Example subagents\\\\n\\\\nThese examples demonstrate effective patterns for building subagents. Use them as starting points, or generate a customized version with Claude.\\\\n\\\\n### Code reviewer\\\\n\\\\nA read-only subagent that reviews code without modifying it. This example shows how to design a focused subagent with limited tool access (no Edit or Write) and a detailed prompt that specifies exactly what to look for and how to format output.\\\\n\\\\n```\\\\n---\\\\nname: code-reviewer\\\\ndescription: Expert code review specialist. Proactively reviews code for quality, security, and maintainability. Use immediately after writing or modifying code.\\\\ntools: Read, Grep, Glob, Bash\\\\nmodel: inherit\\\\n---\\\\n\\\\nYou are a senior code reviewer ensuring high standards of code quality and security.\\\\n\\\\nWhen invoked:\\\\n1. Run git diff to see recent changes\\\\n2. Focus on modified files\\\\n3. Begin review immediately\\\\n\\\\nReview checklist:\\\\n- Code is clear and readable\\\\n- Functions and variables are well-named\\\\n- No duplicated code\\\\n- Proper error handling\\\\n- No exposed secrets or API keys\\\\n- Input validation implemented\\\\n- Good test coverage\\\\n- Performance considerations addressed\\\\n\\\\nProvide feedback organized by priority:\\\\n- Critical issues (must fix)\\\\n- Warnings (should fix)\\\\n- Suggestions (consider improving)\\\\n\\\\nInclude specific examples of how to fix issues.\\\\n```\\\\n\\\\n### Debugger\\\\n\\\\nA subagent that can both analyze and fix issues. Unlike the code reviewer, this one includes Edit because fixing bugs requires modifying code. The prompt provides a clear workflow from diagnosis to verification.\\\\n\\\\n```\\\\n---\\\\nname: debugger\\\\ndescription: Debugging specialist for errors, test failures, and unexpected behavior. Use proactively when encountering any issues.\\\\ntools: Read, Edit, Bash, Grep, Glob\\\\n---\\\\n\\\\nYou are an expert debugger specializing in root cause analysis.\\\\n\\\\nWhen invoked:\\\\n1. Capture error message and stack trace\\\\n2. Identify reproduction steps\\\\n3. Isolate the failure location\\\\n4. Implement minimal fix\\\\n5. Verify solution works\\\\n\\\\nDebugging process:\\\\n- Analyze error messages and logs\\\\n- Check recent code changes\\\\n- Form and test hypotheses\\\\n- Add strategic debug logging\\\\n- Inspect variable states\\\\n\\\\nFor each issue, provide:\\\\n- Root cause explanation\\\\n- Evidence supporting the diagnosis\\\\n- Specific code fix\\\\n- Testing approach\\\\n- Prevention recommendations\\\\n\\\\nFocus on fixing the underlying issue, not the symptoms.\\\\n```\\\\n\\\\n### Data scientist\\\\n\\\\nA domain-specific subagent for data analysis work. This example shows how to create subagents for specialized workflows outside of typical coding tasks. It explicitly sets `model: sonnet` for more capable analysis.\\\\n\\\\n```\\\\n---\\\\nname: data-scientist\\\\ndescription: Data analysis expert for SQL queries, BigQuery operations, and data insights. Use proactively for data analysis tasks and queries.\\\\ntools: Bash, Read, Write\\\\nmodel: sonnet\\\\n---\\\\n\\\\nYou are a data scientist specializing in SQL and BigQuery analysis.\\\\n\\\\nWhen invoked:\\\\n1. Understand the data analysis requirement\\\\n2. Write efficient SQL queries\\\\n3. Use BigQuery command line tools (bq) when appropriate\\\\n4. Analyze and summarize results\\\\n5. Present findings clearly\\\\n\\\\nKey practices:\\\\n- Write optimized SQL queries with proper filters\\\\n- Use appropriate aggregations and joins\\\\n- Include comments explaining complex logic\\\\n- Format results for readability\\\\n- Provide data-driven recommendations\\\\n\\\\nFor each analysis:\\\\n- Explain the query approach\\\\n- Document any assumptions\\\\n- Highlight key findings\\\\n- Suggest next steps based on data\\\\n\\\\nAlways ensure queries are efficient and cost-effective.\\\\n```\\\\n\\\\n### Database query validator\\\\n\\\\nA subagent that allows Bash access but validates commands to permit only read-only SQL queries. This example shows how to use `PreToolUse` hooks for conditional validation when you need finer control than the `tools` field provides.\\\\n\\\\n```\\\\n---\\\\nname: db-reader\\\\ndescription: Execute read-only database queries. Use when analyzing data or generating reports.\\\\ntools: Bash\\\\nhooks:\\\\n  PreToolUse:\\\\n    - matcher: \\\\\\\"Bash\\\\\\\"\\\\n      hooks:\\\\n        - type: command\\\\n          command: \\\\\\\"./scripts/validate-readonly-query.sh\\\\\\\"\\\\n---\\\\n\\\\nYou are a database analyst with read-only access. Execute SELECT queries to answer questions about the data.\\\\n\\\\nWhen asked to analyze data:\\\\n1. Identify which tables contain the relevant data\\\\n2. Write efficient SELECT queries with appropriate filters\\\\n3. Present results clearly with context\\\\n\\\\nYou cannot modify data. If asked to INSERT, UPDATE, DELETE, or modify schema, explain that you only have read access.\\\\n```\\\\n\\\\nClaude Code passes hook input as JSON via stdin to hook commands. The validation script reads this JSON, extracts the command being executed, and checks it against a list of SQL write operations. If a write operation is detected, the script exits with code 2 to block execution and returns an error message to Claude via stderr.\\\\nCreate the validation script anywhere in your project. The path must match the `command` field in your hook configuration:\\\\n\\\\n```\\\\n#!/bin/bash\\\\n# Blocks SQL write operations, allows SELECT queries\\\\n\\\\n# Read JSON input from stdin\\\\nINPUT=$(cat)\\\\n\\\\n# Extract the command field from tool_input using jq\\\\nCOMMAND=$(echo \\\\\\\"$INPUT\\\\\\\" | jq -r '.tool_input.command // empty')\\\\n\\\\nif [ -z \\\\\\\"$COMMAND\\\\\\\" ]; then\\\\n  exit 0\\\\nfi\\\\n\\\\n# Block write operations (case-insensitive)\\\\nif echo \\\\\\\"$COMMAND\\\\\\\" | grep -iE '\\\\\\\\b(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|TRUNCATE|REPLACE|MERGE)\\\\\\\\b' > /dev/null; then\\\\n  echo \\\\\\\"Blocked: Write operations not allowed. Use SELECT queries only.\\\\\\\" >&2\\\\n  exit 2\\\\nfi\\\\n\\\\nexit 0\\\\n```\\\\n\\\\nMake the script executable:\\\\n\\\\n```\\\\nchmod +x ./scripts/validate-readonly-query.sh\\\\n```\\\\n\\\\nThe hook receives JSON via stdin with the Bash command in `tool_input.command`. Exit code 2 blocks the operation and feeds the error message back to Claude. See Hooks for details on exit codes and Hook input for the complete input schema.\\\\n\\\\n## Next steps\\\\n\\\\nNow that you understand subagents, explore these related features:\\\\n\\\\n- Distribute subagents with plugins to share subagents across teams or projects\\\\n- Run Claude Code programmatically with the Agent SDK for CI/CD and automation\\\\n- Use MCP servers to give subagents access to external tools and data\\\",\\\"metadata\\\":{\\\"application-name\\\":\\\"Claude Code Docs\\\",\\\"charset\\\":\\\"utf-8\\\",\\\"msapplication-config\\\":\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/browserconfig.xml\\\",\\\"og:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DBuild%2Bwith%2BClaude%2BCode%26appearance%3Dsystem%26title%3DCreate%2Bcustom%2Bsubagents%26description%3DCreate%2Band%2Buse%2Bspecialized%2BAI%2Bsubagents%2Bin%2BClaude%2BCode%2Bfor%2Btask-specific%2Bworkflows%2Band%2Bimproved%2Bcontext%2Bmanagement.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"og:image:width\\\":\\\"1200\\\",\\\"og:type\\\":\\\"website\\\",\\\"twitter:card\\\":\\\"summary_large_image\\\",\\\"twitter:title\\\":\\\"Create custom subagents - Claude Code Docs\\\",\\\"og:site_name\\\":\\\"Claude Code Docs\\\",\\\"apple-mobile-web-app-title\\\":\\\"Claude Code Docs\\\",\\\"og:title\\\":\\\"Create custom subagents - Claude Code Docs\\\",\\\"og:image:height\\\":\\\"630\\\",\\\"twitter:image:height\\\":\\\"630\\\",\\\"description\\\":\\\"Create and use specialized AI subagents in Claude Code for task-specific workflows and improved context management.\\\",\\\"generator\\\":\\\"Mintlify\\\",\\\"canonical\\\":\\\"https://code.claude.com/docs/en/sub-agents\\\",\\\"og:description\\\":\\\"Create and use specialized AI subagents in Claude Code for task-specific workflows and improved context management.\\\",\\\"twitter:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DBuild%2Bwith%2BClaude%2BCode%26appearance%3Dsystem%26title%3DCreate%2Bcustom%2Bsubagents%26description%3DCreate%2Band%2Buse%2Bspecialized%2BAI%2Bsubagents%2Bin%2BClaude%2BCode%2Bfor%2Btask-specific%2Bworkflows%2Band%2Bimproved%2Bcontext%2Bmanagement.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"msapplication-TileColor\\\":\\\"#0E0E0E\\\",\\\"twitter:image:width\\\":\\\"1200\\\",\\\"viewport\\\":\\\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\\\",\\\"twitter:description\\\":\\\"Create and use specialized AI subagents in Claude Code for task-specific workflows and improved context management.\\\",\\\"lang\\\":\\\"en\\\",\\\"og:url\\\":\\\"https://code.claude.com/docs/en/sub-agents\\\"},\\\"external\\\":{\\\"stylesheet\\\":{\\\"/docs/_next/static/css/7a165ec44fc339bb.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/fa24c414dafe6537.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/93ae04b3d6755082.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://fonts.googleapis.com/css2?family=Anthropic+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&display=swap\\\":{}},\\\"preconnect\\\":{\\\"https://fonts.gstatic.com\\\":{},\\\"https://fonts.googleapis.com\\\":{}},\\\"shortcut\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/x-icon\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/x-icon\\\"}},\\\"icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"}},\\\"alternate\\\":{\\\"/docs/sitemap.xml\\\":{\\\"type\\\":\\\"application/xml\\\"}},\\\"canonical\\\":{\\\"https://code.claude.com/docs/en/sub-agents\\\":{}},\\\"preload\\\":{\\\"/docs/_next/static/media/c4b700dcb2187787-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\\\":{},\\\"/docs/_next/static/chunks/webpack-de379d107534c796.js?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/dark.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=0766b3221061e80143e9f300733e640b\\\":{},\\\"/docs/_next/static/media/bb3ef058b751a6ad-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg\\\":{},\\\"/docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/light.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=536eade682636e84231afce2577f9509\\\":{}},\\\"apple-touch-icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/apple-touch-icon.png\\\":{\\\"sizes\\\":\\\"180x180\\\",\\\"type\\\":\\\"image/png\\\"}}}}\""}]}]},"uuid":"78d9cab3-7fcd-4489-a5d5-ec573c4b9365","timestamp":"2026-01-26T05:36:51.359Z","sourceToolAssistantUUID":"279656df-6856-4158-8645-86624c7399b6"}
{"parentUuid":"78d9cab3-7fcd-4489-a5d5-ec573c4b9365","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_2026012613365403a0b3aeb52544e2","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"text","text":"Let me search for more specific information about the agent spawning syntax and settings.json format:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"68ec41f5-d63b-4b86-8e73-54f9d1123949","timestamp":"2026-01-26T05:37:01.017Z"}
{"parentUuid":"68ec41f5-d63b-4b86-8e73-54f9d1123949","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_2026012613365403a0b3aeb52544e2","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_a91bbad0ace84c18b775404f","name":"mcp__web-search-prime__webSearchPrime","input":{"content_size":"high","location":"us","search_query":"Claude Code settings.json configuration format documentation reference"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"940fc5ea-16f5-4d3f-9585-a60b2c2ee5e4","timestamp":"2026-01-26T05:37:01.084Z"}
{"parentUuid":"940fc5ea-16f5-4d3f-9585-a60b2c2ee5e4","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_2026012613365403a0b3aeb52544e2","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_9fa2896ad4fa440491ffe6c2","name":"mcp__web-search-prime__webSearchPrime","input":{"content_size":"high","location":"us","search_query":"\"claude --agent\" command line flag spawn agent syntax"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"1fad45e6-9815-494a-8b1b-d00e01bcec96","timestamp":"2026-01-26T05:37:01.157Z"}
{"parentUuid":"1fad45e6-9815-494a-8b1b-d00e01bcec96","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-search-prime","toolName":"webSearchPrime"},"toolUseID":"call_a91bbad0ace84c18b775404f","parentToolUseID":"call_a91bbad0ace84c18b775404f","uuid":"e3a4fcf2-9318-4f5c-a581-1fd82c5276e4","timestamp":"2026-01-26T05:37:03.478Z"}
{"parentUuid":"e3a4fcf2-9318-4f5c-a581-1fd82c5276e4","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-search-prime","toolName":"webSearchPrime","elapsedTimeMs":2235},"toolUseID":"call_a91bbad0ace84c18b775404f","parentToolUseID":"call_a91bbad0ace84c18b775404f","uuid":"67ab43df-b253-4d44-8b98-e2252e8e57db","timestamp":"2026-01-26T05:37:05.713Z"}
{"parentUuid":"940fc5ea-16f5-4d3f-9585-a60b2c2ee5e4","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_a91bbad0ace84c18b775404f","type":"tool_result","content":[{"type":"text","text":"\"[{\\\"refer\\\":\\\"ref_1\\\",\\\"title\\\":\\\"Claude Code settings - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/settings\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"The settings.json file is our official mechanism for configuring Claude Code through hierarchical settings: ... Other configuration is stored in ~/.claude.json .\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_2\\\",\\\"title\\\":\\\"Claude Code settings.json : r/ClaudeAI\\\",\\\"link\\\":\\\"https://www.reddit.com/r/ClaudeAI/comments/1l24a93/claude_code_settingsjson/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"I'm looking for a list of complete configurable settings for the global Claude Code settings.json. I only offered the /init and lack of creation of a /.claude/ ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"7 months ago\\\"},{\\\"refer\\\":\\\"ref_3\\\",\\\"title\\\":\\\"Claude Code settings, commands and agents for vibe coding\\\",\\\"link\\\":\\\"https://github.com/feiskyer/claude-code-settings\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"A curated collection of Claude Code settings, custom commands, skills and sub-agents designed for enhanced development workflows.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"2 days ago\\\"},{\\\"refer\\\":\\\"ref_4\\\",\\\"title\\\":\\\"Claude Code: Best practices for agentic coding\\\",\\\"link\\\":\\\"https://www.anthropic.com/engineering/claude-code-best-practices\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Manually edit your .claude/settings.json or ~/.claude.json (we recommend checking the former into source control to share with your team).\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Apr 18, 2025\\\"},{\\\"refer\\\":\\\"ref_5\\\",\\\"title\\\":\\\"How I use Claude Code (+ my best tips)\\\",\\\"link\\\":\\\"https://www.builder.io/blog/claude-code\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"You can create your own hooks via a .claude/settings.json file in your project directory, configured like this: { \\\\\\\"hooks\\\\\\\": [ { \\\\\\\"matcher ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jul 11, 2025\\\"},{\\\"refer\\\":\\\"ref_6\\\",\\\"title\\\":\\\"Claude Code CLI Cheatsheet: config, commands, prompts, + ...\\\",\\\"link\\\":\\\"https://shipyard.build/blog/claude-code-cheat-sheet/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"User settings: ~/.claude/settings.json (applies to all projects); Project settings: .claude/settings.json (shared with team, checked ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Aug 17, 2025\\\"},{\\\"refer\\\":\\\"ref_7\\\",\\\"title\\\":\\\"Add a formal `description` field for comments in `settings. ...\\\",\\\"link\\\":\\\"https://github.com/anthropics/claude-code/issues/4475\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"The Claude Code parser would be updated to recognize and ignore this key, treating it purely as a documentation field.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jul 25, 2025\\\"},{\\\"refer\\\":\\\"ref_8\\\",\\\"title\\\":\\\"Claude Code Configuration Guide\\\",\\\"link\\\":\\\"https://www.claudelog.com/configuration/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Master Claude Code configuration with this comprehensive guide. From API keys and model selection to MCP servers and tool permissions, these ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 15, 2026\\\"},{\\\"refer\\\":\\\"ref_9\\\",\\\"title\\\":\\\"Hooks reference - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/hooks\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Configuration. Claude Code hooks are configured in your settings files: ~/.claude/settings.json - User settings. .claude/settings.json - Project settings.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_10\\\",\\\"title\\\":\\\"Settings Hierarchy - The AI Agent Factory\\\",\\\"link\\\":\\\"https://agentfactory.panaversity.org/docs/AI-Tool-Landscape/claude-code-features-and-workflows/settings-hierarchy\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"claude/settings.json references in documentation. Try With AI​. Let's understand how Claude Code's three-level settings hierarchy enables both team ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"}]\""}]}]},"uuid":"db2017d3-f6dd-4671-a7db-2dc4d339363d","timestamp":"2026-01-26T05:37:06.267Z","sourceToolAssistantUUID":"940fc5ea-16f5-4d3f-9585-a60b2c2ee5e4"}
{"parentUuid":"db2017d3-f6dd-4671-a7db-2dc4d339363d","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-search-prime","toolName":"webSearchPrime"},"toolUseID":"call_9fa2896ad4fa440491ffe6c2","parentToolUseID":"call_9fa2896ad4fa440491ffe6c2","uuid":"caac5de4-ef47-45a0-b54b-d16f5a04ec22","timestamp":"2026-01-26T05:37:08.231Z"}
{"parentUuid":"caac5de4-ef47-45a0-b54b-d16f5a04ec22","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-search-prime","toolName":"webSearchPrime","elapsedTimeMs":4500},"toolUseID":"call_9fa2896ad4fa440491ffe6c2","parentToolUseID":"call_9fa2896ad4fa440491ffe6c2","uuid":"ba7e00ae-5530-4050-aa6f-caef5af752aa","timestamp":"2026-01-26T05:37:12.731Z"}
{"parentUuid":"1fad45e6-9815-494a-8b1b-d00e01bcec96","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_9fa2896ad4fa440491ffe6c2","type":"tool_result","content":[{"type":"text","text":"\"[{\\\"refer\\\":\\\"ref_1\\\",\\\"title\\\":\\\"Create custom subagents - Claude Code Docs\\\",\\\"link\\\":\\\"https://code.claude.com/docs/en/sub-agents\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"This walkthrough guides you through creating a user-level subagent with the /agent command. ... The --agents flag accepts JSON with the same fields as frontmatter ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"\\\"},{\\\"refer\\\":\\\"ref_2\\\",\\\"title\\\":\\\"Agent Usage Guide · ruvnet/claude-flow Wiki\\\",\\\"link\\\":\\\"https://github.com/ruvnet/claude-flow/wiki/Agent-Usage-Guide\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Spawn a new agent claude-flow agent spawn --type <agent-type> --name \\\\\\\"<agent-name>\\\\\\\" # List all active agents claude-flow agent list # Get ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jul 29, 2025\\\"},{\\\"refer\\\":\\\"ref_3\\\",\\\"title\\\":\\\"How to Use Claude Code: A Guide to Slash Commands ...\\\",\\\"link\\\":\\\"https://www.producttalk.org/how-to-use-claude-code-features/?srsltid=AfmBOoo4vJY7dVR9-XuW_Zha5duf-mFMLTs5XxWtIlPVtM_W5myAtipN\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Sub-agents work in their own context window and report back to the main agent. For example, Claude might spawn a sub-agent to search the web.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 7, 2026\\\"},{\\\"refer\\\":\\\"ref_4\\\",\\\"title\\\":\\\"Claude Code: Best practices for agentic coding\\\",\\\"link\\\":\\\"https://www.anthropic.com/engineering/claude-code-best-practices\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Claude Code is a command line tool for agentic coding. This post covers tips and tricks that have proven effective for using Claude Code ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Apr 18, 2025\\\"},{\\\"refer\\\":\\\"ref_5\\\",\\\"title\\\":\\\"Sub Agent / Multi-Agent Claude Code Commands for ...\\\",\\\"link\\\":\\\"https://www.reddit.com/r/ClaudeAI/comments/1lf5gwp/sub_agent_multiagent_claude_code_commands_for/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"A collection of commands that orchestrate multiple specialized AI agents to handle complex software engineering tasks.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"7 months ago\\\"},{\\\"refer\\\":\\\"ref_6\\\",\\\"title\\\":\\\"Calling Claude CLI as a child process yields no output\\\",\\\"link\\\":\\\"https://stackoverflow.com/questions/79826420/calling-claude-cli-as-a-child-process-yields-no-output\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Note that I am passing the --print flag alone; this should make the process fail with an error, but no output is reported. The \\\\\\\"hello\\\\\\\" process ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"2 months ago\\\"},{\\\"refer\\\":\\\"ref_7\\\",\\\"title\\\":\\\"hive-mind spawn --claude flag is documented but not ...\\\",\\\"link\\\":\\\"https://github.com/ruvnet/claude-flow/issues/955\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Spawns a worker agent; Does NOT launch Claude Code; The --claude flag is silently ignored. Expected behavior (from v2.7.47). Initialize ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jan 16, 2026\\\"},{\\\"refer\\\":\\\"ref_8\\\",\\\"title\\\":\\\"How I Use Every Claude Code Feature - by Shrivu Shankar\\\",\\\"link\\\":\\\"https://blog.sshh.io/p/how-i-use-every-claude-code-feature\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Use it for batch-processing code, building internal tools, and rapidly prototyping new agents before you reach for more complex frameworks.\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Nov 1, 2025\\\"},{\\\"refer\\\":\\\"ref_9\\\",\\\"title\\\":\\\"How I Use Claude Code | Philipp Spiess\\\",\\\"link\\\":\\\"https://spiess.dev/blog/how-i-use-claude-code\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"The premise of this tool is to spin off a sub-agent that will have the same access to tools as your main agent (except that it cannot spawn ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Jun 11, 2025\\\"},{\\\"refer\\\":\\\"ref_10\\\",\\\"title\\\":\\\"Claude Code CLI Cheatsheet: config, commands, prompts, + ...\\\",\\\"link\\\":\\\"https://shipyard.build/blog/claude-code-cheat-sheet/\\\",\\\"media\\\":\\\"\\\",\\\"content\\\":\\\"Get leet @ Anthropic's Claude Code with this cheatsheet, including config, CLI commands, advanced features, and best practices for faster ...\\\",\\\"icon\\\":\\\"\\\",\\\"publish_date\\\":\\\"Aug 17, 2025\\\"}]\""}]}]},"uuid":"d738d116-f825-461c-a79b-3811c6ea6cfb","timestamp":"2026-01-26T05:37:13.353Z","sourceToolAssistantUUID":"1fad45e6-9815-494a-8b1b-d00e01bcec96"}
{"parentUuid":"d738d116-f825-461c-a79b-3811c6ea6cfb","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261337172d376e09b80a4a95","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"text","text":"Let me read the settings documentation to get complete information about the configuration format:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"3c5aa80e-3ee2-4928-b8b6-4604fe1195d6","timestamp":"2026-01-26T05:37:18.572Z"}
{"parentUuid":"3c5aa80e-3ee2-4928-b8b6-4604fe1195d6","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261337172d376e09b80a4a95","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"tool_use","id":"call_18ca7fa957fc447d9a355f12","name":"mcp__web-reader__webReader","input":{"content_size":"high","url":"https://code.claude.com/docs/en/settings"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"dce7b4c3-7269-4509-96f9-b65163c5c5d5","timestamp":"2026-01-26T05:37:18.640Z"}
{"parentUuid":"dce7b4c3-7269-4509-96f9-b65163c5c5d5","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"web-reader","toolName":"webReader"},"toolUseID":"call_18ca7fa957fc447d9a355f12","parentToolUseID":"call_18ca7fa957fc447d9a355f12","uuid":"441b9716-f1b9-4a5c-b5fc-236829ecda86","timestamp":"2026-01-26T05:37:21.078Z"}
{"parentUuid":"441b9716-f1b9-4a5c-b5fc-236829ecda86","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"web-reader","toolName":"webReader","elapsedTimeMs":17114},"toolUseID":"call_18ca7fa957fc447d9a355f12","parentToolUseID":"call_18ca7fa957fc447d9a355f12","uuid":"25af9972-ccdb-4ea5-aa58-6d0bf6ec443c","timestamp":"2026-01-26T05:37:38.192Z"}
{"parentUuid":"dce7b4c3-7269-4509-96f9-b65163c5c5d5","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","type":"user","message":{"role":"user","content":[{"tool_use_id":"call_18ca7fa957fc447d9a355f12","type":"tool_result","content":[{"type":"text","text":"\"{\\\"title\\\":\\\"Claude Code settings - Claude Code Docs\\\",\\\"description\\\":\\\"Configure Claude Code with global and project-level settings, and environment variables.\\\",\\\"url\\\":\\\"https://code.claude.com/docs/en/settings\\\",\\\"content\\\":\\\"Claude Code offers a variety of settings to configure its behavior to meet your needs. You can configure Claude Code by running the `/config` command when using the interactive REPL, which opens a tabbed Settings interface where you can view status information and modify configuration options.\\\\n\\\\n## Configuration scopes\\\\n\\\\nClaude Code uses a __scope system__ to determine where configurations apply and who they’re shared with. Understanding scopes helps you decide how to configure Claude Code for personal use, team collaboration, or enterprise deployment.\\\\n\\\\n### Available scopes\\\\n\\\\n| Scope | Location | Who it affects | Shared with team? |\\\\n| --- | --- | --- | --- |\\\\n| __Managed__ | System-level `managed-settings.json` | All users on the machine | Yes (deployed by IT) |\\\\n| __User__ | `~/.claude/` directory | You, across all projects | No |\\\\n| __Project__ | `.claude/` in repository | All collaborators on this repository | Yes (committed to git) |\\\\n| __Local__ | `.claude/*.local.*` files | You, in this repository only | No (gitignored) |\\\\n\\\\n### When to use each scope\\\\n\\\\n__Managed scope__ is for:\\\\n\\\\n- Security policies that must be enforced organization-wide\\\\n- Compliance requirements that can’t be overridden\\\\n- Standardized configurations deployed by IT/DevOps\\\\n\\\\n__User scope__ is best for:\\\\n\\\\n- Personal preferences you want everywhere (themes, editor settings)\\\\n- Tools and plugins you use across all projects\\\\n- API keys and authentication (stored securely)\\\\n\\\\n__Project scope__ is best for:\\\\n\\\\n- Team-shared settings (permissions, hooks, MCP servers)\\\\n- Plugins the whole team should have\\\\n- Standardizing tooling across collaborators\\\\n\\\\n__Local scope__ is best for:\\\\n\\\\n- Personal overrides for a specific project\\\\n- Testing configurations before sharing with the team\\\\n- Machine-specific settings that won’t work for others\\\\n\\\\n### How scopes interact\\\\n\\\\nWhen the same setting is configured in multiple scopes, more specific scopes take precedence:\\\\n\\\\n1. __Managed__ (highest) - can’t be overridden by anything\\\\n2. __Command line arguments__ - temporary session overrides\\\\n3. __Local__ - overrides project and user settings\\\\n4. __Project__ - overrides user settings\\\\n5. __User__ (lowest) - applies when nothing else specifies the setting\\\\n\\\\nFor example, if a permission is allowed in user settings but denied in project settings, the project setting takes precedence and the permission is blocked.\\\\n\\\\n### What uses scopes\\\\n\\\\nScopes apply to many Claude Code features:\\\\n\\\\n| Feature | User location | Project location | Local location |\\\\n| --- | --- | --- | --- |\\\\n| __Settings__ | `~/.claude/settings.json` | `.claude/settings.json` | `.claude/settings.local.json` |\\\\n| __Subagents__ | `~/.claude/agents/` | `.claude/agents/` | — |\\\\n| __MCP servers__ | `~/.claude.json` | `.mcp.json` | `~/.claude.json` (per-project) |\\\\n| __Plugins__ | `~/.claude/settings.json` | `.claude/settings.json` | `.claude/settings.local.json` |\\\\n| __CLAUDE.md__ | `~/.claude/CLAUDE.md` | `CLAUDE.md` or `.claude/CLAUDE.md` | `CLAUDE.local.md` |\\\\n\\\\n---\\\\n\\\\n## Settings files\\\\n\\\\nThe `settings.json` file is our official mechanism for configuring Claude\\\\nCode through hierarchical settings:\\\\n\\\\n- __User settings__ are defined in `~/.claude/settings.json` and apply to all\\\\n  projects.\\\\n- __Project settings__ are saved in your project directory:\\\\n  - `.claude/settings.json` for settings that are checked into source control and shared with your team\\\\n  - `.claude/settings.local.json` for settings that are not checked in, useful for personal preferences and experimentation. Claude Code will configure git to ignore `.claude/settings.local.json` when it is created.\\\\n- __Managed settings__: For organizations that need centralized control, Claude Code supports `managed-settings.json` and `managed-mcp.json` files that can be deployed to system directories:\\\\n  - macOS: `/Library/Application Support/ClaudeCode/`\\\\n  - Linux and WSL: `/etc/claude-code/`\\\\n  - Windows: `C:\\\\\\\\Program Files\\\\\\\\ClaudeCode\\\\\\\\`See Managed settings and Managed MCP configuration for details.\\\\n- __Other configuration__ is stored in `~/.claude.json`. This file contains your preferences (theme, notification settings, editor mode), OAuth session, MCP server configurations for user and local scopes, per-project state (allowed tools, trust settings), and various caches. Project-scoped MCP servers are stored separately in `.mcp.json`.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"allow\\\\\\\": [\\\\n      \\\\\\\"Bash(npm run lint)\\\\\\\",\\\\n      \\\\\\\"Bash(npm run test:*)\\\\\\\",\\\\n      \\\\\\\"Read(~/.zshrc)\\\\\\\"\\\\n    ],\\\\n    \\\\\\\"deny\\\\\\\": [\\\\n      \\\\\\\"Bash(curl:*)\\\\\\\",\\\\n      \\\\\\\"Read(./.env)\\\\\\\",\\\\n      \\\\\\\"Read(./.env.*)\\\\\\\",\\\\n      \\\\\\\"Read(./secrets/**)\\\\\\\"\\\\n    ]\\\\n  },\\\\n  \\\\\\\"env\\\\\\\": {\\\\n    \\\\\\\"CLAUDE_CODE_ENABLE_TELEMETRY\\\\\\\": \\\\\\\"1\\\\\\\",\\\\n    \\\\\\\"OTEL_METRICS_EXPORTER\\\\\\\": \\\\\\\"otlp\\\\\\\"\\\\n  },\\\\n  \\\\\\\"companyAnnouncements\\\\\\\": [\\\\n    \\\\\\\"Welcome to Acme Corp! Review our code guidelines at docs.acme.com\\\\\\\",\\\\n    \\\\\\\"Reminder: Code reviews required for all PRs\\\\\\\",\\\\n    \\\\\\\"New security policy in effect\\\\\\\"\\\\n  ]\\\\n}\\\\n```\\\\n\\\\n### Available settings\\\\n\\\\n`settings.json` supports a number of options:\\\\n\\\\n| Key | Description | Example |\\\\n| --- | --- | --- |\\\\n| `apiKeyHelper` | Custom script, to be executed in `/bin/sh`, to generate an auth value. This value will be sent as `X-Api-Key` and `Authorization: Bearer` headers for model requests | `/bin/generate_temp_api_key.sh` |\\\\n| `cleanupPeriodDays` | Sessions inactive for longer than this period are deleted at startup. Setting to `0` immediately deletes all sessions. (default: 30 days) | `20` |\\\\n| `companyAnnouncements` | Announcement to display to users at startup. If multiple announcements are provided, they will be cycled through at random. | `[\\\\\\\"Welcome to Acme Corp! Review our code guidelines at docs.acme.com\\\\\\\"]` |\\\\n| `env` | Environment variables that will be applied to every session | `{\\\\\\\"FOO\\\\\\\": \\\\\\\"bar\\\\\\\"}` |\\\\n| `attribution` | Customize attribution for git commits and pull requests. See Attribution settings | `{\\\\\\\"commit\\\\\\\": \\\\\\\"🤖 Generated with Claude Code\\\\\\\", \\\\\\\"pr\\\\\\\": \\\\\\\"\\\\\\\"}` |\\\\n| `includeCoAuthoredBy` | __Deprecated__: Use `attribution` instead. Whether to include the `co-authored-by Claude` byline in git commits and pull requests (default: `true`) | `false` |\\\\n| `permissions` | See table below for structure of permissions. |  |\\\\n| `hooks` | Configure custom commands to run before or after tool executions. See hooks documentation | `{\\\\\\\"PreToolUse\\\\\\\": {\\\\\\\"Bash\\\\\\\": \\\\\\\"echo 'Running command...'\\\\\\\"}}` |\\\\n| `disableAllHooks` | Disable all hooks | `true` |\\\\n| `allowManagedHooksOnly` | (Managed settings only) Prevent loading of user, project, and plugin hooks. Only allows managed hooks and SDK hooks. See Hook configuration | `true` |\\\\n| `model` | Override the default model to use for Claude Code | `\\\\\\\"claude-sonnet-4-5-20250929\\\\\\\"` |\\\\n| `otelHeadersHelper` | Script to generate dynamic OpenTelemetry headers. Runs at startup and periodically (see Dynamic headers) | `/bin/generate_otel_headers.sh` |\\\\n| `statusLine` | Configure a custom status line to display context. See `statusLine` documentation | `{\\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\", \\\\\\\"command\\\\\\\": \\\\\\\"~/.claude/statusline.sh\\\\\\\"}` |\\\\n| `fileSuggestion` | Configure a custom script for `@` file autocomplete. See File suggestion settings | `{\\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\", \\\\\\\"command\\\\\\\": \\\\\\\"~/.claude/file-suggestion.sh\\\\\\\"}` |\\\\n| `respectGitignore` | Control whether the `@` file picker respects `.gitignore` patterns. When `true` (default), files matching `.gitignore` patterns are excluded from suggestions | `false` |\\\\n| `outputStyle` | Configure an output style to adjust the system prompt. See output styles documentation | `\\\\\\\"Explanatory\\\\\\\"` |\\\\n| `forceLoginMethod` | Use `claudeai` to restrict login to Claude.ai accounts, `console` to restrict login to Claude Console (API usage billing) accounts | `claudeai` |\\\\n| `forceLoginOrgUUID` | Specify the UUID of an organization to automatically select it during login, bypassing the organization selection step. Requires `forceLoginMethod` to be set | `\\\\\\\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\\\\\\\"` |\\\\n| `enableAllProjectMcpServers` | Automatically approve all MCP servers defined in project `.mcp.json` files | `true` |\\\\n| `enabledMcpjsonServers` | List of specific MCP servers from `.mcp.json` files to approve | `[\\\\\\\"memory\\\\\\\", \\\\\\\"github\\\\\\\"]` |\\\\n| `disabledMcpjsonServers` | List of specific MCP servers from `.mcp.json` files to reject | `[\\\\\\\"filesystem\\\\\\\"]` |\\\\n| `allowedMcpServers` | When set in managed-settings.json, allowlist of MCP servers users can configure. Undefined = no restrictions, empty array = lockdown. Applies to all scopes. Denylist takes precedence. See Managed MCP configuration | `[{ \\\\\\\"serverName\\\\\\\": \\\\\\\"github\\\\\\\" }]` |\\\\n| `deniedMcpServers` | When set in managed-settings.json, denylist of MCP servers that are explicitly blocked. Applies to all scopes including managed servers. Denylist takes precedence over allowlist. See Managed MCP configuration | `[{ \\\\\\\"serverName\\\\\\\": \\\\\\\"filesystem\\\\\\\" }]` |\\\\n| `strictKnownMarketplaces` | When set in managed-settings.json, allowlist of plugin marketplaces users can add. Undefined = no restrictions, empty array = lockdown. Applies to marketplace additions only. See Managed marketplace restrictions | `[{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\" }]` |\\\\n| `awsAuthRefresh` | Custom script that modifies the `.aws` directory (see advanced credential configuration) | `aws sso login --profile myprofile` |\\\\n| `awsCredentialExport` | Custom script that outputs JSON with AWS credentials (see advanced credential configuration) | `/bin/generate_aws_grant.sh` |\\\\n| `alwaysThinkingEnabled` | Enable extended thinking by default for all sessions. Typically configured via the `/config` command rather than editing directly | `true` |\\\\n| `plansDirectory` | Customize where plan files are stored. Path is relative to project root. Default: `~/.claude/plans` | `\\\\\\\"./plans\\\\\\\"` |\\\\n| `showTurnDuration` | Show turn duration messages after responses (e.g., “Cooked for 1m 6s”). Set to `false` to hide these messages | `true` |\\\\n| `language` | Configure Claude’s preferred response language (e.g., `\\\\\\\"japanese\\\\\\\"`, `\\\\\\\"spanish\\\\\\\"`, `\\\\\\\"french\\\\\\\"`). Claude will respond in this language by default | `\\\\\\\"japanese\\\\\\\"` |\\\\n| `autoUpdatesChannel` | Release channel to follow for updates. Use `\\\\\\\"stable\\\\\\\"` for a version that is typically about one week old and skips versions with major regressions, or `\\\\\\\"latest\\\\\\\"` (default) for the most recent release | `\\\\\\\"stable\\\\\\\"` |\\\\n| `spinnerTipsEnabled` | Show tips in the spinner while Claude is working. Set to `false` to disable tips (default: `true`) | `false` |\\\\n| `terminalProgressBarEnabled` | Enable the terminal progress bar that shows progress in supported terminals like Windows Terminal and iTerm2 (default: `true`) | `false` |\\\\n\\\\n### Permission settings\\\\n\\\\n| Keys | Description | Example |\\\\n| --- | --- | --- |\\\\n| `allow` | Array of permission rules to allow tool use. See Permission rule syntax below for pattern matching details | `[ \\\\\\\"Bash(git diff:*)\\\\\\\" ]` |\\\\n| `ask` | Array of permission rules to ask for confirmation upon tool use. See Permission rule syntax below | `[ \\\\\\\"Bash(git push:*)\\\\\\\" ]` |\\\\n| `deny` | Array of permission rules to deny tool use. Use this to exclude sensitive files from Claude Code access. See Permission rule syntax and Bash permission limitations | `[ \\\\\\\"WebFetch\\\\\\\", \\\\\\\"Bash(curl:*)\\\\\\\", \\\\\\\"Read(./.env)\\\\\\\", \\\\\\\"Read(./secrets/**)\\\\\\\" ]` |\\\\n| `additionalDirectories` | Additional working directories that Claude has access to | `[ \\\\\\\"../docs/\\\\\\\" ]` |\\\\n| `defaultMode` | Default permission mode when opening Claude Code | `\\\\\\\"acceptEdits\\\\\\\"` |\\\\n| `disableBypassPermissionsMode` | Set to `\\\\\\\"disable\\\\\\\"` to prevent `bypassPermissions` mode from being activated. This disables the `--dangerously-skip-permissions` command-line flag. See managed settings | `\\\\\\\"disable\\\\\\\"` |\\\\n\\\\n### Permission rule syntax\\\\n\\\\nPermission rules follow the format `Tool` or `Tool(specifier)`. Understanding the syntax helps you write rules that match exactly what you intend.\\\\n\\\\n#### Rule evaluation order\\\\n\\\\nWhen multiple rules could match the same tool use, rules are evaluated in this order:\\\\n\\\\n1. __Deny__ rules are checked first\\\\n2. __Ask__ rules are checked second\\\\n3. __Allow__ rules are checked last\\\\n\\\\nThe first matching rule determines the behavior. This means deny rules always take precedence over allow rules, even if both match the same command.\\\\n\\\\n#### Matching all uses of a tool\\\\n\\\\nTo match all uses of a tool, use just the tool name without parentheses:\\\\n\\\\n| Rule | Effect |\\\\n| --- | --- |\\\\n| `Bash` | Matches __all__ Bash commands |\\\\n| `WebFetch` | Matches __all__ web fetch requests |\\\\n| `Read` | Matches __all__ file reads |\\\\n\\\\n`Bash(*)` is equivalent to `Bash` and matches all Bash commands. Both syntaxes can be used interchangeably.\\\\n\\\\n#### Using specifiers for fine-grained control\\\\n\\\\nAdd a specifier in parentheses to match specific tool uses:\\\\n\\\\n| Rule | Effect |\\\\n| --- | --- |\\\\n| `Bash(npm run build)` | Matches the exact command `npm run build` |\\\\n| `Read(./.env)` | Matches reading the `.env` file in the current directory |\\\\n| `WebFetch(domain:example.com)` | Matches fetch requests to example.com |\\\\n\\\\n#### Wildcard patterns\\\\n\\\\nTwo wildcard syntaxes are available for Bash rules:\\\\n\\\\n| Wildcard | Position | Behavior | Example |\\\\n| --- | --- | --- | --- |\\\\n| `:*` | End of pattern only | __Prefix matching__ with word boundary. The prefix must be followed by a space or end-of-string. | `Bash(ls:*)` matches `ls -la` but not `lsof` |\\\\n| `*` | Anywhere in pattern | __Glob matching__ with no word boundary. Matches any sequence of characters at that position. | `Bash(ls*)` matches both `ls -la` and `lsof` |\\\\n\\\\n__Prefix matching with `:*`__\\\\nThe `:*` suffix matches any command that starts with the specified prefix. This works with multi-word commands. The following configuration allows npm and git commit commands while blocking git push and rm -rf:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"allow\\\\\\\": [\\\\n      \\\\\\\"Bash(npm run:*)\\\\\\\",\\\\n      \\\\\\\"Bash(git commit:*)\\\\\\\",\\\\n      \\\\\\\"Bash(docker compose:*)\\\\\\\"\\\\n    ],\\\\n    \\\\\\\"deny\\\\\\\": [\\\\n      \\\\\\\"Bash(git push:*)\\\\\\\",\\\\n      \\\\\\\"Bash(rm -rf:*)\\\\\\\"\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Glob matching with `*`__\\\\nThe `*` wildcard can appear at the beginning, middle, or end of a pattern. The following configuration allows any git command targeting main (like `git checkout main`, `git merge main`) and any version check command (like `node --version`, `npm --version`):\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"allow\\\\\\\": [\\\\n      \\\\\\\"Bash(git * main)\\\\\\\",\\\\n      \\\\\\\"Bash(* --version)\\\\\\\"\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nFor detailed information about tool-specific permission patterns—including Read, Edit, WebFetch, MCP, Task rules, and Bash permission limitations—see Tool-specific permission rules.\\\\n\\\\n### Sandbox settings\\\\n\\\\nConfigure advanced sandboxing behavior. Sandboxing isolates bash commands from your filesystem and network. See Sandboxing for details.\\\\n__Filesystem and network restrictions__ are configured via Read, Edit, and WebFetch permission rules, not via these sandbox settings.\\\\n\\\\n| Keys | Description | Example |\\\\n| --- | --- | --- |\\\\n| `enabled` | Enable bash sandboxing (macOS, Linux, and WSL2). Default: false | `true` |\\\\n| `autoAllowBashIfSandboxed` | Auto-approve bash commands when sandboxed. Default: true | `true` |\\\\n| `excludedCommands` | Commands that should run outside of the sandbox | `[\\\\\\\"git\\\\\\\", \\\\\\\"docker\\\\\\\"]` |\\\\n| `allowUnsandboxedCommands` | Allow commands to run outside the sandbox via the `dangerouslyDisableSandbox` parameter. When set to `false`, the `dangerouslyDisableSandbox` escape hatch is completely disabled and all commands must run sandboxed (or be in `excludedCommands`). Useful for enterprise policies that require strict sandboxing. Default: true | `false` |\\\\n| `network.allowUnixSockets` | Unix socket paths accessible in sandbox (for SSH agents, etc.) | `[\\\\\\\"~/.ssh/agent-socket\\\\\\\"]` |\\\\n| `network.allowLocalBinding` | Allow binding to localhost ports (macOS only). Default: false | `true` |\\\\n| `network.httpProxyPort` | HTTP proxy port used if you wish to bring your own proxy. If not specified, Claude will run its own proxy. | `8080` |\\\\n| `network.socksProxyPort` | SOCKS5 proxy port used if you wish to bring your own proxy. If not specified, Claude will run its own proxy. | `8081` |\\\\n| `enableWeakerNestedSandbox` | Enable weaker sandbox for unprivileged Docker environments (Linux and WSL2 only). __Reduces security.__ Default: false | `true` |\\\\n\\\\n__Configuration example:__\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"sandbox\\\\\\\": {\\\\n    \\\\\\\"enabled\\\\\\\": true,\\\\n    \\\\\\\"autoAllowBashIfSandboxed\\\\\\\": true,\\\\n    \\\\\\\"excludedCommands\\\\\\\": [\\\\\\\"docker\\\\\\\"],\\\\n    \\\\\\\"network\\\\\\\": {\\\\n      \\\\\\\"allowUnixSockets\\\\\\\": [\\\\n        \\\\\\\"/var/run/docker.sock\\\\\\\"\\\\n      ],\\\\n      \\\\\\\"allowLocalBinding\\\\\\\": true\\\\n    }\\\\n  },\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"deny\\\\\\\": [\\\\n      \\\\\\\"Read(.envrc)\\\\\\\",\\\\n      \\\\\\\"Read(~/.aws/**)\\\\\\\"\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Filesystem and network restrictions__ use standard permission rules:\\\\n\\\\n- Use `Read` deny rules to block Claude from reading specific files or directories\\\\n- Use `Edit` allow rules to let Claude write to directories beyond the current working directory\\\\n- Use `Edit` deny rules to block writes to specific paths\\\\n- Use `WebFetch` allow/deny rules to control which network domains Claude can access\\\\n\\\\n### Attribution settings\\\\n\\\\nClaude Code adds attribution to git commits and pull requests. These are configured separately:\\\\n\\\\n- Commits use git trailers (like `Co-Authored-By`) by default, which can be customized or disabled\\\\n- Pull request descriptions are plain text\\\\n\\\\n| Keys | Description |\\\\n| --- | --- |\\\\n| `commit` | Attribution for git commits, including any trailers. Empty string hides commit attribution |\\\\n| `pr` | Attribution for pull request descriptions. Empty string hides pull request attribution |\\\\n\\\\n__Default commit attribution:__\\\\n\\\\n```\\\\n🤖 Generated with [Claude Code](https://claude.com/claude-code)\\\\n\\\\n   Co-Authored-By: Claude Sonnet 4.5 <[email protected]>\\\\n```\\\\n\\\\n__Default pull request attribution:__\\\\n\\\\n```\\\\n🤖 Generated with [Claude Code](https://claude.com/claude-code)\\\\n```\\\\n\\\\n__Example:__\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"attribution\\\\\\\": {\\\\n    \\\\\\\"commit\\\\\\\": \\\\\\\"Generated with AI\\\\\\\\n\\\\\\\\nCo-Authored-By: AI <[email protected]>\\\\\\\",\\\\n    \\\\\\\"pr\\\\\\\": \\\\\\\"\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\n### File suggestion settings\\\\n\\\\nConfigure a custom command for `@` file path autocomplete. The built-in file suggestion uses fast filesystem traversal, but large monorepos may benefit from project-specific indexing such as a pre-built file index or custom tooling.\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"fileSuggestion\\\\\\\": {\\\\n    \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n    \\\\\\\"command\\\\\\\": \\\\\\\"~/.claude/file-suggestion.sh\\\\\\\"\\\\n  }\\\\n}\\\\n```\\\\n\\\\nThe command runs with the same environment variables as hooks, including `CLAUDE_PROJECT_DIR`. It receives JSON via stdin with a `query` field:\\\\n\\\\nOutput newline-separated file paths to stdout (currently limited to 15):\\\\n\\\\n```\\\\nsrc/components/Button.tsx\\\\nsrc/components/Modal.tsx\\\\nsrc/components/Form.tsx\\\\n```\\\\n\\\\n__Example:__\\\\n\\\\n```\\\\n#!/bin/bash\\\\nquery=$(cat | jq -r '.query')\\\\nyour-repo-file-index --query \\\\\\\"$query\\\\\\\" | head -20\\\\n```\\\\n\\\\n### Hook configuration\\\\n\\\\n__Managed settings only__: Controls which hooks are allowed to run. This setting can only be configured in managed settings and provides administrators with strict control over hook execution.\\\\n__Behavior when `allowManagedHooksOnly` is `true`:__\\\\n\\\\n- Managed hooks and SDK hooks are loaded\\\\n- User hooks, project hooks, and plugin hooks are blocked\\\\n\\\\n__Configuration:__\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"allowManagedHooksOnly\\\\\\\": true\\\\n}\\\\n```\\\\n\\\\n### Settings precedence\\\\n\\\\nSettings apply in order of precedence. From highest to lowest:\\\\n\\\\n1. __Managed settings__ (`managed-settings.json`)\\\\n   - Policies deployed by IT/DevOps to system directories\\\\n   - Cannot be overridden by user or project settings\\\\n2. __Command line arguments__\\\\n   - Temporary overrides for a specific session\\\\n3. __Local project settings__ (`.claude/settings.local.json`)\\\\n   - Personal project-specific settings\\\\n4. __Shared project settings__ (`.claude/settings.json`)\\\\n   - Team-shared project settings in source control\\\\n5. __User settings__ (`~/.claude/settings.json`)\\\\n   - Personal global settings\\\\n\\\\nThis hierarchy ensures that organizational policies are always enforced while still allowing teams and individuals to customize their experience.\\\\nFor example, if your user settings allow `Bash(npm run:*)` but a project’s shared settings deny it, the project setting takes precedence and the command is blocked.\\\\n\\\\n### Key points about the configuration system\\\\n\\\\n- __Memory files (`CLAUDE.md`)__: Contain instructions and context that Claude loads at startup\\\\n- __Settings files (JSON)__: Configure permissions, environment variables, and tool behavior\\\\n- __Skills__: Custom prompts that can be invoked with `/skill-name` or loaded by Claude automatically\\\\n- __MCP servers__: Extend Claude Code with additional tools and integrations\\\\n- __Precedence__: Higher-level configurations (Managed) override lower-level ones (User/Project)\\\\n- __Inheritance__: Settings are merged, with more specific settings adding to or overriding broader ones\\\\n\\\\n### System prompt\\\\n\\\\nClaude Code’s internal system prompt is not published. To add custom instructions, use `CLAUDE.md` files or the `--append-system-prompt` flag.\\\\n\\\\n### Excluding sensitive files\\\\n\\\\nTo prevent Claude Code from accessing files containing sensitive information like API keys, secrets, and environment files, use the `permissions.deny` setting in your `.claude/settings.json` file:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"permissions\\\\\\\": {\\\\n    \\\\\\\"deny\\\\\\\": [\\\\n      \\\\\\\"Read(./.env)\\\\\\\",\\\\n      \\\\\\\"Read(./.env.*)\\\\\\\",\\\\n      \\\\\\\"Read(./secrets/**)\\\\\\\",\\\\n      \\\\\\\"Read(./config/credentials.json)\\\\\\\",\\\\n      \\\\\\\"Read(./build)\\\\\\\"\\\\n    ]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nThis replaces the deprecated `ignorePatterns` configuration. Files matching these patterns are excluded from file discovery and search results, and read operations on these files are denied.\\\\n\\\\n## Subagent configuration\\\\n\\\\nClaude Code supports custom AI subagents that can be configured at both user and project levels. These subagents are stored as Markdown files with YAML frontmatter:\\\\n\\\\n- __User subagents__: `~/.claude/agents/` - Available across all your projects\\\\n- __Project subagents__: `.claude/agents/` - Specific to your project and can be shared with your team\\\\n\\\\nSubagent files define specialized AI assistants with custom prompts and tool permissions. Learn more about creating and using subagents in the subagents documentation.\\\\n\\\\n## Plugin configuration\\\\n\\\\nClaude Code supports a plugin system that lets you extend functionality with skills, agents, hooks, and MCP servers. Plugins are distributed through marketplaces and can be configured at both user and repository levels.\\\\n\\\\n### Plugin settings\\\\n\\\\nPlugin-related settings in `settings.json`:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"enabledPlugins\\\\\\\": {\\\\n    \\\\\\\"formatter@acme-tools\\\\\\\": true,\\\\n    \\\\\\\"deployer@acme-tools\\\\\\\": true,\\\\n    \\\\\\\"analyzer@security-plugins\\\\\\\": false\\\\n  },\\\\n  \\\\\\\"extraKnownMarketplaces\\\\\\\": {\\\\n    \\\\\\\"acme-tools\\\\\\\": {\\\\n      \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\",\\\\n      \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/claude-plugins\\\\\\\"\\\\n    }\\\\n  }\\\\n}\\\\n```\\\\n\\\\n#### `enabledPlugins`\\\\n\\\\nControls which plugins are enabled. Format: `\\\\\\\"plugin-name@marketplace-name\\\\\\\": true/false`\\\\n__Scopes__:\\\\n\\\\n- __User settings__ (`~/.claude/settings.json`): Personal plugin preferences\\\\n- __Project settings__ (`.claude/settings.json`): Project-specific plugins shared with team\\\\n- __Local settings__ (`.claude/settings.local.json`): Per-machine overrides (not committed)\\\\n\\\\n__Example__:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"enabledPlugins\\\\\\\": {\\\\n    \\\\\\\"code-formatter@team-tools\\\\\\\": true,\\\\n    \\\\\\\"deployment-tools@team-tools\\\\\\\": true,\\\\n    \\\\\\\"experimental-features@personal\\\\\\\": false\\\\n  }\\\\n}\\\\n```\\\\n\\\\nDefines additional marketplaces that should be made available for the repository. Typically used in repository-level settings to ensure team members have access to required plugin sources.\\\\n__When a repository includes `extraKnownMarketplaces`__:\\\\n\\\\n1. Team members are prompted to install the marketplace when they trust the folder\\\\n2. Team members are then prompted to install plugins from that marketplace\\\\n3. Users can skip unwanted marketplaces or plugins (stored in user settings)\\\\n4. Installation respects trust boundaries and requires explicit consent\\\\n\\\\n__Example__:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"extraKnownMarketplaces\\\\\\\": {\\\\n    \\\\\\\"acme-tools\\\\\\\": {\\\\n      \\\\\\\"source\\\\\\\": {\\\\n        \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\",\\\\n        \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/claude-plugins\\\\\\\"\\\\n      }\\\\n    },\\\\n    \\\\\\\"security-plugins\\\\\\\": {\\\\n      \\\\\\\"source\\\\\\\": {\\\\n        \\\\\\\"source\\\\\\\": \\\\\\\"git\\\\\\\",\\\\n        \\\\\\\"url\\\\\\\": \\\\\\\"https://git.example.com/security/plugins.git\\\\\\\"\\\\n      }\\\\n    }\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Marketplace source types__:\\\\n\\\\n- `github`: GitHub repository (uses `repo`)\\\\n- `git`: Any git URL (uses `url`)\\\\n- `directory`: Local filesystem path (uses `path`, for development only)\\\\n\\\\n#### `strictKnownMarketplaces`\\\\n\\\\n__Managed settings only__: Controls which plugin marketplaces users are allowed to add. This setting can only be configured in `managed-settings.json` and provides administrators with strict control over marketplace sources.\\\\n__Managed settings file locations__:\\\\n\\\\n- __macOS__: `/Library/Application Support/ClaudeCode/managed-settings.json`\\\\n- __Linux and WSL__: `/etc/claude-code/managed-settings.json`\\\\n- __Windows__: `C:\\\\\\\\Program Files\\\\\\\\ClaudeCode\\\\\\\\managed-settings.json`\\\\n\\\\n__Key characteristics__:\\\\n\\\\n- Only available in managed settings (`managed-settings.json`)\\\\n- Cannot be overridden by user or project settings (highest precedence)\\\\n- Enforced BEFORE network/filesystem operations (blocked sources never execute)\\\\n- Uses exact matching for source specifications (including `ref`, `path` for git sources)\\\\n\\\\n__Allowlist behavior__:\\\\n\\\\n- `undefined` (default): No restrictions - users can add any marketplace\\\\n- Empty array `[]`: Complete lockdown - users cannot add any new marketplaces\\\\n- List of sources: Users can only add marketplaces that match exactly\\\\n\\\\n__All supported source types__:\\\\nThe allowlist supports six marketplace source types. Each source must match exactly for a user’s marketplace addition to be allowed.\\\\n\\\\n1. __GitHub repositories__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/approved-plugins\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/security-tools\\\\\\\", \\\\\\\"ref\\\\\\\": \\\\\\\"v2.0\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\", \\\\\\\"ref\\\\\\\": \\\\\\\"main\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"marketplace\\\\\\\" }\\\\n```\\\\n\\\\nFields: `repo` (required), `ref` (optional: branch/tag/SHA), `path` (optional: subdirectory)\\\\n\\\\n2. __Git repositories__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"git\\\\\\\", \\\\\\\"url\\\\\\\": \\\\\\\"https://gitlab.example.com/tools/plugins.git\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"git\\\\\\\", \\\\\\\"url\\\\\\\": \\\\\\\"https://bitbucket.org/acme-corp/plugins.git\\\\\\\", \\\\\\\"ref\\\\\\\": \\\\\\\"production\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"git\\\\\\\", \\\\\\\"url\\\\\\\": \\\\\\\"ssh://[email protected]/plugins.git\\\\\\\", \\\\\\\"ref\\\\\\\": \\\\\\\"v3.1\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"approved\\\\\\\" }\\\\n```\\\\n\\\\nFields: `url` (required), `ref` (optional: branch/tag/SHA), `path` (optional: subdirectory)\\\\n\\\\n3. __URL-based marketplaces__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"url\\\\\\\", \\\\\\\"url\\\\\\\": \\\\\\\"https://plugins.example.com/marketplace.json\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"url\\\\\\\", \\\\\\\"url\\\\\\\": \\\\\\\"https://cdn.example.com/marketplace.json\\\\\\\", \\\\\\\"headers\\\\\\\": { \\\\\\\"Authorization\\\\\\\": \\\\\\\"Bearer ${TOKEN}\\\\\\\" } }\\\\n```\\\\n\\\\nFields: `url` (required), `headers` (optional: HTTP headers for authenticated access)\\\\n\\\\n4. __NPM packages__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"npm\\\\\\\", \\\\\\\"package\\\\\\\": \\\\\\\"@acme-corp/claude-plugins\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"npm\\\\\\\", \\\\\\\"package\\\\\\\": \\\\\\\"@acme-corp/approved-marketplace\\\\\\\" }\\\\n```\\\\n\\\\nFields: `package` (required, supports scoped packages)\\\\n\\\\n5. __File paths__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"file\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"/usr/local/share/claude/acme-marketplace.json\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"file\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"/opt/acme-corp/plugins/marketplace.json\\\\\\\" }\\\\n```\\\\n\\\\nFields: `path` (required: absolute path to marketplace.json file)\\\\n\\\\n6. __Directory paths__:\\\\n\\\\n```\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"directory\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"/usr/local/share/claude/acme-plugins\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"directory\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"/opt/acme-corp/approved-marketplaces\\\\\\\" }\\\\n```\\\\n\\\\nFields: `path` (required: absolute path to directory containing `.claude-plugin/marketplace.json`)\\\\n__Configuration examples__:\\\\nExample - Allow specific marketplaces only:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"strictKnownMarketplaces\\\\\\\": [\\\\n    {\\\\n      \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\",\\\\n      \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/approved-plugins\\\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\",\\\\n      \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/security-tools\\\\\\\",\\\\n      \\\\\\\"ref\\\\\\\": \\\\\\\"v2.0\\\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\\\"source\\\\\\\": \\\\\\\"url\\\\\\\",\\\\n      \\\\\\\"url\\\\\\\": \\\\\\\"https://plugins.example.com/marketplace.json\\\\\\\"\\\\n    },\\\\n    {\\\\n      \\\\\\\"source\\\\\\\": \\\\\\\"npm\\\\\\\",\\\\n      \\\\\\\"package\\\\\\\": \\\\\\\"@acme-corp/compliance-plugins\\\\\\\"\\\\n    }\\\\n  ]\\\\n}\\\\n```\\\\n\\\\nExample - Disable all marketplace additions:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"strictKnownMarketplaces\\\\\\\": []\\\\n}\\\\n```\\\\n\\\\n__Exact matching requirements__:\\\\nMarketplace sources must match __exactly__ for a user’s addition to be allowed. For git-based sources (`github` and `git`), this includes all optional fields:\\\\n\\\\n- The `repo` or `url` must match exactly\\\\n- The `ref` field must match exactly (or both be undefined)\\\\n- The `path` field must match exactly (or both be undefined)\\\\n\\\\nExamples of sources that __do NOT match__:\\\\n\\\\n```\\\\n// These are DIFFERENT sources:\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\", \\\\\\\"ref\\\\\\\": \\\\\\\"main\\\\\\\" }\\\\n\\\\n// These are also DIFFERENT:\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\", \\\\\\\"path\\\\\\\": \\\\\\\"marketplace\\\\\\\" }\\\\n{ \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\" }\\\\n```\\\\n\\\\n__Comparison with `extraKnownMarketplaces`__:\\\\n\\\\n| Aspect | `strictKnownMarketplaces` | `extraKnownMarketplaces` |\\\\n| --- | --- | --- |\\\\n| __Purpose__ | Organizational policy enforcement | Team convenience |\\\\n| __Settings file__ | `managed-settings.json` only | Any settings file |\\\\n| __Behavior__ | Blocks non-allowlisted additions | Auto-installs missing marketplaces |\\\\n| __When enforced__ | Before network/filesystem operations | After user trust prompt |\\\\n| __Can be overridden__ | No (highest precedence) | Yes (by higher precedence settings) |\\\\n| __Source format__ | Direct source object | Named marketplace with nested source |\\\\n| __Use case__ | Compliance, security restrictions | Onboarding, standardization |\\\\n\\\\n__Format difference__:\\\\n`strictKnownMarketplaces` uses direct source objects:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"strictKnownMarketplaces\\\\\\\": [\\\\n    { \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\" }\\\\n  ]\\\\n}\\\\n```\\\\n\\\\n`extraKnownMarketplaces` requires named marketplaces:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"extraKnownMarketplaces\\\\\\\": {\\\\n    \\\\\\\"acme-tools\\\\\\\": {\\\\n      \\\\\\\"source\\\\\\\": { \\\\\\\"source\\\\\\\": \\\\\\\"github\\\\\\\", \\\\\\\"repo\\\\\\\": \\\\\\\"acme-corp/plugins\\\\\\\" }\\\\n    }\\\\n  }\\\\n}\\\\n```\\\\n\\\\n__Important notes__:\\\\n\\\\n- Restrictions are checked BEFORE any network requests or filesystem operations\\\\n- When blocked, users see clear error messages indicating the source is blocked by managed policy\\\\n- The restriction applies only to adding NEW marketplaces; previously installed marketplaces remain accessible\\\\n- Managed settings have the highest precedence and cannot be overridden\\\\n\\\\nSee Managed marketplace restrictions for user-facing documentation.\\\\n\\\\n### Managing plugins\\\\n\\\\nUse the `/plugin` command to manage plugins interactively:\\\\n\\\\n- Browse available plugins from marketplaces\\\\n- Install/uninstall plugins\\\\n- Enable/disable plugins\\\\n- View plugin details (commands, agents, hooks provided)\\\\n- Add/remove marketplaces\\\\n\\\\nLearn more about the plugin system in the plugins documentation.\\\\n\\\\n## Environment variables\\\\n\\\\nClaude Code supports the following environment variables to control its behavior:\\\\n\\\\n| Variable | Purpose |\\\\n| --- | --- |\\\\n| `ANTHROPIC_API_KEY` | API key sent as `X-Api-Key` header, typically for the Claude SDK (for interactive usage, run `/login`) |\\\\n| `ANTHROPIC_AUTH_TOKEN` | Custom value for the `Authorization` header (the value you set here will be prefixed with `Bearer` ) |\\\\n| `ANTHROPIC_CUSTOM_HEADERS` | Custom headers you want to add to the request (in `Name: Value` format) |\\\\n| `ANTHROPIC_DEFAULT_HAIKU_MODEL` | See Model configuration |\\\\n| `ANTHROPIC_DEFAULT_OPUS_MODEL` | See Model configuration |\\\\n| `ANTHROPIC_DEFAULT_SONNET_MODEL` | See Model configuration |\\\\n| `ANTHROPIC_FOUNDRY_API_KEY` | API key for Microsoft Foundry authentication (see Microsoft Foundry) |\\\\n| `ANTHROPIC_FOUNDRY_BASE_URL` | Full base URL for the Foundry resource (for example, `https://my-resource.services.ai.azure.com/anthropic`). Alternative to `ANTHROPIC_FOUNDRY_RESOURCE` (see Microsoft Foundry) |\\\\n| `ANTHROPIC_FOUNDRY_RESOURCE` | Foundry resource name (for example, `my-resource`). Required if `ANTHROPIC_FOUNDRY_BASE_URL` is not set (see Microsoft Foundry) |\\\\n| `ANTHROPIC_MODEL` | Name of the model setting to use (see Model Configuration) |\\\\n| `ANTHROPIC_SMALL_FAST_MODEL` | [DEPRECATED] Name of Haiku-class model for background tasks |\\\\n| `ANTHROPIC_SMALL_FAST_MODEL_AWS_REGION` | Override AWS region for the Haiku-class model when using Bedrock |\\\\n| `AWS_BEARER_TOKEN_BEDROCK` | Bedrock API key for authentication (see Bedrock API keys) |\\\\n| `BASH_DEFAULT_TIMEOUT_MS` | Default timeout for long-running bash commands |\\\\n| `BASH_MAX_OUTPUT_LENGTH` | Maximum number of characters in bash outputs before they are middle-truncated |\\\\n| `BASH_MAX_TIMEOUT_MS` | Maximum timeout the model can set for long-running bash commands |\\\\n| `CLAUDE_AUTOCOMPACT_PCT_OVERRIDE` | Set the percentage of context capacity (1-100) at which auto-compaction triggers. By default, auto-compaction triggers at approximately 95% capacity. Use lower values like `50` to compact earlier. Values above the default threshold have no effect. Applies to both main conversations and subagents. This percentage aligns with the `context_window.used_percentage` field available in status line |\\\\n| `CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR` | Return to the original working directory after each Bash command |\\\\n| `CLAUDE_CODE_API_KEY_HELPER_TTL_MS` | Interval in milliseconds at which credentials should be refreshed (when using `apiKeyHelper`) |\\\\n| `CLAUDE_CODE_CLIENT_CERT` | Path to client certificate file for mTLS authentication |\\\\n| `CLAUDE_CODE_CLIENT_KEY_PASSPHRASE` | Passphrase for encrypted CLAUDE_CODE_CLIENT_KEY (optional) |\\\\n| `CLAUDE_CODE_CLIENT_KEY` | Path to client private key file for mTLS authentication |\\\\n| `CLAUDE_CODE_DISABLE_EXPERIMENTAL_BETAS` | Set to `1` to disable Anthropic API-specific `anthropic-beta` headers. Use this if experiencing issues like “Unexpected value(s) for the `anthropic-beta` header” when using an LLM gateway with third-party providers |\\\\n| `CLAUDE_CODE_DISABLE_BACKGROUND_TASKS` | Set to `1` to disable all background task functionality, including the `run_in_background` parameter on Bash and subagent tools, auto-backgrounding, and the Ctrl+B shortcut |\\\\n| `CLAUDE_CODE_EXIT_AFTER_STOP_DELAY` | Time in milliseconds to wait after the query loop becomes idle before automatically exiting. Useful for automated workflows and scripts using SDK mode |\\\\n| `CLAUDE_CODE_PROXY_RESOLVES_HOSTS` | Set to `true` to allow the proxy to perform DNS resolution instead of the caller. Opt-in for environments where the proxy should handle hostname resolution |\\\\n| `CLAUDE_CODE_TASK_LIST_ID` | Share a task list across sessions. Set the same ID in multiple Claude Code instances to coordinate on a shared task list. See Task list |\\\\n| `CLAUDE_CODE_TMPDIR` | Override the temp directory used for internal temp files. Claude Code appends `/claude/` to this path. Default: `/tmp` on Unix/macOS, `os.tmpdir()` on Windows |\\\\n| `CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC` | Equivalent of setting `DISABLE_AUTOUPDATER`, `DISABLE_BUG_COMMAND`, `DISABLE_ERROR_REPORTING`, and `DISABLE_TELEMETRY` |\\\\n| `CLAUDE_CODE_DISABLE_TERMINAL_TITLE` | Set to `1` to disable automatic terminal title updates based on conversation context |\\\\n| `CLAUDE_CODE_ENABLE_TELEMETRY` | Set to `1` to enable OpenTelemetry data collection for metrics and logging. Required before configuring OTel exporters. See Monitoring |\\\\n| `CLAUDE_CODE_FILE_READ_MAX_OUTPUT_TOKENS` | Override the default token limit for file reads. Useful when you need to read larger files in full |\\\\n| `CLAUDE_CODE_HIDE_ACCOUNT_INFO` | Set to `1` to hide your email address and organization name from the Claude Code UI. Useful when streaming or recording |\\\\n| `CLAUDE_CODE_IDE_SKIP_AUTO_INSTALL` | Skip auto-installation of IDE extensions |\\\\n| `CLAUDE_CODE_MAX_OUTPUT_TOKENS` | Set the maximum number of output tokens for most requests. Default: 32,000. Maximum: 64,000. Increasing this value reduces the effective context window available before auto-compaction triggers. |\\\\n| `CLAUDE_CODE_OTEL_HEADERS_HELPER_DEBOUNCE_MS` | Interval for refreshing dynamic OpenTelemetry headers in milliseconds (default: 1740000 / 29 minutes). See Dynamic headers |\\\\n| `CLAUDE_CODE_SHELL` | Override automatic shell detection. Useful when your login shell differs from your preferred working shell (for example, `bash` vs `zsh`) |\\\\n| `CLAUDE_CODE_SHELL_PREFIX` | Command prefix to wrap all bash commands (for example, for logging or auditing). Example: `/path/to/logger.sh` will execute `/path/to/logger.sh <command>` |\\\\n| `CLAUDE_CODE_SKIP_BEDROCK_AUTH` | Skip AWS authentication for Bedrock (for example, when using an LLM gateway) |\\\\n| `CLAUDE_CODE_SKIP_FOUNDRY_AUTH` | Skip Azure authentication for Microsoft Foundry (for example, when using an LLM gateway) |\\\\n| `CLAUDE_CODE_SKIP_VERTEX_AUTH` | Skip Google authentication for Vertex (for example, when using an LLM gateway) |\\\\n| `CLAUDE_CODE_SUBAGENT_MODEL` | See Model configuration |\\\\n| `CLAUDE_CODE_USE_BEDROCK` | Use Bedrock |\\\\n| `CLAUDE_CODE_USE_FOUNDRY` | Use Microsoft Foundry |\\\\n| `CLAUDE_CODE_USE_VERTEX` | Use Vertex |\\\\n| `CLAUDE_CONFIG_DIR` | Customize where Claude Code stores its configuration and data files |\\\\n| `DISABLE_AUTOUPDATER` | Set to `1` to disable automatic updates. |\\\\n| `DISABLE_BUG_COMMAND` | Set to `1` to disable the `/bug` command |\\\\n| `DISABLE_COST_WARNINGS` | Set to `1` to disable cost warning messages |\\\\n| `DISABLE_ERROR_REPORTING` | Set to `1` to opt out of Sentry error reporting |\\\\n| `DISABLE_INSTALLATION_CHECKS` | Set to `1` to disable installation warnings. Use only when manually managing the installation location, as this can mask issues with standard installations |\\\\n| `DISABLE_NON_ESSENTIAL_MODEL_CALLS` | Set to `1` to disable model calls for non-critical paths like flavor text |\\\\n| `DISABLE_PROMPT_CACHING` | Set to `1` to disable prompt caching for all models (takes precedence over per-model settings) |\\\\n| `DISABLE_PROMPT_CACHING_HAIKU` | Set to `1` to disable prompt caching for Haiku models |\\\\n| `DISABLE_PROMPT_CACHING_OPUS` | Set to `1` to disable prompt caching for Opus models |\\\\n| `DISABLE_PROMPT_CACHING_SONNET` | Set to `1` to disable prompt caching for Sonnet models |\\\\n| `DISABLE_TELEMETRY` | Set to `1` to opt out of Statsig telemetry (note that Statsig events do not include user data like code, file paths, or bash commands) |\\\\n| `ENABLE_TOOL_SEARCH` | Controls MCP tool search. Values: `auto` (default, enables at 10% context), `auto:N` (custom threshold, e.g., `auto:5` for 5%), `true` (always on), `false` (disabled) |\\\\n| `FORCE_AUTOUPDATE_PLUGINS` | Set to `true` to force plugin auto-updates even when the main auto-updater is disabled via `DISABLE_AUTOUPDATER` |\\\\n| `HTTP_PROXY` | Specify HTTP proxy server for network connections |\\\\n| `HTTPS_PROXY` | Specify HTTPS proxy server for network connections |\\\\n| `IS_DEMO` | Set to `true` to enable demo mode: hides email and organization from the UI, skips onboarding, and hides internal commands. Useful for streaming or recording sessions |\\\\n| `MAX_MCP_OUTPUT_TOKENS` | Maximum number of tokens allowed in MCP tool responses. Claude Code displays a warning when output exceeds 10,000 tokens (default: 25000) |\\\\n| `MAX_THINKING_TOKENS` | Override the extended thinking token budget. Thinking is enabled at max budget (31,999 tokens) by default. Use this to limit the budget (for example, `MAX_THINKING_TOKENS=10000`) or disable thinking entirely (`MAX_THINKING_TOKENS=0`). Extended thinking improves performance on complex reasoning and coding tasks but impacts prompt caching efficiency. |\\\\n| `MCP_TIMEOUT` | Timeout in milliseconds for MCP server startup |\\\\n| `MCP_TOOL_TIMEOUT` | Timeout in milliseconds for MCP tool execution |\\\\n| `NO_PROXY` | List of domains and IPs to which requests will be directly issued, bypassing proxy |\\\\n| `SLASH_COMMAND_TOOL_CHAR_BUDGET` | Maximum number of characters for skill metadata shown to the Skill tool (default: 15000). Legacy name kept for backwards compatibility. |\\\\n| `USE_BUILTIN_RIPGREP` | Set to `0` to use system-installed `rg` instead of `rg` included with Claude Code |\\\\n| `VERTEX_REGION_CLAUDE_3_5_HAIKU` | Override region for Claude 3.5 Haiku when using Vertex AI |\\\\n| `VERTEX_REGION_CLAUDE_3_7_SONNET` | Override region for Claude 3.7 Sonnet when using Vertex AI |\\\\n| `VERTEX_REGION_CLAUDE_4_0_OPUS` | Override region for Claude 4.0 Opus when using Vertex AI |\\\\n| `VERTEX_REGION_CLAUDE_4_0_SONNET` | Override region for Claude 4.0 Sonnet when using Vertex AI |\\\\n| `VERTEX_REGION_CLAUDE_4_1_OPUS` | Override region for Claude 4.1 Opus when using Vertex AI |\\\\n\\\\nClaude Code has access to a set of powerful tools that help it understand and modify your codebase:\\\\n\\\\n| Tool | Description | Permission Required |\\\\n| --- | --- | --- |\\\\n| __AskUserQuestion__ | Asks multiple-choice questions to gather requirements or clarify ambiguity | No |\\\\n| __Bash__ | Executes shell commands in your environment (see Bash tool behavior below) | Yes |\\\\n| __TaskOutput__ | Retrieves output from a background task (bash shell or subagent) | No |\\\\n| __Edit__ | Makes targeted edits to specific files | Yes |\\\\n| __ExitPlanMode__ | Prompts the user to exit plan mode and start coding | Yes |\\\\n| __Glob__ | Finds files based on pattern matching | No |\\\\n| __Grep__ | Searches for patterns in file contents | No |\\\\n| __KillShell__ | Kills a running background bash shell by its ID | No |\\\\n| __MCPSearch__ | Searches for and loads MCP tools when tool search is enabled | No |\\\\n| __NotebookEdit__ | Modifies Jupyter notebook cells | Yes |\\\\n| __Read__ | Reads the contents of files | No |\\\\n| __Skill__ | Executes a skill within the main conversation | Yes |\\\\n| __Task__ | Runs a sub-agent to handle complex, multi-step tasks | No |\\\\n| __TaskCreate__ | Creates a new task in the task list | No |\\\\n| __TaskGet__ | Retrieves full details for a specific task | No |\\\\n| __TaskList__ | Lists all tasks with their current status | No |\\\\n| __TaskUpdate__ | Updates task status, dependencies, or details | No |\\\\n| __WebFetch__ | Fetches content from a specified URL | Yes |\\\\n| __WebSearch__ | Performs web searches with domain filtering | Yes |\\\\n| __Write__ | Creates or overwrites files | Yes |\\\\n| __LSP__ | Code intelligence via language servers. Reports type errors and warnings automatically after file edits. Also supports navigation operations: jump to definitions, find references, get type info, list symbols, find implementations, trace call hierarchies. Requires a code intelligence plugin and its language server binary | No |\\\\n\\\\nPermission rules can be configured using `/allowed-tools` or in permission settings. Also see Tool-specific permission rules.\\\\n\\\\n### Bash tool behavior\\\\n\\\\nThe Bash tool executes shell commands with the following persistence behavior:\\\\n\\\\n- __Working directory persists__: When Claude changes the working directory (for example, `cd /path/to/dir`), subsequent Bash commands will execute in that directory. You can use `CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR=1` to reset to the project directory after each command.\\\\n- __Environment variables do NOT persist__: Environment variables set in one Bash command (for example, `export MY_VAR=value`) are __not__ available in subsequent Bash commands. Each Bash command runs in a fresh shell environment.\\\\n\\\\nTo make environment variables available in Bash commands, you have __three options__:\\\\n__Option 1: Activate environment before starting Claude Code__ (simplest approach)\\\\nActivate your virtual environment in your terminal before launching Claude Code:\\\\n\\\\n```\\\\nconda activate myenv\\\\n# or: source /path/to/venv/bin/activate\\\\nclaude\\\\n```\\\\n\\\\nThis works for shell environments but environment variables set within Claude’s Bash commands will not persist between commands.\\\\n__Option 2: Set CLAUDE_ENV_FILE before starting Claude Code__ (persistent environment setup)\\\\nExport the path to a shell script containing your environment setup:\\\\n\\\\n```\\\\nexport CLAUDE_ENV_FILE=/path/to/env-setup.sh\\\\nclaude\\\\n```\\\\n\\\\nWhere `/path/to/env-setup.sh` contains:\\\\n\\\\n```\\\\nconda activate myenv\\\\n# or: source /path/to/venv/bin/activate\\\\n# or: export MY_VAR=value\\\\n```\\\\n\\\\nClaude Code will source this file before each Bash command, making the environment persistent across all commands.\\\\n__Option 3: Use a SessionStart hook__ (project-specific configuration)\\\\nConfigure in `.claude/settings.json`:\\\\n\\\\n```\\\\n{\\\\n  \\\\\\\"hooks\\\\\\\": {\\\\n    \\\\\\\"SessionStart\\\\\\\": [{\\\\n      \\\\\\\"matcher\\\\\\\": \\\\\\\"startup\\\\\\\",\\\\n      \\\\\\\"hooks\\\\\\\": [{\\\\n        \\\\\\\"type\\\\\\\": \\\\\\\"command\\\\\\\",\\\\n        \\\\\\\"command\\\\\\\": \\\\\\\"echo 'conda activate myenv' >> \\\\\\\\\\\\\\\"$CLAUDE_ENV_FILE\\\\\\\\\\\\\\\"\\\\\\\"\\\\n      }]\\\\n    }]\\\\n  }\\\\n}\\\\n```\\\\n\\\\nThe hook writes to `$CLAUDE_ENV_FILE`, which is then sourced before each Bash command. This is ideal for team-shared project configurations.\\\\nSee SessionStart hooks for more details on Option 3.\\\\n\\\\n### Extending tools with hooks\\\\n\\\\nYou can run custom commands before or after any tool executes using\\\\nClaude Code hooks.\\\\nFor example, you could automatically run a Python formatter after Claude\\\\nmodifies Python files, or prevent modifications to production configuration\\\\nfiles by blocking Write operations to certain paths.\\\\n\\\\n## See also\\\\n\\\\n- Identity and Access Management - Permission system overview and how allow/ask/deny rules interact\\\\n- Tool-specific permission rules - Detailed patterns for Bash, Read, Edit, WebFetch, MCP, and Task tools, including security limitations\\\\n- Managed settings - Managed policy configuration for organizations\\\\n- Troubleshooting - Solutions for common configuration issues\\\",\\\"metadata\\\":{\\\"application-name\\\":\\\"Claude Code Docs\\\",\\\"charset\\\":\\\"utf-8\\\",\\\"msapplication-config\\\":\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/browserconfig.xml\\\",\\\"og:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DConfiguration%26appearance%3Dsystem%26title%3DClaude%2BCode%2Bsettings%26description%3DConfigure%2BClaude%2BCode%2Bwith%2Bglobal%2Band%2Bproject-level%2Bsettings%252C%2Band%2Benvironment%2Bvariables.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"og:image:width\\\":\\\"1200\\\",\\\"og:type\\\":\\\"website\\\",\\\"twitter:card\\\":\\\"summary_large_image\\\",\\\"twitter:title\\\":\\\"Claude Code settings - Claude Code Docs\\\",\\\"og:site_name\\\":\\\"Claude Code Docs\\\",\\\"apple-mobile-web-app-title\\\":\\\"Claude Code Docs\\\",\\\"og:title\\\":\\\"Claude Code settings - Claude Code Docs\\\",\\\"og:image:height\\\":\\\"630\\\",\\\"twitter:image:height\\\":\\\"630\\\",\\\"description\\\":\\\"Configure Claude Code with global and project-level settings, and environment variables.\\\",\\\"generator\\\":\\\"Mintlify\\\",\\\"canonical\\\":\\\"https://code.claude.com/docs/en/settings\\\",\\\"og:description\\\":\\\"Configure Claude Code with global and project-level settings, and environment variables.\\\",\\\"twitter:image\\\":\\\"https://claude-code.mintlify.app/_next/image?url=%2F_mintlify%2Fapi%2Fog%3Fdivision%3DConfiguration%26appearance%3Dsystem%26title%3DClaude%2BCode%2Bsettings%26description%3DConfigure%2BClaude%2BCode%2Bwith%2Bglobal%2Band%2Bproject-level%2Bsettings%252C%2Band%2Benvironment%2Bvariables.%26logoLight%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Flight.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D536eade682636e84231afce2577f9509%26logoDark%3Dhttps%253A%252F%252Fmintcdn.com%252Fclaude-code%252Fo69F7a6qoW9vboof%252Flogo%252Fdark.svg%253Ffit%253Dmax%2526auto%253Dformat%2526n%253Do69F7a6qoW9vboof%2526q%253D85%2526s%253D0766b3221061e80143e9f300733e640b%26primaryColor%3D%25230E0E0E%26lightColor%3D%2523D4A27F%26darkColor%3D%25230E0E0E%26backgroundLight%3D%2523FDFDF7%26backgroundDark%3D%252309090B&w=1200&q=100\\\",\\\"msapplication-TileColor\\\":\\\"#0E0E0E\\\",\\\"twitter:image:width\\\":\\\"1200\\\",\\\"viewport\\\":\\\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\\\",\\\"twitter:description\\\":\\\"Configure Claude Code with global and project-level settings, and environment variables.\\\",\\\"lang\\\":\\\"en\\\",\\\"og:url\\\":\\\"https://code.claude.com/docs/en/settings\\\"},\\\"external\\\":{\\\"stylesheet\\\":{\\\"/docs/_next/static/css/7a165ec44fc339bb.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/fa24c414dafe6537.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"/docs/_next/static/css/93ae04b3d6755082.css?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://fonts.googleapis.com/css2?family=Anthropic+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&display=swap\\\":{}},\\\"preconnect\\\":{\\\"https://fonts.gstatic.com\\\":{},\\\"https://fonts.googleapis.com\\\":{}},\\\"shortcut\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/x-icon\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon.ico\\\":{\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/x-icon\\\"}},\\\"icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-16x16.png\\\":{\\\"sizes\\\":\\\"16x16\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: light)\\\",\\\"type\\\":\\\"image/png\\\"},\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon-dark/favicon-32x32.png\\\":{\\\"sizes\\\":\\\"32x32\\\",\\\"media\\\":\\\"(prefers-color-scheme: dark)\\\",\\\"type\\\":\\\"image/png\\\"}},\\\"alternate\\\":{\\\"/docs/sitemap.xml\\\":{\\\"type\\\":\\\"application/xml\\\"}},\\\"canonical\\\":{\\\"https://code.claude.com/docs/en/settings\\\":{}},\\\"preload\\\":{\\\"/docs/_next/static/media/c4b700dcb2187787-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d4tuoctqmanu0.cloudfront.net/katex.min.css\\\":{},\\\"/docs/_next/static/chunks/webpack-de379d107534c796.js?dpl=dpl_FyEYrkxzmWGjn2p7vi6JcSEgtm3E\\\":{},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/dark.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=0766b3221061e80143e9f300733e640b\\\":{},\\\"/docs/_next/static/media/bb3ef058b751a6ad-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://d3gk2c5xim1je2.cloudfront.net/flags/US.svg\\\":{},\\\"/docs/_next/static/media/e4af272ccee01ff0-s.p.woff2\\\":{\\\"type\\\":\\\"font/woff2\\\"},\\\"https://mintcdn.com/claude-code/o69F7a6qoW9vboof/logo/light.svg?fit=max&auto=format&n=o69F7a6qoW9vboof&q=85&s=536eade682636e84231afce2577f9509\\\":{}},\\\"apple-touch-icon\\\":{\\\"/docs/_mintlify/favicons/claude-code/pLsy-mRpNksna2sx/_generated/favicon/apple-touch-icon.png\\\":{\\\"sizes\\\":\\\"180x180\\\",\\\"type\\\":\\\"image/png\\\"}}}}\""}]}]},"uuid":"f448afa8-faed-4368-846f-9c96034beec1","timestamp":"2026-01-26T05:37:38.882Z","sourceToolAssistantUUID":"dce7b4c3-7269-4509-96f9-b65163c5c5d5"}
{"parentUuid":"f448afa8-faed-4368-846f-9c96034beec1","isSidechain":true,"userType":"external","cwd":"/home/ken/github","sessionId":"6ac8d5ac-1759-4b31-99e1-eaab968f4e18","version":"2.1.19","gitBranch":"main","agentId":"a7cc167","slug":"jolly-questing-valley","message":{"id":"msg_202601261337425d4d44ac0f504323","type":"message","role":"assistant","model":"glm-4.7","content":[{"type":"text","text":"Perfect! Now I have comprehensive information from the official Claude Code documentation. Let me compile the verified specifications.\n\n---\n\n# Claude Code v1.0.62+ Verified Specifications\n\nBased on official Claude Code documentation, here are the verified specifications:\n\n## 1. Hook Configuration Format\n\n**CORRECT FIELD: `matcher`** (NOT `pattern`)\n\nHooks use the `matcher` field for pattern matching. The official format is:\n\n```json\n{\n  \"hooks\": {\n    \"EventName\": [\n      {\n        \"matcher\": \"ToolPattern\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"your-command-here\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Key Points:\n- **Field name**: `matcher` (NOT `pattern`)\n- **Purpose**: Pattern to match tool names, case-sensitive\n- **Applicable to**: `PreToolUse`, `PermissionRequest`, and `PostToolUse` events only\n- **Can be omitted**: For events like `UserPromptSubmit`, `Stop`, `SubagentStop`, and `Setup` that don't use matchers\n\n### Matcher Examples:\n```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Bash\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"jq -r '.tool_input.command' >> ~/.claude/bash-log.txt\"\n          }\n        ]\n      },\n      {\n        \"matcher\": \"Edit|Write\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"\\\"$CLAUDE_PROJECT_DIR\\\"/.claude/hooks/format.sh\"\n          }\n        ]\n      },\n      {\n        \"matcher\": \"mcp__memory__.*\",\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"echo 'Memory operation' >> ~/log.txt\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n### Matcher Patterns:\n- **Exact match**: `\"Write\"` matches only the Write tool\n- **Regex**: `\"Edit|Write\"` or `\"Notebook.*\"`\n- **Match all**: `\"*\"` or empty string `\"\"` or omit the field entirely\n\n### Events Without Matchers:\n```json\n{\n  \"hooks\": {\n    \"UserPromptSubmit\": [\n      {\n        \"hooks\": [\n          {\n            \"type\": \"command\",\n            \"command\": \"/path/to/validator.py\"\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n## 2. Agent Spawning Syntax\n\n**CORRECT: Natural language descriptions** (NOT `@agent-name` syntax)\n\nClaude Code does NOT use `@agent-name` syntax for spawning agents. Instead:\n\n### Automatic Delegation:\nClaude automatically delegates tasks based on:\n- The task description in your request\n- The `description` field in subagent configurations\n- Current context\n\n### Explicit Invocation:\nUse natural language to request specific subagents:\n\n```\nUse the test-runner subagent to fix failing tests\nHave the code-reviewer subagent look at my recent changes\nUse the code-reviewer subagent to review the authentication module\n```\n\n### CLI Flag (for session-level agents):\n```bash\nclaude --agent <name>\n```\n\nWhen you start Claude Code with `claude --agent <name>`, an `agent_type` field is added to hook input (see below).\n\n### Built-in Agents:\n- **Explore** - Fast, read-only codebase exploration\n- **Plan** - Research agent for planning mode\n- **General-purpose** - Complex multi-step tasks\n- **Bash** - Running terminal commands\n- **Claude Code Guide** - Help with Claude Code features\n\n### Creating Custom Agents:\nAgents are defined as Markdown files with YAML frontmatter:\n\n```markdown\n---\nname: code-reviewer\ndescription: Expert code review specialist. Proactively reviews code for quality, security, and maintainability.\ntools: Read, Grep, Glob, Bash\nmodel: inherit\n---\n\nYou are a senior code reviewer ensuring high standards of code quality and security.\n```\n\n## 3. Hook Input Fields\n\n**CORRECT FIELD: `agent_type`** (NOT `subagent_type`)\n\n### SessionStart Hook Input:\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"~/.claude/projects/.../abc123.jsonl\",\n  \"cwd\": \"/Users/...\",\n  \"permission_mode\": \"default\",\n  \"hook_event_name\": \"SessionStart\",\n  \"source\": \"startup\",\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"agent_type\": \"custom-agent-name\"  // <-- PRESENT when using --agent flag\n}\n```\n\nFrom the official documentation:\n> \"If you start Claude Code with `claude --agent <name>`, an `agent_type` field contains the agent name.\"\n\n### SubagentStart Hook Input:\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"~/.claude/projects/.../abc123.jsonl\",\n  \"cwd\": \"/Users/...\",\n  \"permission_mode\": \"default\",\n  \"hook_event_name\": \"SubagentStart\",\n  \"agent_id\": \"agent-abc123\",\n  \"agent_type\": \"Explore\"  // <-- Contains the agent name (built-in or custom)\n}\n```\n\nFrom the official documentation:\n> \"The `agent_type` contains the agent name (built-in agents like `\"Bash\"`, `\"Explore\"`, `\"Plan\"`, or custom agent names).\"\n\n### SubagentStop Hook Input:\n```json\n{\n  \"session_id\": \"abc123\",\n  \"transcript_path\": \"~/.claude/projects/.../abc123.jsonl\",\n  \"cwd\": \"/Users/...\",\n  \"permission_mode\": \"default\",\n  \"hook_event_name\": \"SubagentStop\",\n  \"stop_hook_active\": false,\n  \"agent_id\": \"def456\",\n  \"agent_transcript_path\": \"~/.claude/projects/.../abc123/subagents/agent-def456.jsonl\"\n}\n```\n\nNote: SubagentStop does NOT include `agent_type` in its input (unlike SubagentStart).\n\n## Summary of Corrections\n\n| What You Asked | Correct Answer |\n|---------------|----------------|\n| Hook pattern field | **`matcher`** (not `pattern`) |\n| Agent spawning syntax | **Natural language** like \"Use the code-reviewer agent\" (not `@agent-name`) |\n| Hook input field | **`agent_type`** (not `subagent_type`) |\n\n## Sources / Documentation URLs\n\n1. **Hooks Reference**: https://code.claude.com/docs/en/hooks\n   - Complete hook configuration format\n   - All hook events and their input schemas\n   - Matcher field documentation\n\n2. **Get Started with Hooks**: https://code.claude.com/docs/en/hooks-guide\n   - Hook configuration examples\n   - Quickstart guide\n\n3. **Subagents Documentation**: https://code.claude.com/docs/en/sub-agents\n   - Subagent creation and configuration\n   - Automatic delegation behavior\n   - Built-in subagents reference\n\n4. **Settings Documentation**: https://code.claude.com/docs/en/settings\n   - Complete settings.json reference\n   - Configuration scopes and precedence\n   - Permission rules and syntax"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":0,"output_tokens":0}},"type":"assistant","uuid":"65d3795e-4006-49d1-81f3-4edb854f92a3","timestamp":"2026-01-26T05:38:13.505Z"}
