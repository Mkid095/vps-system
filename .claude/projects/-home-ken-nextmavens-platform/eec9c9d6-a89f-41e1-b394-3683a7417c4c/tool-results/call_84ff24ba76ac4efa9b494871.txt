name: docker
services:
  dashboard:
    build:
      context: /home/ken/nextmavens-platform
      dockerfile: dashboard/Dockerfile
    container_name: nextmavens-dashboard
    deploy:
      resources:
        limits:
          memory: "1073741824"
        reservations:
          memory: "268435456"
    environment:
      NEXT_PUBLIC_API_URL: https://nextmavens.cloud/api
      NEXT_PUBLIC_SUPABASE_ANON_KEY: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5leHRtYXZlbnMiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTc2OTMyMjI0OSwiZXhwIjoxODAwODU4MjQ5fQ.yhX-uEhT0slUepLH6Eh93lgFGVnFyu90NoGyzOW9HV4
      NEXT_PUBLIC_SUPABASE_URL: https://nextmavens.cloud
      NEXT_TELEMETRY_DISABLED: "1"
      NODE_ENV: production
      SUPABASE_ANON_KEY: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5leHRtYXZlbnMiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTc2OTMyMjI0OSwiZXhwIjoxODAwODU4MjQ5fQ.yhX-uEhT0slUepLH6Eh93lgFGVnFyu90NoGyzOW9HV4
      SUPABASE_SERVICE_ROLE_KEY: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1zcnYiLCJyb2xlIjoic2VydmljZV9yb2xlIiwiaWF0IjoxNzY5MzIyMjQ5LCJleHAiOjE4MDA4NTgyNDl9.aPtHj__flbJR4PGCX7tFck7I3MkG-OV57eP5cCDbIH4
      SUPABASE_URL: https://nextmavens.cloud
    healthcheck:
      test:
        - CMD
        - wget
        - --quiet
        - --tries=1
        - --spider
        - http://localhost:3000
      timeout: 10s
      interval: 30s
      retries: 3
      start_period: 40s
    image: nextmavens-dashboard:latest
    logging:
      driver: json-file
      options:
        max-file: "3"
        max-size: 10m
    networks:
      nextmavens-network: null
    ports:
      - mode: ingress
        target: 3000
        published: "3005"
        protocol: tcp
    restart: unless-stopped
  db:
    container_name: nextmavens-db