     1→#!/bin/bash
     2→# ============================================================================
     3→# Maven Flow - Status Script
     4→# ============================================================================
     5→
     6→# Colors
     7→CYAN='\033[0;36m'
     8→GREEN='\033[0;32m'
     9→YELLOW='\033[1;33m'
    10→RED='\033[0;31m'
    11→GRAY='\033[0;90m'
    12→NC='\033[0m'
    13→
    14→# Check if jq is available
    15→if ! command -v jq &> /dev/null; then
    16→    echo -e "${RED}[ERROR] jq not found in PATH${NC}"
    17→    echo -e "${YELLOW}[INFO] Install with: sudo apt-get install jq${NC}"
    18→    exit 1
    19→fi
    20→
    21→# Function to get story stats
    22→get_story_stats() {
    23→    local total=0
    24→    local completed=0
    25→    local prd_list=""
    26→
    27→    if [ -d "docs" ]; then
    28→        for prd in docs/prd-*.json; do
    29→            if [ -f "$prd" ]; then
    30→                local count=$(jq '.userStories | length' "$prd" 2>/dev/null || echo 0)
    31→                total=$((total + count))
    32→
    33→                local complete=$(jq '[.userStories[] | select(.passes == true)] | length' "$prd" 2>/dev/null || echo 0)
    34→                completed=$((completed + complete))
    35→
    36→                # Get PRD name
    37→                local prd_name=$(jq -r '.title // "Unknown"' "$prd" 2>/dev/null)
    38→                local feature=$(basename "$prd" .json | sed 's/prd-//')
    39→                prd_list="${prd_list}  ${CYAN}${feature}${NC}: ${GREEN}${complete}/${count}${NC} - ${prd_name}\n"
    40→            fi
    41→        done
    42→    fi
    43→
    44→    local remaining=$((total - completed))
    45→    local progress=0
    46→    if [ $total -gt 0 ]; then
    47→        progress=$(( (completed * 100) / total ))
    48→    fi
    49→
    50→    echo "$total|$completed|$remaining|$progress|$prd_list"
    51→}
    52→
    53→# Check for session file
    54→if [ -f ".flow-session" ]; then
    55→    SESSION_ID=$(cat .flow-session)
    56→    echo -e "${GREEN}[ACTIVE]${NC} Session: ${MAGENTA}${SESSION_ID}${NC}"
    57→else
    58→    echo -e "${GRAY}No active session${NC}"
    59→fi
    60→
    61→# Get stats
    62→stats=$(get_story_stats)
    63→IFS='|' read -r total completed remaining progress prd_list <<< "$stats"
    64→
    65→echo ""
    66→echo -e "${CYAN}Maven Flow Status${NC}"
    67→echo -e "${CYAN}════════════════════════════════════════${NC}"
    68→echo -e "Stories: ${GREEN}${completed}/${total}${NC} ${GRAY}(${remaining} remaining)${NC}"
    69→echo -e "Progress: ${YELLOW}${progress}%${NC}"
    70→
    71→if [ -n "$prd_list" ]; then
    72→    echo ""
    73→    echo -e "${GRAY}PRDs:${NC}"
    74→    echo -e "$prd_list" | sed 's/\\n/\n/g'
    75→fi
    76→
    77→echo -e "${CYAN}════════════════════════════════════════${NC}"
    78→
    79→if [ $total -gt 0 ] && [ $completed -eq $total ]; then
    80→    echo -e "${GREEN}[OK] All stories complete!${NC}"
    81→    exit 0
    82→elif [ $total -eq 0 ]; then
    83→    echo -e "${YELLOW}[!] No PRDs found in docs/${NC}"
    84→    exit 1
    85→else
    86→    echo -e "${YELLOW}[INFO] Work in progress${NC}"
    87→    exit 0
    88→fi
    89→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
