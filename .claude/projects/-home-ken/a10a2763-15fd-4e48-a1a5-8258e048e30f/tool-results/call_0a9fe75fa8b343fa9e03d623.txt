   490→Use these MCP tools to complete your work. DO NOT read files or make assumptions - CHECK FIRST using the MCP.
   491→"
   492→    fi
   493→
   494→    # Generate agent prompt
   495→    local agent_prompt="You are the Maven $agent_name Agent (Step $step of Maven Workflow).
   496→
   497→STORY: $story_id - $story_title
   498→
   499→DESCRIPTION:
   500→$story_description
   501→
   502→PRD FILE: $prd_file$PLAN_CONTEXT$mcp_instruction
   503→
   504→## Your Task (Step $step)
   505→
   506→Complete Step $step of the Maven workflow for this story:
   507→- Read the PRD file to understand the full story context
   508→- Review acceptance criteria
   509→- Complete the step's work according to Maven Flow standards
   510→- Ensure NO 'any' types, NO gradients, use @ aliases for imports
   511→
   512→## Quality Standards (ZERO TOLERANCE):
   513→- No 'any' types - use proper TypeScript
   514→- No gradients - use solid professional colors
   515→- No relative imports - use @/ aliases
   516→- Components < 300 lines
   517→
   518→## After Completion:
   519→1. Run: pnpm run typecheck
   520→2. If errors remain, fix them
   521→3. Output: [STEP_COMPLETE] when done
   522→
   523→Begin Step $step now."
   524→
   525→    # Spawn the agent using Task tool
   526→    echo -e "${CYAN}Spawning $agent_name agent for Step $step...${NC}"
   527→
   528→    local result=$(claude --dangerously-skip-permissions "$agent_prompt" 2>&1)
   529→    local exit_code=$?
   530→
   531→    if echo "$result" | grep -q "\[STEP_COMPLETE\]"; then
   532→        echo -e "${GREEN}✓ Step $step complete${NC}"
   533→        return 0
   534→    else
   535→        echo -e "${YELLOW}⚠ Step $step completed (no confirmation signal)${NC}"
   536→        return 0
   537→    fi
   538→}
   539→
   540→# ============================================================================
   541→# Function to process a single story
   542→# ============================================================================
   543→process_story() {
   544→    local prd_file="$1"
   545→    local story_line="$2"
   546→
   547→    IFS='|' read -r story_id story_title story_description <<< "$story_line"
   548→
   549→    echo ""
   550→    echo -e "${CYAN}═══════════════════════════════════════════════════════${NC}"
   551→    echo -e "${CYAN}  Processing Story: $story_id - $story_title${NC}"
   552→    echo -e "${CYAN}═══════════════════════════════════════════════════════${NC}"
   553→    echo ""
   554→
   555→    # Get maven steps for this story
   556→    local maven_steps=($(jq -r ".userStories[] | select(.id == \"$story_id\") | .mavenSteps[]" "$prd_file" 2>/dev/null))
   557→
   558→    if [ ${#maven_steps[@]} -eq 0 ]; then
   559→        echo -e "${RED}Error: No mavenSteps found for story $story_id${NC}"
   560→        return 1
   561→    fi
   562→
   563→    echo -e "${GRAY}Maven Steps: ${maven_steps[*]}${NC}"
   564→    echo ""
   565→
   566→    # Process each step in sequence
   567→    for step in "${maven_steps[@]}"; do
   568→        echo -e "${YELLOW}─── Step $step ───${NC}"
   569→
   570→        spawn_agent_for_step "$story_line" "$step" "$prd_file"
   571→
   572→        # Small pause between steps
   573→        sleep 1
   574→        echo ""
   575→    done
   576→
   577→    # All steps complete - mark story as done
   578→    echo -e "${GREEN}═══════════════════════════════════════════════════════${NC}"
   579→    echo -e "${GREEN}  Story $story_id Complete!${NC}"
   580→    echo -e "${GREEN}═══════════════════════════════════════════════════════${NC}"
   581→    echo ""
   582→
   583→    # ⭐ MEMORY STEP 1: Create/Update Story Memory
   584→    echo -e "${CYAN}Creating story memory...${NC}"
   585→    if create_story_memory "$prd_file" "$story_id"; then
   586→        echo -e "${GREEN}✓ Story memory created${NC}"
   587→    else
   588→        echo -e "${YELLOW}⚠ Could not create story memory${NC}"
   589→    fi

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
