{
  "project": "Docker Infrastructure",
  "branchName": "flow/docker-infrastructure",
  "description": "Set up complete Docker infrastructure for NextMavens Platform. Version-pinned images for stability. Self-hosted Supabase, Evolution API, Redis, Kong gateway. Monitoring and storage optimization.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Supabase Docker Stack",
      "description": "As a platform operator, I want to run Supabase containers so that I have a self-hosted database.",
      "acceptanceCriteria": [
        "docker/supabase.yml",
        "Services: db, studio, meta, realtime, storage, rest, supavisor, kong",
        "Version-pinned images",
        "Health checks configured",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Evolution API Docker Stack",
      "description": "As a platform operator, I want to run Evolution API so that I can provide WhatsApp services.",
      "acceptanceCriteria": [
        "docker/evolution.yml",
        "Services: evolution, redis",
        "Version pinned: v2.3.7",
        "Webhook configuration via env",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Combined Docker Stack",
      "description": "As a platform operator, I want to run all services with one command so that deployment is simple.",
      "acceptanceCriteria": [
        "docker/docker-compose.yml",
        "Includes all services",
        "Single network: nextmavens-network",
        "Named volumes for persistence",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Database Initialization",
      "description": "As the database container, I want to run init scripts so that the master schema is created.",
      "acceptanceCriteria": [
        "scripts/db-init.sql mounted to /docker-entrypoint-initdb.d/",
        "Runs on first start",
        "Creates tables, functions, triggers",
        "Enables RLS",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Environment Configuration",
      "description": "As a platform operator, I want to configure services via env vars so that I can customize the deployment.",
      "acceptanceCriteria": [
        ".env.example with all variables",
        "Docker Compose reads from .env",
        "Secrets documented",
        "Defaults for local dev",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Volume Management",
      "description": "As a platform operator, I want persistent volumes so that data survives container restarts.",
      "acceptanceCriteria": [
        "Named volumes for: db data, storage, evolution data",
        "Backup script included",
        "Restore procedure documented",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Service Health Checks",
      "description": "As Docker Compose, I want to health check services so that unhealthy containers restart.",
      "acceptanceCriteria": [
        "All services have healthcheck directive",
        "db: pg_isready",
        "redis: redis-cli ping",
        "evolution: wget localhost:8080",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Kong API Gateway Configuration",
      "description": "As the platform, I want Kong to route requests so that services are properly isolated.",
      "acceptanceCriteria": [
        "Kong in DB-less mode",
        "Routes configured via API",
        "/studio/* -> Studio container",
        "/api/* -> API container",
        "Rate limiting plugin enabled",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Container Resource Limits",
      "description": "As a platform operator, I want to set resource limits so that no container consumes all resources.",
      "acceptanceCriteria": [
        "Memory limits on all containers",
        "CPU reservations",
        "Container restart policies",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Log Management",
      "description": "As a platform operator, I want to access logs so that I can debug issues.",
      "acceptanceCriteria": [
        "All containers log to stdout/stderr",
        "JSON log format",
        "Log rotation configured",
        "CLI can stream logs",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 3,
      "passes": false,
      "notes": ""
    }
  ]
}
