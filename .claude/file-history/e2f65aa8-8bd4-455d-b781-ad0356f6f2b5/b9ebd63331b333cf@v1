{
  "project": "Platform Core (Supabase Foundation)",
  "branchName": "flow/platform-core",
  "description": "Self-host Supabase with Docker for the NextMavens Platform. Implement custom organizations to projects flow with database-per-app isolation, Supavisor connection pooling, and Kong API gateway routing.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create Organization",
      "description": "As a platform administrator, I want to create an organization so that I can group related projects and manage team access.",
      "acceptanceCriteria": [
        "Organization has unique slug",
        "Creator is assigned owner role",
        "Organization record stored in master database",
        "API endpoint: POST /api/orgs with {name, slug?}",
        "Typecheck passes",
        "RLS policies enable org member access"
      ],
      "mavenSteps": [1, 7, 10],
      "mcpTools": {
        "step1": ["supabase"],
        "step7": ["supabase"],
        "step10": ["supabase"]
      },
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Create Project with Database",
      "description": "As a platform administrator, I want to create a project within an organization so that it gets an isolated PostgreSQL database with unique credentials.",
      "acceptanceCriteria": [
        "Project has unique slug within organization",
        "PostgreSQL database created: project_{uuid} (hyphens replaced with underscores)",
        "Database role created: app_{uuid}",
        "Random password generated and stored encrypted",
        "API keys generated (anon/service_role)",
        "Connection string returned",
        "Studio accessible via /studio/{slug}",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7, 10],
      "mcpTools": {
        "step1": ["supabase"],
        "step7": ["supabase"],
        "step10": ["supabase"]
      },
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "List Organizations",
      "description": "As a logged-in user, I want to see all organizations I belong to so that I can navigate to my projects.",
      "acceptanceCriteria": [
        "Returns organizations where user is a member",
        "Includes user's role in each organization",
        "API endpoint: GET /api/orgs",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "List Projects",
      "description": "As a logged-in user, I want to see all projects I have access to so that I can manage my applications.",
      "acceptanceCriteria": [
        "Returns projects from user's organizations",
        "Filterable by organization_id and status",
        "API endpoint: GET /api/projects?org_id={id}",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Get Project Details",
      "description": "As a developer, I want to retrieve project details including API keys and database credentials so that I can configure my application.",
      "acceptanceCriteria": [
        "Returns project metadata",
        "Returns WhatsApp instances",
        "Returns active API keys (without secrets)",
        "Returns project settings",
        "API endpoint: GET /api/projects/{id}",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Supabase Studio Access",
      "description": "As a developer, I want to access Supabase Studio for my project so that I can visually manage my database.",
      "acceptanceCriteria": [
        "Kong routes /studio/{slug} to Studio container",
        "Project database context injected via headers",
        "Authentication required",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Invite Organization Member",
      "description": "As an organization owner, I want to invite team members so that they can access projects.",
      "acceptanceCriteria": [
        "Member receives invitation",
        "Role can be owner/admin/member/viewer",
        "Member can see organization after accepting",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7, 10],
      "mcpTools": {
        "step1": ["supabase"],
        "step7": ["supabase"],
        "step10": ["supabase"]
      },
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Update Project Status",
      "description": "As an administrator, I want to suspend or archive projects so that I can manage unused applications.",
      "acceptanceCriteria": [
        "Status can be: provisioning/active/suspended/archived",
        "Suspended projects cannot receive API requests",
        "Database connections disabled when suspended",
        "Typecheck passes"
      ],
      "mavenSteps": [1, 7],
      "mcpTools": {},
      "priority": 3,
      "passes": false,
      "notes": ""
    }
  ]
}
